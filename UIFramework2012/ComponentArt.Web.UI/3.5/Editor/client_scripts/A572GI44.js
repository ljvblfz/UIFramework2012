var ComponentArt_Editor_Kernel_Loaded=false;function ComponentArt_Editor(id){this.DomElementId=id;this.element=this.DomElement=document.getElementById(this.DomElementId+"_Placeholder");if(window.ComponentArt_Atlas){ComponentArt.Web.UI.Editor.initializeBase(this,[this.element]);this.beginUpdate=function(){this._updating=true;};this.dispose=function(){this.Dispose();};this.endUpdate=function(){this._updating=false;this.Render();};this.get_isUpdating=function(){return this._updating;};this.getDescriptor=function(){return _zF0(this.constructor);};}else{this.beginUpdate=function(){this._updating=true;};this.endUpdate=function(){this._updating=false;this.Render();};this.get_isUpdating=function(){return this._updating;};}this.ClientControlId=this.EditorId=id;}ComponentArt_Editor.prototype.PublicProperties=[["EditMode",String,1],["EditEngine",String,1],["IFrameBorder",String,1],["IFrameScrolling",String,1],["Mode",String],["Editing",Boolean],["FocusOnLoad",Boolean],["EnableVisibilityManager",Boolean,1],["EditElement",Object],["Document",Object],["UndoStates",Array],["RedoStates",Array],["LastElement",Object],["SelectionBookmark",Object],["HighlightElementCssClass",String],["BreadcrumbClientTemplateId",String],["BreadcrumbCssClass",String],["BreadcrumbSeparator",String],["BreadcrumbArray",Array],["SourceCssClass",String],["DesignCssClass",String],["CssFileURL",String],["ContentHTML",String,1,1],["ContentText",String,1,1],["ClipboardHTML",String,1,1],["ClipboardCleanHTML",String,1,1],["ClipboardText",String,1,1],["WordCount",Number,1,1],["CharacterCount",Number,1,1],["Selection",Object,1,1],["SelectionText",String,1,1],["Template",String],["TabIndex",String],["Height",String],["Width",String],["Depth",Number],["TextLength",Number],["Debug",Boolean],["CloneStyles",Boolean],["PreserveRelativePaths",Boolean],["Action",String],["Id",String,1],["MaxBreadcrumbs",Number]];ComponentArt_Editor.prototype.PublicMethods=[["SourceMode"],["DesignMode"],["Focus"],["ApplyTag"],["SetStyle"],["GetStyle"],["ToggleStyle"],["SetAlign"],["GetListContext"],["InsertHyperlink"],["SetIndent"],["PasteHTML"],["CopySelection"],["CutSelection"],["Print"],["TableInsertRow"],["TableInsertColumn"],["TableDeleteRow"],["TableDeleteColumn"],["TableDeleteCell"],["TableMergeCellRight"],["TableMergeCellDown"],["TableSplitCellHorizontal"],["TableSplitCellVertical"],["InsertFormElement"],["ToggleOrderedList"],["ToggleUnorderedList"],["TopParent"],["SetUnorderedListCssClass"],["SetOrderedListCssClass"],["GetTopUnorderedList"],["GetTopOrderedList"],["New"],["Save"],["Edit"],["Update"],["Cancel"],["InsertHTML"],["InsertImage"]];ComponentArt_Editor.prototype.PublicEvents=[["ContextChange"],["ContentUpdate"],["SaveError"],["SaveSuccess"],["Enter"],["Load"]];_zEF(ComponentArt_Editor);window.ComponentArt.Web.UI.Editor=window.ComponentArt_Editor;if(window.ComponentArt_Atlas){ComponentArt.Web.UI.Editor.registerClass("ComponentArt.Web.UI.Editor",Sys.UI.Control);if(Sys.TypeDescriptor){Sys.TypeDescriptor.addType("componentArtWebUI","editor",ComponentArt.Web.UI.Editor);}}ComponentArt_Editor.prototype.InitKeyboard=function(){};ComponentArt_Editor.prototype.Dispose=function(){this.VisibilityChecker=null;if(this.ToolBars&&this.ToolBars.length){for(var x=0;x<this.ToolBars.length;x++){_zF3(document.getElementById(this.Id+"_"+this.ToolBars[x]));}}_zF3(this.textarea);_zF3(this.element);};ComponentArt_Editor.prototype.Initialize=function(){ComponentArt_ClientStateControls[ComponentArt_ClientStateControls.length]=this;if(this.Template){var _3=this.Template.split("$$");for(var i=1;i<_3.length;i+=2){if(_3[i]=="editorarea"){_3[i]="<div id=\""+this.Id+"_t_"+_3[i]+"\" style=\"height:100%;width:100%;\"></div>";}else{if(_3[i]=="parent"){_3[i]=this.Id;}else{if(_3[i].indexOf("ToolBars[")>-1){_3[i]="<span id=\""+this.Id+"_t_"+eval("this."+_3[i])+"\">&nbsp;</span>";}else{_3[i]="<span id=\""+this.Id+"_t_"+_3[i]+"\">&nbsp;</span>";}}}}var _5=document.getElementById(this.Id+"_Placeholder");_5.innerHTML=_3.join("");ComponentArt_Swap(this.Id+"_t_breadcrumbs",this.Id+"_Breadcrumbs");ComponentArt_Swap(this.Id+"_t_modetabs",this.Id+"_Modes");ComponentArt_Swap(this.Id+"_t_actions",this.Id+"_Actions");if(this.ToolBars&&this.ToolBars.length){for(var x=0;x<this.ToolBars.length;x++){ComponentArt_Swap(this.Id+"_t_"+this.ToolBars[x],this.Id+"_"+this.ToolBars[x]);}}}if(this.get_editMode()=="Default"){this.InitEditor();this.set_editing(true);}else{this.element=this.DomElement=document.getElementById(this.DomElementId+"_IFrame");this.textarea=document.getElementById(this.DomElementId+"_Textarea");this.document=this.element.contentWindow.document;this.element.parentEditor=this;this.document.designMode="on";this.document.contentEditable="true";this.set_editing(false);}_z132(this);this.ChildControls=[];this.ContextMetrics={};this.ContextChangedListeners={"Sometimes":[],"Always":[]};this.UndoStates=[];this.RedoStates=[];ComponentArt_Editor_InitializeStyles(this);ComponentArt_Editor_HookUpControls(this);this.TabIndex=this.element.tabIndex;this.InitAlign();this.Initialized=true;var _7=this.get_events().getHandler("load");if(_7){_7(this,Sys.EventArgs.Empty);}ComponentArt_Editor_HandleEditorBoxEvent(this,Sys.EventArgs.Empty);};ComponentArt_Editor.prototype.VisibilityCheck=function(){if(ComponentArt_IsVisible(this.parentElement)&&!this.element){this.Add();}else{if(!ComponentArt_IsVisible(this.parentElement)&&this.element){this.Remove();}}};ComponentArt_Editor.prototype.HookEvents=function(){if(cart_browser_safari){this.document.onkeypress=this.keyPressEvent;this.document.onkeydown=this.keyDownEvent;this.document.onkeyup=this.keyUpEvent;this.document.onclick=this.mouseClickEvent;this.document.onmousemove=this.mouseMoveEvent;this.document.onblur=this.blurEvent;}else{if(cart_browser_ie){this.document.onkeypress=this.keyPressEvent;this.document.onkeydown=this.keyDownEvent;this.document.onkeyup=this.keyUpEvent;this.document.onclick=this.mouseClickEvent;this.document.onmousemove=this.mouseMoveEvent;this.document.onmousedown=this.mouseDownEvent;this.document.onmouseup=this.mouseUpEvent;this.element.attachEvent("onblur",this.blurEvent);var _8=function(e){arguments.callee.Editor.OnFocus(event);};_8.Editor=this;document.attachEvent("onfocus",_8);}else{this.document.addEventListener("keyup",this.keyUpEvent,true);this.document.addEventListener("keydown",this.keyDownEvent,true);this.document.addEventListener("keypress",this.keyPressEvent,true);this.document.addEventListener("click",this.mouseClickEvent,true);setTimeout(this.Id+".document.addEventListener('blur', "+this.Id+".blurEvent, true);",1);}}};ComponentArt_Editor.prototype.InitEditor=function(){var _a;var _b=this.DomElementId+"_IFrame";var _c=document.getElementById(this.DomElementId+"_t_editorarea");var _d;_a=document.createElement("iframe");_a.id=_b;_a.name=_b;_a.frameBorder=this.IFrameBorder;_a.scrolling=this.IFrameScrolling;_a.style.width="100%";_a.style.height="100%";_c.appendChild(_a);_d=_a.contentWindow;_d.document.designMode="on";_a.style.display="none";var _e=document.createElement("TEXTAREA");_e.id=this.DomElementId+"_Textarea";_c.appendChild(_e);_e.style.overflow="auto";this.textarea=_e;if(!cart_browser_ie){this.textarea.style.width="100%";this.textarea.style.height="100%";}this.element=this.DomElement=document.getElementById(this.DomElementId+"_IFrame");this.InitTextarea();_a.style.display="";this.document=this.element.contentWindow.document;this.element.parentEditor=this;this.parentElement=_c;};ComponentArt_Editor.prototype.InitTextarea=function(){if(!this.element){return;}var _f=this.element.offsetWidth;var _10=this.element.offsetHeight;var _11=ComponentArt_GetAdjustedHeight(this.textarea,this.textarea.offsetHeight)/this.textarea.rows;if(Math.floor(_10/_11)<=0){setTimeout(this.Id+".InitTextarea("+_10+");",25);return;}ComponentArt_SetAdjustedWidth(this.textarea,_f)+"px";if(cart_browser_ie){this.textarea.rows=Math.floor(_10/_11);var _12=ComponentArt_GetAdjustedHeight(this.textarea,this.textarea.offsetHeight);if(_12>_10){this.textarea.rows=this.textarea.rows-1;}}this.textarea.style.visibility="hidden";this.textarea.style.display="none";};ComponentArt_Editor.prototype.InitAlign=function(_13){if(!this.document.body){setTimeout(this.Id+".InitAlign(\""+_13+"\")",100);return;}if(cart_browser_mozilla&&cart_browser_major==5){this.SourceMode();this.DesignMode();}this.element.style.visibility="hidden";this.PopulateContent();if(cart_browser_mozilla){this.document.body.spellcheck=false;}this.document.body.className=this.DesignCssClass;if(this.CloneStyles){ComponentArt_CloneStyles(document,this.document);}else{var _14=this.document.createElement("link");_14.href=this.CssFileURL;_14.rel="stylesheet";_14.type="text/css";this.document.body.appendChild(_14);}this.element.style.visibility="";this.SelectFristNode();this.HookEvents();if(cart_browser_mozilla&&cart_browser_major!=5){this.document.designMode="off";this.document.designMode="on";}if(this.FocusOnLoad){this.Focus();}if(_13=="source"){this.set_mode("design");this.SourceMode();}if(!this.VisibilityChecker&&this.get_enableVisibilityManager()){this.VisibilityCheck();this.VisibilityChecker=setInterval(this.Id+".VisibilityCheck();",25);}};ComponentArt_Editor.prototype.SelectFristNode=function(){var _15=new Object();_15.CommonAncestorContainer=this.document.body;_15.EndContainer=_15.StartContainer=this.document.body.firstChild;_15.StartOffset=0;_15.EndOffset=0;this.UpdateCounts();try{_z163(this.element,_15);}catch(err){}this.DomTrace();};ComponentArt_Editor.prototype.PopulateContent=function(){var _16="";if(this.ContentHTML){if(this.PreserveRelativePaths){_16=ComponentArt_ReplacePaths(this.ContentHTML);}else{_16=this.ContentHTML;}}else{if(this.ContentText){_16=this.ContentText;}else{if(this.EditEngine!="Browser"){_16="<div>&nbsp;</div>";}}}this.document.open();this.document.write(_16);this.document.close();if(cart_browser_safari){this.SourceMode();this.DesignMode();}else{document.getElementById(this.Id+"_Textarea").value=_16;}};ComponentArt_Editor.prototype.Remove=function(){if(this.element){this.ContentHTML=(this.get_mode()=="source")?this.textarea.value:ComponentArt_SerializeDomElements(this.document.body.childNodes);_zF3(this.element);if(cart_browser_ie){ComponentArt_WhiteWash(this.textarea,this.Height,this.Width);}_zF3(this.textarea);this.element=null;}};ComponentArt_Editor.prototype.Add=function(){if(!this.element){this.InitEditor();this.InitAlign(this.get_mode());}};ComponentArt_Editor.prototype.Print=function(){this.Focus();this.element.contentWindow.print();};ComponentArt_Editor.prototype.insertHTML=function(_17){var _18=_z110(this.element);if(!ComponentArt_IsSelectionEmpty(_18)){ComponentArt_ClearSelection(this.element);}this.Focus();if(cart_browser_ie){this.document.selection.createRange().pasteHTML(_17);var _19="";if(this.document.body.className){_19=this.document.body.className;}this.document.body.className="repaint";this.document.body.className=_19;}else{var _1a="paste_html_"+Math.round(Math.random()*100000000);this.document.execCommand("insertimage",false,_1a);var pat=new RegExp("<[^<]*"+_1a+"[^>]*>");this.document.body.innerHTML=this.document.body.innerHTML.replace(pat,_17);}};ComponentArt_Editor.prototype.get_clipboardHTML=function(){var _1c=document.getElementById("dumpster");if(!_1c){_1c=document.createElement("DIV");_1c.setAttribute("contentEditable",true);_1c.style.position="absolute";_1c.style.overflow="hidden";_1c.style.top="-1000px";_1c.style.left="-1000px";_1c.style.width="1px";_1c.style.height="1px";_1c.style.zIndex="-1000";document.body.insertBefore(_1c,document.body.firstChild);}_1c.innerHTML="";this.SaveBookmark();_1c.focus();document.execCommand("Paste",null);_z163(this.element,this.get_selectionBookmark());this.Focus();var _1d=_1c.innerHTML;_zF3(_1c);return _1d;};ComponentArt_Editor.prototype.get_clipboardCleanHTML=function(){var _1e=document.getElementById("dumpster");if(!_1e){_1e=document.createElement("DIV");_1e.setAttribute("contentEditable",true);_1e.style.position="absolute";_1e.style.overflow="hidden";_1e.style.top="-1000px";_1e.style.left="-1000px";_1e.style.width="1px";_1e.style.height="1px";_1e.style.zIndex="-1000";document.body.insertBefore(_1e,document.body.firstChild);}_1e.innerHTML="";_1e.focus();document.execCommand("Paste",null);this.Focus();try{_z163(this.element,this.SelectionBookmark);}catch(err){}this.SelectionBookmark=this.SelectionBookmarkPaths=null;var _1f=ComponentArt_SerializeDomElements(_1e.childNodes);_zF3(_1e);return _1f;};ComponentArt_Editor.prototype.get_clipboardText=function(){var _20=document.getElementById("disposal");if(!_20){_20=ComponentArt_CreateElementWithName(document,"DIV","disposal");_20.setAttribute("contentEditable",true);_20.setAttribute("id","disposal");_20.style.position="absolute";_20.style.overflow="hidden";_20.style.top="-1000px";_20.style.left="-1000px";_20.style.width="1px";_20.style.height="1px";_20.style.zIndex="-1000";document.body.insertBefore(_20,document.body.firstChild);}_20.innerHTML="";if(!this.SelectionBookmark){this.SaveBookmark();}_20.focus();document.execCommand("Paste",null);_z163(this.element,this.SelectionBookmark);this.SelectionBookmark=this.SelectionBookmarkPaths=null;this.Focus();var _21=(cart_browser_ie)?_20.innerText:_20.textContent;_zF3(_20);return _21;};ComponentArt_Editor.prototype.CopySelection=function(){if(!cart_browser_ie){alert("Please use Control C to copy content.");return;}this.SaveUndo("Copy");if(cart_browser_ie){document.execCommand("Copy",null);}};ComponentArt_Editor.prototype.CutSelection=function(){if(!cart_browser_ie){alert("Please use Control X to cut content.");return;}this.SaveUndo("Cut");if(cart_browser_ie){document.execCommand("Cut",null);}if(this.SelectionBookmark){this.SelectionBookmark.EndOffset=this.SelectionBookmark.StartOffset;this.SelectionBookmark.EndContainer=this.SelectionBookmark.StartContainer;}};ComponentArt_Editor.prototype.PasteHTML=function(_22){if(!cart_browser_ie){alert("Please use Control V to paste content.");return;}this.SaveUndo("Paste");if(cart_browser_ie){var _23;if(_22){_23=this.get_clipboardCleanHTML();var _24=this.document.selection.createRange();if(!ComponentArt_IsSelectionEmpty(_z110(this.element))){_24.moveEnd("character",-1);}_24.pasteHTML(_23);_24.collapse(false);_24.moveStart("textedit");this.SelectionBookmark=this.SelectionBookmarkPaths=null;}else{this.document.execCommand("Paste",null);}}else{this.document.execCommand("Paste",null);}};ComponentArt_Editor.prototype.get_characterCount=function(){var _25=(cart_browser_ie)?this.document.body.innerText.replace(/\r\n|\r|\n/g,"").length:this.document.body.textContent.replace(/\r\n|\r|\n/g,"").length;return _25;};ComponentArt_Editor.prototype.get_wordCount=function(){if(this.get_characterCount()==0){return 0;}return (cart_browser_ie)?this.document.body.innerText.split(" ").length:this.document.body.textContent.split(" ").length;};ComponentArt_Editor.prototype.get_contentText=function(){return (cart_browser_ie)?this.document.body.innerText:this.document.body.textContent;};ComponentArt_Editor.prototype.set_contentText=function(_26){this.document.body.innerHTML=_26;if(cart_browser_mozilla){this.document.designMode="off";this.document.designMode="on";}this.textarea.value=ComponentArt_SerializeDomElements(this.document.body.childNodes);this.DomTrace();};ComponentArt_Editor.prototype.set_contentHTML=function(_27){this.document.body.innerHTML=_27;if(cart_browser_mozilla){this.document.designMode="off";this.document.designMode="on";}this.textarea.value=ComponentArt_SerializeDomElements(this.document.body.childNodes);this.DomTrace();};ComponentArt_Editor.prototype.get_contentHTML=function(_28){return ComponentArt_SerializeDomElements(this.document.body.childNodes);};ComponentArt_Editor.prototype.New=function(){this.DesignMode();if(this.EditEngine=="Browser"){this.document.body.innerHTML="";}else{this.document.body.innerHTML="<div>&nbsp;</div>";}};ComponentArt_Editor.prototype.GetProperty=function(_29){return this[_29];};ComponentArt_Editor.prototype.SetProperty=function(_2a,_2b){this[_2a]=_2b;};ComponentArt_Editor.prototype.Render=function(){};ComponentArt_Editor.prototype.UpdateCounts=function(){var _2c=document.getElementById(this.Id+"_t_wordcount");var _2d=document.getElementById(this.Id+"_t_charactercount");if(_2c){_2c.innerHTML=this.get_wordCount();}if(_2d){_2d.innerHTML=this.get_characterCount();}};ComponentArt_Editor.prototype.UpdateBreadcrumbs=function(){var _2e=document.getElementById(this.Id+"_Breadcrumbs");this.BreadcrumbArray=new Array();if(!this.GetClientTemplate(this.BreadcrumbClientTemplateId)&&this.ClientTemplates.length>0){this.BreadcrumbClientTemplateId=this.ClientTemplates[0][0];}if(_2e&&this.LastElement){var _2f=this.LastElement;var _30="";var _31=0;while(_2f&&_2f.nodeName&&_2f.nodeName!="BODY"){if(_2f.nodeType!=3){var _32=new Object();_32.breadcrumb=_2f.nodeName;this.BreadcrumbArray[this.BreadcrumbArray.length]=_2f;var _33=ComponentArt_InstantiateClientTemplate(this.GetClientTemplate(this.BreadcrumbClientTemplateId),this,_32);var _34=(_31>0)?this.BreadcrumbSeparator+_30:_30;_30="<div onclick=\"ComponentArt_SelectElement("+this.Id+".element,"+this.Id+".BreadcrumbArray["+_31+"]);\" onmouseout=\""+this.Id+".BreadcrumbArray["+_31+"].className = "+this.Id+".BreadcrumbArray["+_31+"].className.replace('"+this.HighlightElementCssClass+"','');\" onmouseover=\""+this.Id+".BreadcrumbArray["+_31+"].className += ' "+this.HighlightElementCssClass+"';\" class=\""+this.BreadcrumbCssClass+"\">"+_33+"</div>"+_34;_31++;if(_31>this.get_maxBreadcrumbs()-1){break;}}_2f=_2f.parentNode;}if(_31>this.get_maxBreadcrumbs()-1){var _32=new Object();_32.breadcrumb="...";this.BreadcrumbArray[this.BreadcrumbArray.length]=this.document.body;var _33=ComponentArt_InstantiateClientTemplate(this.GetClientTemplate(this.BreadcrumbClientTemplateId),this,_32);_30="<div onclick=\"ComponentArt_SelectElement("+this.Id+".element,"+this.Id+".BreadcrumbArray["+_31+"]);\" onmouseout=\""+this.Id+".BreadcrumbArray["+_31+"].className = "+this.Id+".BreadcrumbArray["+_31+"].className.replace('"+this.HighlightElementCssClass+"','');\" onmouseover=\""+this.Id+".BreadcrumbArray["+_31+"].className += ' "+this.HighlightElementCssClass+"';\" class=\""+this.BreadcrumbCssClass+"\">"+_33+"</div>"+this.BreadcrumbSeparator+_30;}else{if(this.get_editMode()=="Default"){var _32=new Object();_32.breadcrumb="BODY";this.BreadcrumbArray[this.BreadcrumbArray.length]=this.document.body;var _33=ComponentArt_InstantiateClientTemplate(this.GetClientTemplate(this.BreadcrumbClientTemplateId),this,_32);_30="<div onclick=\"ComponentArt_SelectElement("+this.Id+".element,"+this.Id+".BreadcrumbArray["+_31+"]);\" onmouseout=\""+this.Id+".BreadcrumbArray["+_31+"].className = "+this.Id+".BreadcrumbArray["+_31+"].className.replace('"+this.HighlightElementCssClass+"','');\" onmouseover=\""+this.Id+".BreadcrumbArray["+_31+"].className += ' "+this.HighlightElementCssClass+"';\" class=\""+this.BreadcrumbCssClass+"\">"+_33+"</div>"+this.BreadcrumbSeparator+_30;}}this.Depth=_31;_2e.innerHTML=_30;}};ComponentArt_Editor.prototype.UpdateActions=function(){return false;var _35=document.getElementById(this.Id+"_Actions");var _36="";for(i=0;i<this.UndoStates.length;i++){_36+=this.UndoStates[i].action+" > ";}for(i=this.RedoStates.length-1;i>=0;i--){_36+=" < "+this.RedoStates[i].action;}_35.innerHTML=_36;this.Focus();};ComponentArt_Editor.prototype.DesignMode=function(){if(this.get_mode()=="source"){this.set_mode("design");setTimeout("ComponentArt_EnableDisableChildControls(window."+this.Id+",true);",1);this.textarea.style.visibility="hidden";this.textarea.style.display="none";this.element.style.display="";this.element.style.visibility="";if(this.PreserveRelativePaths){this.document.body.innerHTML=ComponentArt_ReplacePaths(this.textarea.value);}else{this.document.body.innerHTML=this.textarea.value;}this.document.body.className=this.DesignCssClass;setTimeout(this.Id+".Focus();"+this.Id+".DomTrace();"+this.Id+".UpdateBreadcrumbs()",50);}};ComponentArt_Editor.prototype.Focus=function(){if(this.get_editing()&&this.element&&this.element.style.display!="none"&&this.element.style.visibility!="false"&&ComponentArt_IsVisible(this.element)){this.element.contentWindow.focus();if(cart_browser_mozilla){this.document.body.style.overflow="hidden";this.document.body.style.overflow="auto";}}};ComponentArt_Editor.prototype.SourceMode=function(){if(this.get_mode()=="design"&&this.get_editing()){this.set_mode("source");this.textarea.className=this.SourceCssClass;if(cart_browser_mozilla){this.textarea.spellcheck=false;}if(this.get_editMode()!="Default"){var _37=cart_browser_ie?0:-2;var _38=cart_browser_ie?-2:0;this.textarea.style.left=_z86(this.element)+"px";this.textarea.style.top=_z87(this.element)+"px";var _39=(ComponentArt_GetAdjustedWidth(this.element)+_38);var _3a=(ComponentArt_GetAdjustedHeight(this.element)+_37);}this.textarea.value=ComponentArt_SerializeDomElements(this.document.body.childNodes);this.textarea.style.visibility="";this.textarea.style.display="";this.element.style.display="none";if(this.get_editMode()!="Default"){ComponentArt_SetAdjustedWidth(this.textarea,_39);ComponentArt_SetAdjustedHeight(this.textarea,_3a);}this.textarea.focus();var _3b=document.getElementById(this.Id+"_Breadcrumbs");if(_3b){var _3c=new Object();_3c.breadcrumb="N/A";var _3d=ComponentArt_InstantiateClientTemplate(this.GetClientTemplate(this.BreadcrumbClientTemplateId),this,_3c);output=_3d;if(_3b){_3b.innerHTML=output;}}}};ComponentArt_Editor.prototype.Edit=function(_3e){if(this.get_editMode()=="Default"){return;}this.DesignMode();if(this.get_editElement()){this.EditElement.style.visibility="visible";}var x=_z86(_3e);var y=_z87(_3e);var _41=_3e.offsetWidth;var _42=_3e.offsetHeight;this.element.style.left=x+"px";this.element.style.top=y+"px";ComponentArt_SetAdjustedWidth(this.element,_41);ComponentArt_SetAdjustedHeight(this.element,_42);this.element.style.display="";if(_3e.innerHTML||_3e.nodeValue){this.document.body.innerHTML=(_3e.innerHTML)?_3e.innerHTML:_3e.nodeValue;}_3e.style.visibility="hidden";this.set_editing(true);this.set_editElement(_3e);this.Focus();};ComponentArt_Editor.prototype.Update=function(){if(this.get_editMode()=="Default"||!this.get_editing()){return;}this.DesignMode();var _43=this.get_contentHTML();if(this.get_editElement().innerHTML){this.EditElement.innerHTML=_43;}else{this.EditElement.nodeValue=_43;}this.EditElement.style.visibility="visible";this.set_editing(false);this.set_editElement(null);this.element.style.top="-10000px";this.element.style.left="-10000px";this.element.focus();this.element.style.display="none";var _44=this.get_events().getHandler("contentUpdate");if(_44){_44(this,Sys.EventArgs.Empty);}};ComponentArt_Editor.prototype.Cancel=function(){if(this.get_editMode()=="Default"||!this.get_editing()){return;}this.DesignMode();this.EditElement.style.visibility="visible";this.set_editing(false);this.set_editElement(null);this.element.style.top="-10000px";this.element.style.left="-10000px";this.element.focus();this.element.style.display="none";};ComponentArt_Editor.prototype.CntrlCommand=function(_45,_46){switch(_45){case "b":var _47=this.getStyle("font-weight");this.SetStyle("font-weight",(_47==700||_47=="bold")?"normal":"700");ComponentArt_CancelEvent(_46);return false;break;case "i":this.SetStyle("font-style",(this.getStyle("font-style")=="italic")?"normal":"italic");ComponentArt_CancelEvent(_46);return false;break;case "u":this.SetStyle("text-decoration",(this.getStyle("text-decoration")=="underline")?"":"underline");ComponentArt_CancelEvent(_46);return false;break;case "v":if(cart_browser_ie){this.SelectionBookmark=this.SelectionBookmarkPaths=null;this.SaveBookmark();this.PasteHTML(true);ComponentArt_CancelEvent(_46);}else{this.SaveUndo("Paste");return true;}return false;break;case "c":this.SaveUndo("Copy");if(cart_browser_ie){document.execCommand("Copy",null);this.Focus();ComponentArt_CancelEvent(_46);return false;}break;case "x":this.SaveUndo("Cut");if(cart_browser_ie){document.execCommand("Cut",null);this.Focus();ComponentArt_CancelEvent(_46);return false;}break;case "z":this.Undo();ComponentArt_CancelEvent(_46);break;case "y":this.Redo();ComponentArt_CancelEvent(_46);break;}return true;};ComponentArt_Editor.prototype.GetStyle=function(_48){if(!this.element){return;}var _49=this.element.contentWindow;var eck=cart_editor_css_key;if(this.LastElement){var _4b=this.LastElement;if(this.LastElement.nodeName=="#text"){_4b=this.LastElement.parentNode;}if(!cart_browser_ie){try{return this.document.defaultView.getComputedStyle(_4b,null).getPropertyValue(_48);}catch(err){return null;}}else{if(this.LastElement.currentStyle&&_48&&eck[_48]){return this.LastElement.currentStyle[eck[_48]];}}}return null;};ComponentArt_Editor.prototype.SetStyle=function(key,_4d){this.SaveUndo("Set "+key+":"+_4d);var eck=cart_editor_css_key;if(this.EditEngine=="Browser"){switch(key.toLowerCase()){case "color":this.RestoreBookmark(true);this.document.execCommand("ForeColor",false,_4d);this.Focus();this.DomTrace();return;break;case "background-color":this.RestoreBookmark(true);this.document.execCommand("BackColor",false,_4d);this.Focus();this.DomTrace();return;break;case "font-family":this.RestoreBookmark(true);this.document.execCommand("FontName",false,_4d);this.Focus();this.DomTrace();return;break;}}if(this.SelectionBookmark&&this.SelectionBookmark.IsEmpty){var id="s_"+Math.floor(Math.random()*100+100);if(cart_browser_ie){var _50="<span id='"+id+"'>&#8204;</span>";this.SelectionBookmark.Range.pasteHTML(_50);this.SelectionBookmark.Range.collapse(false);var _51=this.document.getElementById(id);_51.style[eck[key]]=_4d;_51.id=null;this.SelectionBookmark.Range.moveToElementText(_51);this.SelectionBookmark.Range.select();this.DomTrace();}else{var _50="<span style='"+key+":"+_4d+";'></span>";this.document.execCommand("insertHTML",false,_50);this.Focus();this.DomTrace();}}else{this.RestoreBookmark();_z164(this.element,this.SelectionBookmark,{"Element":"SPAN","StyleString":key+":"+_4d});setTimeout(this.Id+".Focus();"+this.Id+".DomTrace();",1);}};ComponentArt_Editor.prototype.InsertFormElement=function(_52){_52=_52.toUpperCase();switch(_52){case "FORM":var _53=this.document.createElement("FORM");_53.setAttribute("id","Form1");_53.setAttribute("style","height:150px;width:150px;");_53.innerHTML="&nbsp;";ComponentArt_InsertDomElement(this.element,_53);break;case "BUTTON":var _53=this.document.createElement("INPUT");_53.setAttribute("type",_52);_53.setAttribute("value","button");ComponentArt_InsertDomElement(this.element,_53);break;case "CHECKBOX":var _53=this.document.createElement("INPUT");_53.setAttribute("type",_52);ComponentArt_InsertDomElement(this.element,_53);break;case "HIDDEN":var _53=this.document.createElement("INPUT");_53.setAttribute("type",_52);ComponentArt_InsertDomElement(this.element,_53);break;case "RADIO":var _53=this.document.createElement("INPUT");_53.setAttribute("type",_52);ComponentArt_InsertDomElement(this.element,_53);break;case "PASSWORD":var _53=this.document.createElement("INPUT");_53.setAttribute("type",_52);ComponentArt_InsertDomElement(this.element,_53);break;case "RESET":var _53=this.document.createElement("INPUT");_53.setAttribute("type",_52);_53.setAttribute("value","reset");ComponentArt_InsertDomElement(this.element,_53);break;case "SELECT":var _53=this.document.createElement("SELECT");ComponentArt_InsertDomElement(this.element,_53);break;case "TEXTBOX":var _53=this.document.createElement("INPUT");_53.setAttribute("type","text");ComponentArt_InsertDomElement(this.element,_53);break;case "TEXTAREA":var _53=this.document.createElement("TEXTAREA");ComponentArt_InsertDomElement(this.element,_53);break;case "SUBMIT":var _53=this.document.createElement("INPUT");_53.setAttribute("type",_52);_53.setAttribute("value","submit");ComponentArt_InsertDomElement(this.element,_53);break;}};ComponentArt_Editor.prototype.TableInsertRow=function(_54){var _55=this.HasParent("TD");if(!_55){return;}this.SaveUndo("Insert Row");if(this.SelectionBookmarkPaths){this.Focus();_z163(this.element,ComponentArt_SelectionPathsToInfo(this.element,this.SelectionBookmarkPaths));this.SelectionBookmarkPaths=null;}var _56=ComponentArt_GetTDInfo(_55);var _57=this.document.createElement("TR");for(x=0;x<_56.table.rows[_56.row].cells.length;x++){var _58=_56.table.rows[_56.row].cells[x].cloneNode(false);_58.innerHTML="&nbsp;";_57.appendChild(_58);}if(_54){_56.table.firstChild.insertBefore(_57,_56.table.rows[_56.row].nextSibling);}else{_56.table.firstChild.insertBefore(_57,_56.table.rows[_56.row]);}};ComponentArt_Editor.prototype.TableInsertColumn=function(_59){var _5a=this.HasParent("TD");if(!_5a){return;}this.SaveUndo("Insert Column");if(this.SelectionBookmarkPaths){this.Focus();_z163(this.element,ComponentArt_SelectionPathsToInfo(this.element,this.SelectionBookmarkPaths));this.SelectionBookmarkPaths=null;}var _5b=ComponentArt_GetTDInfo(_5a);for(x=0;x<_5b.table.rows.length;x++){var _5c=this.document.createElement("TD");_5c.innerHTML="&nbsp;";if(_59){_5b.table.rows[x].insertBefore(_5c,_5b.table.rows[x].cells[_5b.col].nextSibling);}else{_5b.table.rows[x].insertBefore(_5c,_5b.table.rows[x].cells[_5b.col]);}}};ComponentArt_Editor.prototype.TableDeleteCell=function(){var _5d=this.HasParent("TD");if(!_5d){return;}this.SaveUndo("Delete Cell");if(this.SelectionBookmarkPaths){this.Focus();_z163(this.element,ComponentArt_SelectionPathsToInfo(this.element,this.SelectionBookmarkPaths));this.SelectionBookmarkPaths=null;}var _5e=ComponentArt_GetTDInfo(_5d);if(_5d.previousSibling){_5d.previousSibling.colSpan=_5d.previousSibling.colSpan+_5d.colSpan;ComponentArt_FocusElement(this.element,_5d.previousSibling);}else{if(_5d.nextSibling){_5d.nextSibling.colSpan=_5d.nextSibling.colSpan+_5d.colSpan;ComponentArt_FocusElement(this.element,_5d.nextSibling);}}_5d.parentNode.removeChild(_5d);if(ComponentArt_IsTableEmpty(_5e.table)){_5e.table.parentNode.removeChild(_5e.table);}this.DomTrace();};ComponentArt_Editor.prototype.TableDeleteColumn=function(){var col=this.HasParent("TD");if(!col){return;}this.SaveUndo("Delete Column");if(this.SelectionBookmarkPaths){this.Focus();_z163(this.element,ComponentArt_SelectionPathsToInfo(this.element,this.SelectionBookmarkPaths));this.SelectionBookmarkPaths=null;}var _60=ComponentArt_GetTDInfo(col);for(x=0;x<_60.table.rows.length;x++){if(_60.table.rows[x].cells[_60.col]){_60.table.rows[x].removeChild(_60.table.rows[x].cells[_60.col]);}}if(ComponentArt_IsTableEmpty(_60.table)){_60.table.parentNode.removeChild(_60.table);}this.DomTrace();};ComponentArt_Editor.prototype.TableDeleteRow=function(){var row=this.HasParent("TR");if(!row){return;}var _62=row.parentNode.parentNode;this.SaveUndo("Delete Row");if(this.SelectionBookmarkPaths){this.Focus();_z163(this.element,ComponentArt_SelectionPathsToInfo(this.element,this.SelectionBookmarkPaths));this.SelectionBookmarkPaths=null;}row.parentNode.removeChild(row);if(ComponentArt_IsTableEmpty(_62)){_62.parentNode.removeChild(_62);}this.DomTrace();};ComponentArt_Editor.prototype.TableMergeCellRight=function(){var _63=this.HasParent("TD");if(!_63){return;}this.SaveUndo("Merge Cell Right");this.DomTrace();};ComponentArt_Editor.prototype.TableMergeCellDown=function(){var _64=this.HasParent("TD");if(!_64){return;}this.SaveUndo("Merge Cell Down");this.DomTrace();};ComponentArt_Editor.prototype.TableSplitCellHorizontal=function(){var _65=this.HasParent("TD");if(!_65){return;}this.SaveUndo("Split Cell");var _66=ComponentArt_GetTDInfo(_65);var _67=this.document.createElement("TD");_67.innerHTML="&nbsp;";_66.table.rows[_66.row].insertBefore(_67,_65.nextSibling);if(_65.colSpan>1){_65.colSpan=_65.colSpan-1;}else{for(x=0;x<_66.table.rows.length;x++){if(_66.table.rows[x].cells[_66.col]){if(_66.table.rows[x].cells[_66.col]!=_65){_66.table.rows[x].cells[_66.col].colSpan=_66.table.rows[x].cells[_66.col].colSpan+1;}}}}this.DomTrace();};ComponentArt_Editor.prototype.TableSplitCellVertical=function(){var _68=this.HasParent("TD");if(!_68){return;}this.SaveUndo("Split Cell");var _69=ComponentArt_GetTDInfo(_68);if(_68.rowSpan>1){var _6a=this.document.createElement("TD");_6a.innerHTML="&nbsp;";_69.table.rows[_69.row+1].insertBefore(_6a,_69.table.rows[_69.row+1].cells[_69.col].nextSibling);_68.rowSpan=_68.rowSpan-1;}else{for(x=0;x<_69.table.rows[_69.row].cells.length;x++){if(_69.table.rows[_69.row].cells[x]){if(_69.table.rows[_69.row].cells[x]!=_68){_69.table.rows[_69.row].cells[x].rowSpan=_69.table.rows[_69.row].cells[x].rowSpan+1;}}}var tr=this.document.createElement("TR");var _6a=this.document.createElement("TD");_6a.innerHTML="&nbsp;";tr.appendChild(_6a);_69.table.firstChild.insertBefore(tr,_69.table.rows[_69.row].nextSibling);}this.DomTrace();};ComponentArt_Editor.prototype.TableMergeCellDown=function(){var _6c=this.HasParent("TD");if(!_6c){return;}var _6d=ComponentArt_GetTDInfo(_6c);if(!_6d.table.rows[_6d.row+1]||!_6d.table.rows[_6d.row+1].cells[_6d.col]){return;}this.SaveUndo("Merge Down");_6c.innerHTML=_6c.innerHTML+_6d.table.rows[_6d.row+1].cells[_6d.col].innerHTML;_6c.rowSpan=_6c.rowSpan+1;_6d.table.rows[_6d.row+1].removeChild(_6d.table.rows[_6d.row+1].cells[_6d.col]);this.DomTrace();};ComponentArt_Editor.prototype.TableMergeCellRight=function(){var _6e=this.HasParent("TD");if(!_6e||!_6e.nextSibling){return;}this.SaveUndo("Merge Right");_6e.innerHTML+=_6e.nextSibling.innerHTML;_6e.colSpan=_6e.colSpan+1;_6e.parentNode.removeChild(_6e.nextSibling);this.DomTrace();};ComponentArt_Editor.prototype.ToggleUnorderedList=function(){this.SaveUndo("Unordered List");if(this.SelectionBookmarkPaths){_z163(this.element,ComponentArt_SelectionPathsToInfo(this.element,this.SelectionBookmarkPaths));this.SelectionBookmarkPaths=null;}else{if(this.SelectionBookmark){_z163(this.element,this.SelectionBookmark);this.set_selectionBookmark(null);}}this.document.execCommand("InsertUnorderedList",false,null);this.DomTrace();this.Focus();};ComponentArt_Editor.prototype.ToggleOrderedList=function(){this.SaveUndo("Ordered List");if(this.SelectionBookmarkPaths){_z163(this.element,ComponentArt_SelectionPathsToInfo(this.element,this.SelectionBookmarkPaths));this.SelectionBookmarkPaths=null;}else{if(this.SelectionBookmark){_z163(this.element,this.SelectionBookmark);this.set_selectionBookmark(null);}}this.document.execCommand("InsertOrderedList",false,null);this.DomTrace();this.Focus();};ComponentArt_Editor.prototype.GetTopUnorderedList=function(_6f){return this.TopParent("UL",_6f);};ComponentArt_Editor.prototype.GetTopOrderedList=function(_70){return this.TopParent("OL",_70);};ComponentArt_Editor.prototype.SetUnorderedListCssClass=function(_71,_72){var _73=this.GetTopUnorderedList(_72);if(_73){_73.className=_71;}};ComponentArt_Editor.prototype.SetOrderedListCssClass=function(_74,_75){var _76=this.GetTopOrderedList(_75);if(_76){_76.className=_74;}};ComponentArt_Editor.prototype.get_selectionText=function(){var doc=this.element.contentWindow.document;var _78;if(cart_browser_ie){if(doc.selection&&doc.selection.createRange){_78=doc.selection.createRange().text;}}else{if(doc.getSelection){_78=doc.getSelection();}}return _78;};ComponentArt_Editor.prototype.get_selection=function(){return _z110(this.element);};ComponentArt_Editor.prototype.set_selection=function(_79){return _z163(this.element,_79);};ComponentArt_Editor.prototype.ApplyTag=function(tag){this.SaveUndo("Tag "+tag);if(cart_browser_ie&&this.SelectionBookmark){var _7b=this.SelectionBookmark;this.SelectionBookmark=null;}else{var _7b=_z110(this.element);}_z164(this.element,_7b,{"Element":tag,"StyleString":""});setTimeout(this.Id+".element.contentWindow.focus();"+this.Id+".DomTrace()",1);};ComponentArt_Editor.prototype.ToggleStyle=function(key,_7d){};ComponentArt_Editor.prototype.SaveData=function(){if(this.EnableViewState){var _7e=document.getElementById(this.Id+"_Content");if(_7e){var _7f;if(this.get_mode()=="source"&&document.getElementById(this.Id+"_Textarea")){_7f=document.getElementById(this.Id+"_Textarea").value;}else{_7f=this.document.body.innerHTML;}var _80=window.encodeURIComponent?encodeURIComponent(_7f):escape(_7f);_7e.value=_80;}var _81=document.getElementById(this.Id+"_Text");if(_81){var _7f=cart_browser_ie?this.document.body.innerText:this.document.body.textContent;_81.value=_7f;}}var _82=document.getElementById(this.Id+"_Textarea");if(_82){_82.value="";}};ComponentArt_Editor.prototype.InsertImage=function(url,alt,_85,_86,_87,_88,_89,_8a,_8b,_8c){image=this.document.createElement("IMG");if(url){if(this.PreserveRelativePaths&&url.toLowerCase().indexOf("http")==-1){image.setAttribute("relativesrc",url);}if(cart_browser_mozilla&&url.toLowerCase().indexOf("http")==-1){var _8d=location.href.substring(0,location.href.indexOf("/",10));url=(url.substring(0,1)=="/")?_8d+url:_8d+"/"+url;}image.setAttribute("src",url);}if(alt){image.setAttribute("alt",alt);}if(_85){image.setAttribute("width",_85);}if(_86){image.setAttribute("height",_86);}if(_88){image.setAttribute("border",_88);}if(_89){image.setAttribute("hspace",_89);}if(_8a){image.setAttribute("vspace",_8a);}if(_8b){image.setAttribute(cart_browser_ie?"className":"class",_8b);}if(_8c){image.setAttribute("style",_8c);}ComponentArt_InsertDomElement(this.element,image);};ComponentArt_Editor.prototype.InsertHyperlink=function(url,_8f,_90,_91,id,_93,_94){link=ComponentArt_CreateElementWithName(this.document,"A",_93);if(url){link.setAttribute("href",url);}if(_8f){link.innerHTML=_8f;}if(_90){link.setAttribute("target",_90);}if(_94){link.setAttribute("tooltip",_94);}if(_91){link.setAttribute(cart_browser_ie?"className":"class",_91);}if(id){link.setAttribute("id",id);}ComponentArt_InsertDomElement(this.element,link,link);};ComponentArt_Editor.prototype.SaveUndo=function(_95){this.RedoStates=new Array();var _96=new Object;_96.innerHTML=this.document.body.innerHTML;_96.selection=ComponentArt_SelectionInfoToPaths(this.get_selection());_96.action=_95;this.action=_95;this.UndoStates.push(_96);this.typing=false;this.RaiseContextChange();this.UpdateActions();};ComponentArt_Editor.prototype.Redo=function(_97){if(_97==null){_97=1;}if(this.RedoStates.length<_97){return;}if(this.get_mode()!="design"){return;}var _98={"innerHTML":this.document.body.innerHTML,"selection":ComponentArt_SelectionInfoToPaths(this.get_selection())};for(var i=0;i<_97;i++){var _9a=this.RedoStates.pop();_98.action=_9a.action;this.UndoStates.push(_98);_98=_9a;}this.document.body.innerHTML=_98.innerHTML.toString();this.DomTrace();try{this.set_selection(ComponentArt_SelectionPathsToInfo(this.element,_98.selection));}catch(err){}this.RaiseContextChange();this.UpdateActions();this.Focus();};ComponentArt_Editor.prototype.Undo=function(_9b){if(_9b==null){_9b=1;}if(this.UndoStates.length<_9b){return;}if(this.get_mode()!="design"){return;}var _9c={"innerHTML":this.document.body.innerHTML,"selection":ComponentArt_SelectionInfoToPaths(this.get_selection())};for(var i=0;i<_9b;i++){var _9e=this.UndoStates.pop();_9c.action=_9e.action;this.RedoStates.push(_9c);_9c=_9e;}this.document.body.innerHTML=_9c.innerHTML.toString();this.DomTrace();this.set_selection(ComponentArt_SelectionPathsToInfo(this.element,_9c.selection));this.RaiseContextChange();this.UpdateActions();this.SaveBookmark();this.Focus();};ComponentArt_Editor.prototype.BeforeElementChange=function(){};ComponentArt_Editor.prototype.AfterElementChange=function(){this.UpdateBreadcrumbs();this.RaiseContextChange();};ComponentArt_Editor.prototype.DomTrace=function(_9f){if(!this.element){return;}this.UpdateCounts();if(cart_browser_ie){_9f=this.element.contentWindow.event;var _a0=this.document.selection.createRange();if(!_a0.parentElement){return;}_9f=_a0.parentElement();if(this.LastElement!=_9f){this.BeforeElementChange();this.LastElement=_9f;this.AfterElementChange();}}else{var _a0=this.element.contentWindow.getSelection(this.element);if(_a0){_9f=_a0.anchorNode;}else{return;}if(this.LastElement!=_9f){this.BeforeElementChange();this.LastElement=_9f;this.AfterElementChange();}}};ComponentArt_Editor.prototype.HasParent=function(_a1){var _a2=this.LastElement;var _a3=0;while(_a2&&_a2.nodeName!="BODY"){if(_a2.nodeName.indexOf(_a1)>-1){_a2.depth=_a3;return _a2;}_a3++;_a2=_a2.parentNode;}return false;};ComponentArt_Editor.prototype.TopParent=function(_a4,_a5){var _a6=_a5?_a5:this.LastElement;var _a7=false;while(_a6&&_a6.nodeName!="BODY"){if(_a6.nodeName.indexOf(_a4)>-1){_a7=_a6;}_a6=_a6.parentNode;}return _a7;};ComponentArt_Editor.prototype.HasCssClass=function(_a8){var _a9=this.LastElement;if(!_a9){return false;}if(cart_browser_ie){while(_a9.nodeName!="BODY"){if(_a9.className==_a8){return true;}_a9=_a9.parentNode;}}else{while(_a9&&_a9.nodeName&&_a9.nodeName!="BODY"){if(_a9.className==_a8){return true;}_a9=_a9.parentNode;}}return false;};ComponentArt_Editor.prototype.SetIndent=function(_aa){this.SaveUndo("Indent");if(this.EditEngine=="Browser"){if(_aa>0){this.document.execCommand("Indent","","");}else{this.document.execCommand("Outdent","","");}return;}var _ab=25;var _ac=this.HasParent("LI");if(_ac){var _ad=(_ac.style.marginLeft-0==0)?0:parseInt(_ac.style.marginLeft);var _ae=_ad+(_aa*_ab);if(_ae>=0){_ac.style.marginLeft=_ae+"px";}return;}var _af=this.HasParent("DIV");if(_af){var _ad=(_af.style.marginLeft-0==0)?0:parseInt(_af.style.marginLeft);var _ae=_ad+(_aa*_ab);if(_ae>=0){_af.style.marginLeft=_ae+"px";}}else{var _b0=this.document.createElement("div");var _ae=_aa*_ab;if(_ae>=0){_b0.style.marginLeft=_ae+"px";}if(this.LastElement.nodeName=="BODY"){var _b1=this.LastElement.innerHTML;_b0.innerHTML=_b1;this.LastElement.innerHTML="";this.LastElement.appendChild(_b0);}else{var _b2=this.HasParent("P");if(_b2){var _ad=(_b2.style.marginLeft-0==0)?0:parseInt(_b2.style.marginLeft);var _ae=_ad+(_aa*_ab);if(_ae>=0){_b2.style.marginLeft=_ae+"px";}}}}this.Focus();};ComponentArt_Editor.prototype.SetAlign=function(_b3){this.SaveUndo("Align");if(this.EditEngine=="Browser"){switch(_b3.toLowerCase()){case "right":this.document.execCommand("JustifyRight",false,null);return;break;case "left":this.document.execCommand("JustifyLeft",false,null);return;break;case "center":this.document.execCommand("JustifyCenter",false,null);return;break;case "justify":this.document.execCommand("JustifyFull",false,null);return;break;}}var _b4=this.LastElement;if(_b4.nodeName=="TD"){_b4.style.textAlign=_b3;return;}_b4=this.HasParent("TABLE");if(_b4){_b4.style.textAlign=_b3;return;}_b4=this.HasParent("H");if(_b4){_b4.style.textAlign=_b3;return;}_b4=this.HasParent("LI");if(_b4){_b4.style.textAlign=_b3;return;}_b4=this.HasParent("DIV");if(_b4){_b4.style.textAlign=_b3;}else{switch(_b3.toLowerCase()){case "right":this.document.execCommand("JustifyRight",false,null);return;break;case "left":this.document.execCommand("JustifyLeft",false,null);return;break;case "center":this.document.execCommand("JustifyCenter",false,null);return;break;case "justify":this.document.execCommand("JustifyFull",false,null);return;break;}}this.DomTrace();this.Focus();};ComponentArt_Editor.prototype.GetListContext=function(){var _b5=this.HasParent("OL");var _b6=this.HasParent("UL");if(_b5&&!_b6||_b5.depth<_b6.depth){return _b5;}if(_b6&&!_b5||_b6.depth<_b5.depth){return _b6;}return false;};ComponentArt_Editor.prototype.SaveBookmark=function(){if(this.get_mode()=="source"||this.get_editMode()!="Default"||!this.element){return;}this.SelectionBookmark=_z110(this.element);this.SelectionBookmarkPaths=ComponentArt_SelectionInfoToPaths(_z110(this.element));};window.ComponentArt_TraceBookmark=function(_b7){return _b7.CommonAncestorContainer.nodeName+", "+_b7.StartContainer.nodeName+", "+_b7.StartOffset+" - "+_b7.EndOffset;};ComponentArt_Editor.prototype.RestoreBookmark=function(_b8){if(!cart_browser_ie){return;}if(_b8&&ComponentArt_IsSelectionEmpty(this.SelectionBookmark)){if(this.SelectionBookmark){_z163(this.element,this.SelectionBookmark);}else{if(this.SelectionBookmarkPaths){_z163(this.element,ComponentArt_SelectionPathsToInfo(this.element,this.SelectionBookmarkPaths));}}}else{if(this.SelectionBookmarkPaths){_z163(this.element,ComponentArt_SelectionPathsToInfo(this.element,this.SelectionBookmarkPaths));}else{if(this.SelectionBookmark){_z163(this.element,this.SelectionBookmark);}}}};ComponentArt_Editor.prototype.Save=function(){var _b9=true;var _ba;if(this.get_mode()=="source"&&document.getElementById(this.Id+"_Textarea")){_ba=document.getElementById(this.Id+"_Textarea").value;}else{_ba=this.document.body.innerHTML;}_ba=_ba.replace(/</g,"%#CLT#%");var _bb=window.encodeURIComponent?encodeURIComponent(_ba):escape(_ba);var _bc=cart_browser_ie?this.document.body.innerText:this.document.body.textContent;var _bd=window.encodeURIComponent?encodeURIComponent(_bc):escape(_bc);var _be="Cart_"+this.Id+"_Content="+_bb+"&Cart_"+this.Id+"_Text="+_bd;var url=location.href;url+=url.indexOf("?")>0?"&":"?";url+="Cart_"+this.Id+"_Callback=yes";var _c0=this;var _c1=false;var _c2;var _c3=null;function Cleanup(){_c0.CallingBack=false;}function _z19F(){if(_c2.readyState&&_c2.readyState!=4&&_c2.readyState!="complete"){return;}var _c4=_c1?_c2.responseXML:_c2;if(_c4&&_c4.documentElement&&_c4.documentElement.childNodes.length==1){var _c5=_c4.documentElement.childNodes[0];var _c6=_c5.nodeValue;_c3=eval(_c6);if(_c3){var _c7=_c0.get_events().getHandler("saveSuccess");if(_c7){_c7(_c0,Sys.EventArgs.Empty);}}else{var _c7=_c0.get_events().getHandler("saveError");if(_c7){_c7(_c0,Sys.EventArgs.Empty);}}}else{if(_c2.status&&_c2.status!=200&&_c2.responseText){document.body.innerHTML=_c2.responseText;}else{alert("Error loading callback data.");}}Cleanup();}this.CallingBack=true;if(window.XMLHttpRequest){_c1=true;var _c2=new XMLHttpRequest();_c2.onreadystatechange=_z19F;_c2.open("POST",url,true);_c2.setRequestHeader("Content-Type","application/x-www-form-urlencoded");_c2.send(_be);}else{if(document.implementation&&document.implementation.createDocument){_c2=document.implementation.createDocument("","",null);_c2.onload=_z19F;}else{if(cart_browser_ie){if(window.ActiveXObject){try{_c2=new ActiveXObject("Microsoft.XMLHTTP");_c2.onreadystatechange=_z19F;_c2.open("POST",url,true);_c2.setRequestHeader("Content-Type","application/x-www-form-urlencoded");_c2.send(_be);_c1=true;}catch(ex){}}if(_c2==null){var _c8=this.Id+"_island";var _c9=document.getElementById(_c8);if(!_c9){_c9=document.createElement("xml");_c9.id=_c8;document.body.appendChild(_c9);}if(_c9.XMLDocument){_c2=_c9.XMLDocument;_c2.onreadystatechange=_z19F;}else{return false;}}}else{return false;}}}if(!_c1){_c2.async=true;try{_c2.load(url+"&"+_be);}catch(ex){Cleanup();alert("Data not loaded: "+(ex.message?ex.message:ex));}}return true;};ComponentArt_Editor.prototype.Find=function(_ca,_cb,_cc,_cd){var _ce=ComponentArt_Find(this.element,_ca,_cb,_cc,_cd);if(_ce){_z163(this.element,_ce);ComponentArt_ScrollSelectionIntoView(this.element,_ce);}return _ce;};ComponentArt_Editor.prototype.Replace=function(_cf,_d0,_d1,_d2,_d3){var _d4=ComponentArt_Find(this.element,_cf,_d0,_d1,_d3);if(_d4){this.SaveUndo("Replace");ComponentArt_ScrollSelectionIntoView(this.element,_d4);ComponentArt_Replace(this.element,_d4,_d2);}return _d4;};ComponentArt_Editor.prototype.ReplaceAll=function(_d5,_d6,_d7,_d8){var _d9=ComponentArt_Find(this.element,_d5,_d6,_d7);if(_d9){this.SaveUndo("Replace All");do{if(_da&&_da.StartContainer==_d9.StartContainer&&_da.StartOffset==_d9.StartOffset&&_da.EndOffset==_d9.EndOffset){alert("Error: Some instances could not be replaced.");break;}ComponentArt_Replace(this.element,_d9,_d8);var _da=_d9;}while(_d9=ComponentArt_Find(this.element,_d5,_d6,_d7));}};ComponentArt_Editor.prototype.KeyDown=function(_db){_db=_db?_db:this.element.contentWindow.event;this.DomTrace(_db);if(this.LastElement.nodeName=="BUTTON"){return true;}if(this.EditEngine=="Browser"&&cart_browser_ie){if(ComponentArt_Cntrl&&_db.keyCode!="17"){var key=String.fromCharCode(_db.keyCode).toLowerCase();var _dd="buivcx";if(key=="z"){this.Undo();ComponentArt_CancelEvent(_db);return false;}else{if(key=="y"){this.Redo();ComponentArt_CancelEvent(_db);return false;}else{if(_dd.indexOf(key)>-1){this.SaveUndo("Ctrl Command");}}}}else{if(_db.keyCode=="17"){ComponentArt_Cntrl=true;}}switch(cart_editor_typing_key_codes[_db.keyCode]){case 0:break;case 1:this.typing=false;break;default:if(!this.typing){this.SaveUndo("Typing");this.typing=true;}break;}if(_db.keyCode=="9"){var _de=this.GetListContext();if(_de.nodeName=="OL"){this.SaveUndo("Tab");this.document.execCommand("Indent","","");ComponentArt_CancelEvent(_db);return false;}else{if(_de.nodeName=="UL"){this.SaveUndo("Tab");this.document.execCommand("Indent","","");ComponentArt_CancelEvent(_db);return false;}}var tab=this.document.createElement("span");tab.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;";ComponentArt_InsertDomElement(this.element,tab.firstChild);_zF3(tab);ComponentArt_CancelEvent(_db);return false;}return true;}switch(cart_editor_typing_key_codes[_db.keyCode]){case 0:break;case 1:this.typing=false;break;default:if(!this.typing){this.SaveUndo("Typing");this.typing=true;}break;}if(cart_browser_ie||cart_browser_opera){if(_db.keyCode=="8"){var _de=this.GetListContext();if(_de.nodeName=="OL"){this.SaveUndo("Backspace");var _e0=_z110(this.element);ComponentArt_DebugSelection(_e0);if(_e0.CommonAncestorContainer.nodeName=="LI"&&_e0.StartOffset==0){ComponentArt_CancelEvent(_db);return false;}}}if(_db.keyCode=="9"){var _de=this.GetListContext();if(_de.nodeName=="OL"){this.SaveUndo("Tab");this.document.execCommand("Indent","","");ComponentArt_CancelEvent(_db);return false;}else{if(_de.nodeName=="UL"){this.SaveUndo("Tab");this.document.execCommand("Indent","","");ComponentArt_CancelEvent(_db);return false;}}var tab=this.document.createElement("span");tab.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;";ComponentArt_InsertDomElement(this.element,tab.firstChild);_zF3(tab);ComponentArt_CancelEvent(_db);return false;}if(_db.keyCode=="13"){var _e1=this.HasParent("LI");if(_e1){this.SaveUndo("Enter");var _e2=this.get_events().getHandler("enter");if(_e2){_e2(this,Sys.EventArgs.Empty);}return true;}var _e3=this.HasParent("TD");var _e4=this.HasParent("DIV");if(_e3&&!_e4||_e3&&_e4.depth>_e3.depth){this.SaveUndo("Enter");var _e5=this.document.createElement("div");ComponentArt_AddChildDom(this,_e5);ComponentArt_SplitDomElement(this.element,_e5);ComponentArt_CancelEvent(_db);var _e2=this.get_events().getHandler("enter");if(_e2){_e2(this,Sys.EventArgs.Empty);}return false;}if(_e4){this.SaveUndo("Enter");ComponentArt_SplitDomElement(this.element,_e4);ComponentArt_CancelEvent(_db);var _e2=this.get_events().getHandler("enter");if(_e2){_e2(this,Sys.EventArgs.Empty);}return false;}var _e6=this.HasParent("H");if(_e6){this.SaveUndo("Enter");ComponentArt_SplitDomElement(this.element,_e6);ComponentArt_CancelEvent(_db);var _e2=this.get_events().getHandler("enter");if(_e2){_e2(this,Sys.EventArgs.Empty);}return false;}var _e7=this.HasParent("P");if(_e7){this.SaveUndo("Enter");ComponentArt_SplitDomElement(this.element,_e7);ComponentArt_CancelEvent(_db);var _e2=this.get_events().getHandler("enter");if(_e2){_e2(this,Sys.EventArgs.Empty);}return false;}var _e5=this.document.createElement("div");ComponentArt_AddChildDom(this,_e5);ComponentArt_SplitDomElement(this.element,_e5);ComponentArt_CancelEvent(_db);var _e2=this.get_events().getHandler("enter");if(_e2){_e2(this,Sys.EventArgs.Empty);}return false;}if(ComponentArt_Cntrl&&_db.keyCode!="17"){var _dd="bcdefghijklmnopqrstuvwxyz";if(_dd.indexOf(String.fromCharCode(_db.keyCode).toLowerCase())>-1){return this.CntrlCommand(String.fromCharCode(_db.keyCode).toLowerCase(),_db);}}else{if(_db.keyCode=="17"){ComponentArt_Cntrl=true;}}}else{if(cart_browser_safari){if(_db.which=="13"){r=this.document.selection.createRange();var _e1=this.HasParent("LI");if(_e1){ComponentArt_SplitDomElement(this.element,_e1);ComponentArt_CancelEvent(_db);return;}_db.preventDefault();_db.stopPropagation();return false;}if(_db.ctrlKey){switch(_db.keyCode){case 66:this.CntrlCommand("b",_db);ComponentArt_CancelEvent(_db);_db.preventDefault();_db.stopPropagation();return false;break;case 73:this.CntrlCommand("i",_db);ComponentArt_CancelEvent(_db);_db.preventDefault();_db.stopPropagation();return false;break;case 89:this.CntrlCommand("y",_db);ComponentArt_CancelEvent(_db);_db.preventDefault();_db.stopPropagation();return false;break;case 90:this.CntrlCommand("y",_db);ComponentArt_CancelEvent(_db);_db.preventDefault();_db.stopPropagation();return false;break;default:break;}}}}return true;};ComponentArt_Editor.prototype.KeyUp=function(_e8){_e8=this.element.contentWindow.event;this.DomTrace(_e8);if(cart_browser_ie||cart_browser_safari||cart_browser_opera){if(_e8.keyCode=="17"){ComponentArt_Cntrl=false;}}this.SaveBookmark();};ComponentArt_Editor.prototype.KeyPress=function(_e9){if(!cart_browser_ie&&_e9.type=="keypress"){if(_e9.ctrlKey){if(this.EditEngine=="Browser"){switch(String.fromCharCode(_e9.charCode).toLowerCase()){case "b":this.SaveUndo("Bold");this.document.execCommand("bold",false,null);ComponentArt_CancelEvent(_e9);_e9.preventDefault();_e9.stopPropagation();this.Focus();return false;break;case "i":this.SaveUndo("Italic");this.document.execCommand("italic",false,null);ComponentArt_CancelEvent(_e9);_e9.preventDefault();_e9.stopPropagation();this.Focus();return false;break;case "u":this.SaveUndo("Underline");this.document.execCommand("underline",false,null);ComponentArt_CancelEvent(_e9);_e9.preventDefault();_e9.stopPropagation();this.Focus();return false;break;}}this.CntrlCommand(String.fromCharCode(_e9.charCode).toLowerCase(),_e9);return true;}else{if(_e9.which=="13"){if(this.EditEngine=="Browser"){return true;}this.SaveUndo("Enter");this.SaveBookmark();var _ea=this.HasParent("LI");if(_ea){return true;}var _ea=this.HasParent("LI");var _eb=this.HasParent("DIV");var _ec=this.HasParent("H");if(_ea||_eb||_ec){_e9.preventDefault();setTimeout(this.Id+".FireFoxEnter();",0);return false;}return true;}else{if(_e9.keyCode=="9"){var _ea=this.HasParent("LI");if(_ea){return true;}var tab=this.document.createElement("span");tab.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;";ComponentArt_InsertDomElement(this.element,tab.firstChild);_zF3(tab);ComponentArt_CancelEvent(_e9);_e9.preventDefault();_e9.stopPropagation();return false;}else{if(_e9.keyCode=="8"){return true;}}}}}if(cart_browser_opera&&ComponentArt_Cntrl){ComponentArt_CancelEvent(_e9);_e9.preventDefault();_e9.stopPropagation();return false;}};ComponentArt_Editor.prototype.FireFoxEnter=function(){var _ee=this.HasParent("LI");var _ef=this.HasParent("DIV");var _f0=this.HasParent("H");if(_ee){ComponentArt_SplitDomElement(this.element,_ee);}else{if(_ef){ComponentArt_SplitDomElement(this.element,_ef);}else{if(_f0){ComponentArt_SplitDomElement(this.element,_f0);}else{var br=this.document.createElement("br");ComponentArt_InsertDomElement(this.element,br,br);}}}var _f2=this.get_events().getHandler("Enter");if(_f2){_f2(this,Sys.EventArgs.Empty);}};ComponentArt_Editor.prototype.MouseDown=function(_f3){};ComponentArt_Editor.prototype.MouseUp=function(_f4){this.SaveBookmark();this.DomTrace(_f4);};ComponentArt_Editor.prototype.MouseClick=function(_f5){if(this.get_mode()=="source"){return true;}ComponentArt_Editor_CollapseMenus(this);_f5=this.element.contentWindow.event;this.DomTrace(_f5);};ComponentArt_Editor.prototype.MouseMove=function(_f6){};ComponentArt_Editor.prototype.OnFocus=function(_f7){};ComponentArt_Editor.prototype.Blur=function(_f8){this.typing=false;};ComponentArt_Editor.prototype.RaiseContextChange=function(){ComponentArt_Editor_HandleEditorBoxEvent(this,Sys.EventArgs.Empty);var _f9=this.get_events().getHandler("contextChange");if(_f9){_f9(this,Sys.EventArgs.Empty);}};ComponentArt_Editor.prototype.GetClientTemplate=function(sID){if(this.ClientTemplates){for(var i=0;i<this.ClientTemplates.length;i++){if(this.ClientTemplates[i][0]==sID){return this.ClientTemplates[i][1];}}}return null;};window.cart_editor_css_key={"font-weight":"fontWeight","fontWeight":"font-weight","font-style":"fontStyle","fontStyle":"font-style","font-family":"fontFamily","fontFamily":"font-family","font-size":"fontSize","fontSize":"font-size","color":"color","color":"color","text-align":"textAlign","textAlign":"text-align","text-decoration":"textDecoration","textDecoration":"text-decoration","listStyleType":"list-style-type","list-style-type":"listStyleType","listStylePosition":"list-style-position","list-style-position":"listStylePosition","listStyleImage":"list-style-image","list-style-image":"listStyleImage","background-color":"backgroundColor","backgroundColor":"background-color"};window.cart_editor_typing_key_codes={"0":1,"16":0,"17":0,"18":0,"19":0,"20":0,"27":1,"33":1,"34":1,"35":1,"36":1,"37":1,"38":1,"39":1,"40":1,"44":0,"45":1,"46":1,"144":0,"145":0};var ComponentArt_Cntrl=false;var ComponentArt_Editor_Kernel_Loaded=true;