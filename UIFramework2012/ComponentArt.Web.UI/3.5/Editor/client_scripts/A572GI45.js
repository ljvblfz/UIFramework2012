window.cart_editor_command_type={"Save":0,"0":"Save","EditUndo":1,"1":"EditUndo","EditRedo":2,"2":"EditRedo","EditCut":3,"3":"EditCut","EditCopy":4,"4":"EditCopy","EditPaste":5,"5":"EditPaste","ViewRevealFormatting":6,"6":"ViewRevealFormatting","InsertHyperlink":7,"7":"InsertHyperlink","FormatFont":8,"8":"FormatFont","FormatFontFace":9,"9":"FormatFontFace","FormatFontSize":10,"10":"FormatFontSize","FormatBold":11,"11":"FormatBold","FormatItalic":12,"12":"FormatItalic","FormatUnderline":13,"13":"FormatUnderline","FormatFontColor":14,"14":"FormatFontColor","FormatHighlight":15,"15":"FormatHighlight","FormatNumbering":16,"16":"FormatNumbering","FormatBullets":17,"17":"FormatBullets","FormatAlignLeft":18,"18":"FormatAlignLeft","FormatAlignCenter":19,"19":"FormatAlignCenter","FormatAlignRight":20,"20":"FormatAlignRight","FormatAlignJustify":21,"21":"FormatAlignJustify","ToolsSpelling":22,"22":"ToolsSpelling","ToolsSetLanguage":23,"23":"ToolsSetLanguage","InsertHorizontalRule":24,"24":"InsertHorizontalRule","FormatIncreaseIndent":25,"25":"FormatIncreaseIndent","FormatDecreaseIndent":26,"26":"FormatDecreaseIndent","FormatStyle":27,"27":"FormatStyle","EditUndoExtended":28,"28":"EditUndoExtended","EditRedoExtended":29,"29":"EditRedoExtended","FormatStrikethrough":30,"30":"FormatStrikethrough","Print":31,"31":"Print","TableInsertRowAbove":32,"32":"TableInsertRowAbove","TableInsertRowBelow":33,"33":"TableInsertRowBelow","TableInsertColumnRight":34,"34":"TableInsertColumnRight","TableInsertColumnLeft":35,"35":"TableInsertColumnLeft","TableDeleteRow":36,"36":"TableDeleteRow","TableDeleteColumn":37,"37":"TableDeleteColumn","TableDeleteCell":38,"38":"TableDeleteCell","TableMergeCellRight":39,"39":"TableMergeCellRight","TableMergeCellDown":40,"40":"TableMergeCellDown","TableSplitCellHorizontal":41,"41":"TableSplitCellHorizontal","TableSplitCellVertical":42,"42":"TableSplitCellVertical","InsertForm":43,"43":"InsertForm","InsertButton":44,"44":"InsertButton","InsertCheckbox":45,"45":"InsertCheckbox","InsertHidden":46,"46":"InsertHidden","InsertRadio":47,"47":"InsertRadio","InsertPassword":48,"48":"InsertPassword","InsertReset":49,"49":"InsertReset","InsertSelect":50,"50":"InsertSelect","InsertSubmit":51,"51":"InsertSubmit","InsertTextbox":52,"52":"InsertTextbox","InsertTextarea":53,"53":"InsertTextarea","RemoveHyperlink":54,"54":"RemoveHyperlink","New":55,"55":"New","EditFind":56,"56":"EditFind","EditReplace":57,"57":"EditReplace","InsertMedia":58,"58":"InsertMedia","InsertSymbol":59,"59":"InsertSymbol","InsertTable":60,"60":"InsertTable","FormatNumberingExtended":61,"61":"FormatNumberingExtended","FormatBulletsExtended":62,"62":"FormatBulletsExtended","ImageManager":63,"63":"ImageManager"};window.cart_editor_commands_to_context_metrics={"Save":[],"EditUndo":["CanUndo"],"EditRedo":["CanRedo"],"EditCut":[],"EditCopy":[],"EditPaste":[],"ViewRevealFormatting":[],"InsertHyperlink":[],"RemoveHyperlink":["linkContext"],"FormatFont":[],"FormatFontFace":["font-family"],"FormatFontSize":["font-size"],"FormatBold":["font-weight"],"FormatItalic":["font-style"],"FormatUnderline":["text-decoration"],"FormatFontColor":[],"FormatHighlight":[],"FormatNumbering":["listContext"],"FormatBullets":["listContext"],"FormatAlignLeft":["text-align"],"FormatAlignCenter":["text-align"],"FormatAlignRight":["text-align"],"FormatAlignJustify":["text-align"],"ToolsSpelling":[],"ToolsSetLanguage":[],"InsertHorizontalRule":[],"FormatIncreaseIndent":[],"FormatDecreaseIndent":[],"FormatStyle":[],"EditUndoExtended":["UndoCount"],"EditRedoExtended":["RedoCount"],"FormatStrikethrough":["text-decoration"],"Print":[],"TableInsertRowAbove":["tableContext"],"TableInsertColumnRight":["tableContext"],"TableInsertRowBelow":["tableContext"],"TableInsertColumnLeft":["tableContext"],"TableDeleteRow":["tableContext"],"TableDeleteColumn":["tableContext"],"TableDeleteCell":["tableContext"],"TableMergeCellRight":["tableContext"],"TableMergeCellDown":["tableContext"],"TableSplitCellHorizontal":["tableContext"],"TableSplitCellVertical":["tableContext"],"InsertForm":[],"InsertButton":[],"InsertCheckbox":[],"InsertHidden":[],"InsertRadio":[],"InsertPassword":[],"InsertReset":[],"InsertSelect":[],"InsertSubmit":[],"InsertTextbox":[],"InsertTextarea":[],"New":[],"EditFind":[],"EditReplace":[],"InsertMedia":[],"InsertSymbol":[],"InsertTable":[],"FormatNumberingExtended":["listContext"],"FormatBulletsExtended":["listContext"],"ImageManager":[]};window.cart_editor_builtInContextMetrics={"font-weight":function(_1){return _1.getStyle("font-weight");},"font-style":function(_2){return _2.getStyle("font-style");},"text-decoration":function(_3){return _3.getStyle("text-decoration");},"text-align":function(_4){return _4.getStyle("text-align");},"font-family":function(_5){return _5.getStyle("font-family");},"font-size":function(_6){return _6.getStyle("font-size");},"listContext":function(_7){return _7.GetListContext().tagName;},"linkContext":function(_8){return _8.HasParent("A").nodeName;},"tableContext":function(_9){return _9.HasParent("TD").nodeName;},"CanUndo":function(_a){return _a.UndoStates.length>0;},"CanRedo":function(_b){return _b.RedoStates.length>0;},"UndoCount":function(_c){return _c.UndoStates.length;},"RedoCount":function(_d){return _d.RedoStates.length;}};function ComponentArt_Editor_InitializeStyles(_e){_e.Styles={};_e.StylesIterator=[];_e.StyleMetrics={};for(var i=0;i<_e.StyleStorage.length;i++){var _10=_e.StyleStorage[i];var _11=_e.StylesIterator[i]=_e.Styles[_10[0]]=new ComponentArt_Style(_10);if(_11.CssClass!=null){var _12=function(_13){return _13.HasCssClass(arguments.callee.CssClass);};_12.CssClass=_11.CssClass;ComponentArt_Editor_AddStyleContextMetric(_e,"HasCssClass_"+_11.CssClass,_12);}if(_11.Element){var _12=function(_14){return !!_14.HasParent(arguments.callee.Element);};_12.Element=_11.Element;ComponentArt_Editor_AddStyleContextMetric(_e,"HasParent_"+_11.Element,_12);}for(var _15 in _11.Style){if(cart_editor_builtInContextMetrics[cart_editor_css_key[_15]]){ComponentArt_Editor_AddStyleContextMetric(_e,cart_editor_css_key[_15],cart_editor_builtInContextMetrics[cart_editor_css_key[_15]]);}else{var _12=function(_16){return _16.getStyle(arguments.callee.cssSetting);};_12.cssSetting=_15;ComponentArt_Editor_AddStyleContextMetric(_e,"CssStyle_"+_15,_12);}}}_e.StylesIterator.sort(ComponentArt_Editor_StyleSortCompare);var _17=[];for(var bbb in _e.StyleMetrics){_17[_17.length]=bbb;}cart_editor_commands_to_context_metrics["FormatStyle"]=_17;}function ComponentArt_Editor_AddStyleContextMetric(_19,_1a,_1b){_19.StyleMetrics[_1a]=true;if(_19.ContextMetrics[_1a]==null){_19.AddContextMetric(_1a,_1b);}}function ComponentArt_Editor_HookUpControls(_1c){var _1d=false;for(var _1e in _1c.ControlReferences){var _1f=window[_1e];if(_1f!=null&&_1f.ClientControlId!=null){ComponentArt_Editor_HookUpControl(_1c,_1f);}else{_1d=true;}}if(_1d){setTimeout("ComponentArt_Editor_HookUpControls("+_1c.ClientControlId+")",100);}}function ComponentArt_Editor_HookUpControl(_20,_21){var _22=_21.ClientControlId;_21.ParentEditor=_20;var _23=_20.ControlReferences[_22];if(_23){var _24=window[_23.ParentToolBarId].get_items().getItem(_23.ParentItemIndex);_24.ChildControl=_21;_21.ParentItem=_24;var _25=_24.GetProperty("EditorCommandType");_21.EditorCommandType=_25;}if(_21.constructor===ComponentArt.Web.UI.ToolBar){_21.add_itemCheckChange(EditorToolBarManager.HandleToolBarEvent);_21.add_itemSelect(EditorToolBarManager.HandleToolBarEvent);}else{if(_21.constructor===ComponentArt.Web.UI.ComboBox){_21.add_change(EditorToolBarManager.HandleComboBoxEvent);}else{if(_21.constructor===ComponentArt.Web.UI.Menu){}}}ComponentArt_Editor_HookUpContextMetricsAndListeners(_20,_21);_20.ChildControls[_20.ChildControls.length]=_21;delete _20.ControlReferences[_22];}function ComponentArt_Editor_HookUpContextMetricsAndListeners(_26,_27){if(_27.EditorCommandType){ComponentArt_Editor_HookUpListener(_26,_27.EditorCommandType,_27.ParentItem);}else{if(_27.constructor===ComponentArt.Web.UI.ToolBar){var _28=_27.get_items().get_itemArray();for(var i=_28.length-1;i>=0;i--){var _2a=_28[i];var _2b=_2a.GetProperty("ChildControlId");var _2c=_2a.GetProperty("EditorCommandType");if(_2c&&!_2b){ComponentArt_Editor_HookUpListener(_26,_2c,_2a);}}}}}function ComponentArt_Editor_HookUpListener(_2d,_2e,_2f){var _30=cart_editor_commands_to_context_metrics[_2e];for(var _31 in _30){var _32=_30[_31];if(_2d.ContextMetrics[_32]==null){_2d.AddContextMetric(_32,cart_editor_builtInContextMetrics[_32]);}}var _33=ComponentArt_Editor_UpdateItem[ComponentArt_Editor_ParseEditorCommandType(_2f.GetProperty("EditorCommandType"))];if(_33){var _34=function(_35,_36){eval(arguments.callee.listenerCode);};_34.item=_2f;_34.listenerCode=_33;_2d.AddContextChangedEventListener(_34,_30);}}var ComponentArt_Editor_UpdateItem={1:"      arguments.callee.item.SetProperty('Enabled', arguments[1]['CanUndo']);      arguments.callee.item.repaint();",2:"      arguments.callee.item.SetProperty('Enabled', arguments[1]['CanRedo']);      arguments.callee.item.repaint();",9:"      var combobox = arguments.callee.item.ChildControl;      if (combobox)      {        var itemToSelect = (arguments[1]['font-family']==null) ? null : combobox.findItemByProperty('Value', arguments[1]['font-family'].toLowerCase());        if (itemToSelect)        {          combobox.selectItem(itemToSelect, true);        }        else        {          combobox.UnSelect();        }      }",10:"      var combobox = arguments.callee.item.ChildControl;      if (combobox)      {        var itemToSelect = (arguments[1]['font-size']==null) ? null : combobox.findItemByProperty('Value', arguments[1]['font-size']);        if (itemToSelect)        {          combobox.selectItem(itemToSelect, true);        }      }",27:"      var combobox = arguments.callee.item.ChildControl;      if (combobox)      {        var currentStyle = ComponentArt_Editor_CurrentStyle(arguments[0]);        var itemToSelect = currentStyle ? combobox.findItemByProperty('Text', currentStyle.Name) : null; /* HERE IT IS A MINOR SLOWDOWN AND INCONSISTENCY AND HACK.  WE SHOULD CHANGE IT BUT HAVE NO TIME */        if (itemToSelect)        {          combobox.selectItem(itemToSelect, true);        }        else        {          combobox.UnSelect();combobox.set_text('');        }      }",11:"      var fontweight = arguments[1]['font-weight'];      arguments.callee.item.SetProperty('Checked', fontweight == 700 || fontweight == 'bold');      arguments.callee.item.repaint();",12:"      arguments.callee.item.SetProperty('Checked', arguments[1]['font-style'] == 'italic');      arguments.callee.item.repaint();",13:"      arguments.callee.item.SetProperty('Checked', arguments[1]['text-decoration']!=null && arguments[1]['text-decoration'].indexOf('underline')>=0 );      arguments.callee.item.repaint();",16:"      arguments.callee.item.SetProperty('Checked', arguments[1]['listContext'] == 'OL');      arguments.callee.item.repaint();",17:"      arguments.callee.item.SetProperty('Checked', arguments[1]['listContext'] == 'UL');      arguments.callee.item.repaint();",18:"      var textAlign = arguments[1]['text-align'];      arguments.callee.item.SetProperty('Checked', textAlign == 'left' || textAlign == 'start'); /*Mozilla seems to return 'start' for unset left align*/      arguments.callee.item.repaint();",19:"      arguments.callee.item.SetProperty('Checked', arguments[1]['text-align'] == 'center');      arguments.callee.item.repaint();",20:"      arguments.callee.item.SetProperty('Checked', arguments[1]['text-align'] == 'right');      arguments.callee.item.repaint();",21:"      arguments.callee.item.SetProperty('Checked', arguments[1]['text-align'] == 'justify');      arguments.callee.item.repaint();",28:"      arguments.callee.item.SetProperty('Enabled', arguments[1]['UndoCount']>0);      arguments.callee.item.repaint();",29:"      arguments.callee.item.SetProperty('Enabled', arguments[1]['RedoCount']>0);      arguments.callee.item.repaint();",30:"      arguments.callee.item.SetProperty('Checked', arguments[1]['text-decoration']!=null && arguments[1]['text-decoration'].indexOf('line-through')>=0 );      arguments.callee.item.repaint();",32:"      arguments.callee.item.SetProperty('Enabled', arguments[1]['tableContext'] == 'TD');      arguments.callee.item.repaint();",33:"      arguments.callee.item.SetProperty('Enabled', arguments[1]['tableContext'] == 'TD');      arguments.callee.item.repaint();",34:"      arguments.callee.item.SetProperty('Enabled', arguments[1]['tableContext'] == 'TD');      arguments.callee.item.repaint();",35:"      arguments.callee.item.SetProperty('Enabled', arguments[1]['tableContext'] == 'TD');      arguments.callee.item.repaint();",36:"      arguments.callee.item.SetProperty('Enabled', arguments[1]['tableContext'] == 'TD');      arguments.callee.item.repaint();",37:"      arguments.callee.item.SetProperty('Enabled', arguments[1]['tableContext'] == 'TD');      arguments.callee.item.repaint();",38:"      arguments.callee.item.SetProperty('Enabled', arguments[1]['tableContext'] == 'TD');      arguments.callee.item.repaint();",39:"      arguments.callee.item.SetProperty('Enabled', arguments[1]['tableContext'] == 'TD');      arguments.callee.item.repaint();",40:"      arguments.callee.item.SetProperty('Enabled', arguments[1]['tableContext'] == 'TD');      arguments.callee.item.repaint();",41:"      arguments.callee.item.SetProperty('Enabled', arguments[1]['tableContext'] == 'TD');      arguments.callee.item.repaint();",42:"      arguments.callee.item.SetProperty('Enabled', arguments[1]['tableContext'] == 'TD');      arguments.callee.item.repaint();",54:"      arguments.callee.item.SetProperty('Enabled', arguments[1]['linkContext'] == 'A');      arguments.callee.item.repaint();",61:"      arguments.callee.item.SetProperty('Checked', arguments[1]['listContext'] == 'OL');      arguments.callee.item.repaint();",62:"      arguments.callee.item.SetProperty('Checked', arguments[1]['listContext'] == 'UL');      arguments.callee.item.repaint();"};window.EditorToolBarManager=new Object();EditorToolBarManager.HandleToolBarEvent=function(_37,_38){var _39=_37.ParentEditor;var _3a=_38.get_item();if(_3a.CustomContentId||_3a.ClientTemplateId){return;}var _3b=ComponentArt_Editor_ParseEditorCommandType(_3a.GetProperty("EditorCommandType"));EditorToolBarManager.HandleCommand(_39,_3b,_3a);};EditorToolBarManager.HandleComboBoxEvent=function(_3c,_3d){var _3e=_3c.ParentEditor;var _3f=ComponentArt_Editor_ParseEditorCommandType(_3c.EditorCommandType);EditorToolBarManager.HandleCommand(_3e,_3f,_3c.getSelectedItem());};EditorToolBarManager.HandleCommand=function(_40,_41,_42){if(isNaN(_41)){return;}var ect=cart_editor_command_type;switch(_41){case ect.Save:_40.Save();break;case ect.New:_40.New();break;case ect.EditUndo:case ect.EditUndoExtended:_40.Undo();break;case ect.EditRedo:case ect.EditRedoExtended:_40.Redo();break;case ect.EditCut:_40.CutSelection();break;case ect.EditCopy:_40.CopySelection();break;case ect.EditPaste:_40.PasteHTML(true);break;case ect.InsertHyperlink:break;case ect.FormatFont:break;case ect.FormatFontFace:if(_42){_40.setStyle("font-family",_42.get_value());}break;case ect.FormatFontSize:_40.setStyle("font-size",_42.get_value());break;case ect.FormatStyle:var _44=null;if(_40.SelectionBookmark){_44=_40.SelectionBookmark;}if(_42){_z164(_40.element,_44,_40.Styles[_42.get_value()]);}break;case ect.FormatBold:if(_40.EditEngine=="Browser"){_40.SaveUndo("Bold");_40.document.execCommand("bold",false,null);_40.Focus();_40.DomTrace();return;}_40.setStyle("font-weight",_42.get_checked()?"700":"normal");break;case ect.FormatItalic:if(_40.EditEngine=="Browser"){_40.SaveUndo("Italic");_40.document.execCommand("italic",false,null);_40.Focus();_40.DomTrace();return;}_40.setStyle("font-style",_42.get_checked()?"italic":"normal");break;case ect.FormatUnderline:if(_40.EditEngine=="Browser"){_40.SaveUndo("Underline");_40.document.execCommand("underline",false,null);_40.Focus();_40.DomTrace();return;}_40.setStyle("text-decoration",_42.get_checked()?"underline":"none");break;case ect.FormatStrikethrough:if(_40.EditEngine=="Browser"){_40.SaveUndo("Strike Through");_40.document.execCommand("strikethrough",false,null);return;}_40.setStyle("text-decoration",_42.get_checked()?"line-through":"none");break;case ect.FormatFontColor:change_color(_40);break;case ect.FormatHighlight:change_color(_40);break;case ect.FormatNumbering:case ect.FormatNumberingExtended:_40.ToggleOrderedList();break;case ect.FormatBullets:case ect.FormatBulletsExtended:_40.ToggleUnorderedList();break;case ect.FormatIncreaseIndent:_40.setIndent(1);break;case ect.FormatDecreaseIndent:_40.setIndent(-1);break;case ect.FormatAlignLeft:_40.setAlign("left");break;case ect.FormatAlignCenter:_40.setAlign("center");break;case ect.FormatAlignRight:_40.setAlign("right");break;case ect.FormatAlignJustify:_40.setAlign("justify");break;case ect.ToolsSpelling:break;case ect.ToolsSetLanguage:break;case ect.InsertHorizontalRule:_40.SaveUndo("Horizontal Rule");if(_40.EditEngine!="Browser"){ComponentArt_InsertDomElement(_40.element,_40.document.createElement("DIV"));}_40.document.execCommand("InsertHorizontalRule",false,null);break;case ect.Print:_40.Print();break;case ect.TableInsertRowAbove:_40.TableInsertRow();break;case ect.TableInsertRowBelow:_40.TableInsertRow(true);break;case ect.TableInsertColumnRight:_40.TableInsertColumn(true);break;case ect.TableInsertColumnLeft:_40.TableInsertColumn();break;case ect.TableDeleteRow:_40.TableDeleteRow();break;case ect.TableDeleteColumn:_40.TableDeleteColumn();break;case ect.TableDeleteCell:_40.TableDeleteCell();break;case ect.TableMergeCellRight:_40.TableMergeCellRight();break;case ect.TableMergeCellDown:_40.TableMergeCellDown();break;case ect.TableSplitCellHorizontal:_40.TableSplitCellHorizontal();break;case ect.TableSplitCellVertical:_40.TableSplitCellVertical();break;case ect.InsertForm:_40.InsertFormElement("form");break;case ect.InsertButton:_40.InsertFormElement("button");break;case ect.InsertCheckbox:_40.InsertFormElement("checkbox");break;case ect.InsertHidden:_40.InsertFormElement("hidden");break;case ect.InsertRadio:_40.InsertFormElement("radio");break;case ect.InsertPassword:_40.InsertFormElement("password");break;case ect.InsertReset:_40.InsertFormElement("reset");break;case ect.InsertSelect:_40.InsertFormElement("select");break;case ect.InsertSubmit:_40.InsertFormElement("submit");break;case ect.InsertTextbox:_40.InsertFormElement("textbox");break;case ect.InsertTextarea:_40.InsertFormElement("textarea");break;case ect.RemoveHyperlink:_40.SaveUndo("Remove Link");ComponentArt_RemoveElement(_40,_40.HasParent("A"));break;default:break;}_40.RaiseContextChange();};function ComponentArt_Editor_ParseEditorCommandType(o){if(!isNaN(o)){return o;}else{if(!isNaN(o-0)){return o-0;}else{return cart_editor_command_type[o]-0;}}}function ComponentArt_Editor_CollapseMenus(_46){for(var i=_46.ChildControls.length-1;i>=0;i--){if(_46.ChildControls[i].constructor===ComponentArt.Web.UI.Menu){_46.ChildControls[i].Hide();}}}ComponentArt_Editor.prototype.AddContextMetric=function(_48,_49){this.ContextMetrics[_48]={"Function":_49,"LastValue":_49(this),"ListenerIndexes":[]};};ComponentArt_Editor.prototype.AddContextChangedEventListener=function(_4a,_4b){if(_4b==null){var _4c=this.ContextChangedListeners.Always.length;this.ContextChangedListeners.Always[_4c]=_4a;return;}else{var _4c=this.ContextChangedListeners.Sometimes.length;this.ContextChangedListeners.Sometimes[_4c]=_4a;for(var i=0;i<_4b.length;i++){var _4e=_4b[i];this.ContextMetrics[_4e].ListenerIndexes[this.ContextMetrics[_4e].ListenerIndexes.length]=_4c;}return;}};function ComponentArt_Editor_HandleEditorBoxEvent(_4f,_50){var _51=new Object();var _52=new Object();var _53=false;for(var _54 in _4f.ContextMetrics){var _55=_4f.ContextMetrics[_54];_51[_54]=_55.Function(_4f);if(_51[_54]!==_55.LastValue){_53=true;_55.LastValue=_51[_54];for(var i=_55.ListenerIndexes.length-1;i>=0;i--){_52[_55.ListenerIndexes[i]]=0;}}}if(_53){for(var _57=_4f.ContextChangedListeners.Always.length-1;_57>=0;_57--){_4f.ContextChangedListeners.Always[_57](_4f,_51);}for(var _57 in _52){_4f.ContextChangedListeners.Sometimes[_57](_4f,_51);}}}function ComponentArt_Style(_58){this.Name=""+_58[0];this.Element=_58[1];this.ReplaceParagraphTag=!!_58[2];this.CssClass=_58[3];this.StyleString=_58[4];this.Style=_z105(this.StyleString);this.StyleLength=ComponentArt_Editor_MemberCount(this.Style);this.DropDownCssClass=_58[5];this.DropDownStyleString=_58[6];}function ComponentArt_Editor_CurrentStyle(_59){for(var i=0;i<_59.StylesIterator.length;i++){var _5b=_59.StylesIterator[i];if(ComponentArt_Editor_StyleIsInEffect(_59,_5b)){return _5b;}}return null;}