if(!window.cart_scheduler_utils_loaded){window.cart_SchedulerUpdateMode_CallBack=0;window.cart_SchedulerUpdateMode_PostBack=1;window.cart_SchedulerUpdateMode_WebService=2;window.DateTimeFormatter=function(){this.AbbreviatedDayNames=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];this.AbbreviatedMonthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];this.AMDesignator="AM";this.DayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];this.MonthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];this.PMDesignator="PM";this.set_dateTime(new Date());this.set_formatString("yyyy-MM-dd h:mm:ss tt");};DateTimeFormatter.prototype.get_abbreviatedDayNames=function(){return this.AbbreviatedDayNames;};DateTimeFormatter.prototype.set_abbreviatedDayNames=function(_1){this.AbbreviatedDayNames=_1;};DateTimeFormatter.prototype.get_abbreviatedMonthNames=function(){return this.AbbreviatedMonthNames;};DateTimeFormatter.prototype.set_abbreviatedMonthNames=function(_2){this.AbbreviatedMonthNames=_2;};DateTimeFormatter.prototype.get_dayNames=function(){return this.DayNames;};DateTimeFormatter.prototype.set_dayNames=function(_3){this.DayNames=_3;};DateTimeFormatter.prototype.get_monthNames=function(){return this.MonthNames;};DateTimeFormatter.prototype.set_monthNames=function(_4){this.MonthNames=_4;};DateTimeFormatter.prototype.get_amDesignator=function(){return this.AMDesignator;};DateTimeFormatter.prototype.set_amDesignator=function(_5){this.AMDesignator=_5;};DateTimeFormatter.prototype.get_pmDesignator=function(){return this.PMDesignator;};DateTimeFormatter.prototype.set_pmDesignator=function(_6){this.PMDesignator=_6;};DateTimeFormatter.prototype.get_dateTime=function(){return this.DateTime;};DateTimeFormatter.prototype.set_dateTime=function(_7){this.DateTime=_7;this.DateTimeTokenized=DateTimeFormatter.tokenizeDateTime(this.DateTime);};DateTimeFormatter.prototype.get_formatString=function(){return this.FormatString;};DateTimeFormatter.prototype.set_formatString=function(_8){this.FormatString=_8;this.FormatStringTokenized=DateTimeFormatter.tokenizeFormatString(this.FormatString);};DateTimeFormatter.prototype.toString=function(_9,_a){var _b=(_9===void 0)?this.DateTimeTokens:DateTimeFormatter.tokenizeDateTime(_9);var _c=(_a===void 0)?this.FormatTokens:DateTimeFormatter.tokenizeFormatString(_a);var _d=new Array();for(var i=0;i<_c.length;i++){var _f=_c[i];if(_f.IsLiteral){_d.push(_f.Value);}else{switch(_f.Value){case "d":_d.push(_b.Day);break;case "dd":_d.push(_b.Day>=10?""+_b.Day:"0"+_b.Day);break;case "ddd":_d.push(this.AbbreviatedDayNames[_b.DayOfWeek]);break;case "dddd":_d.push(this.DayNames[_b.DayOfWeek]);break;case "h":_d.push(""+((_b.Hour+11)%12+1));break;case "hh":_d.push(((_b.Hour+11)%12+1)>=10?""+((_b.Hour+11)%12+1):"0"+((_b.Hour+11)%12+1));break;case "H":_d.push(""+_b.Hour);break;case "HH":_d.push(_b.Hour>=10?""+_b.Hour:"0"+_b.Hour);break;case "m":_d.push(""+_b.Minute);break;case "mm":_d.push(_b.Minute>=10?""+_b.Minute:"0"+_b.Minute);break;case "M":_d.push(""+(_b.Month+1));break;case "MM":_d.push((_b.Month+1)>=10?""+(_b.Month+1):"0"+(_b.Month+1));break;case "MMM":_d.push(this.AbbreviatedMonthNames[_b.Month]);break;case "MMMM":_d.push(this.MonthNames[_b.Month]);break;case "s":_d.push(""+_b.Second);break;case "ss":_d.push(_b.Second>=10?""+_b.Second:"0"+_b.Second);break;case "t":_d.push(_b.Hour>=12?""+this.PMDesignator.toLowerCase().charAt(0):""+this.AMDesignator.toLowerCase().charAt(0));break;case "tt":_d.push(_b.Hour>=12?this.PMDesignator.toLowerCase():this.AMDesignator.toLowerCase());break;case "T":_d.push(_b.Hour>=12?""+this.PMDesignator.toUpperCase().charAt(0):""+this.AMDesignator.toUpperCase().charAt(0));break;case "TT":_d.push(_b.Hour>=12?this.PMDesignator.toUpperCase():this.AMDesignator.toUpperCase());break;case "y":_d.push(""+(_b.Year%100));break;case "yy":_d.push((_b.Year%100)>=10?""+(_b.Year%100):"0"+(_b.Year%100));break;case "yyy":case "yyyy":_d.push(""+_b.Year);break;}}}return _d.join("");};DateTimeFormatter.tokenizeDateTime=function(_10){return {"Year":_10.getFullYear(),"Month":_10.getMonth(),"Day":_10.getDate(),"Hour":_10.getHours(),"Minute":_10.getMinutes(),"Second":_10.getSeconds(),"DayOfWeek":_10.getDay()};};DateTimeFormatter.countChars=function(str,chr,_13,_14){var _15=0;var max=Math.min(str.length-_13,_14);while(_15<max&&str.charAt(_13+_15)==chr){_15++;}return _15;};DateTimeFormatter.charString=function(chr,_18){var _19=new Array();for(var i=0;i<_18;i++){_19[i]=chr;}return _19.join("");};DateTimeFormatter.tokenizeFormatString=function(_1b){var _1c=new Array();var _1d=0;var _1e=false;var _1f=new Array();while(_1d<_1b.length){var _20=_1b.charAt(_1d);if(!_1e){switch(_20){case "'":_1e=true;_1d++;break;case "d":case "h":case "H":case "m":case "M":case "s":case "t":case "T":case "y":if(_1f.length>0){_1c.push({"IsLiteral":true,"Value":_1f.join("")});_1f=new Array();}var _21="";var _22=0;switch(_20){case "h":case "H":case "m":case "s":case "t":case "T":_22=2;break;case "d":case "M":case "y":_22=4;break;}var _23=DateTimeFormatter.countChars(_1b,_20,_1d,_22);_1c.push({"IsLiteral":false,"Value":DateTimeFormatter.charString(_20,_23)});_1d+=_23;break;default:_1f[_1f.length]=_20;_1d++;break;}}else{var _24=DateTimeFormatter.countChars(_1b,"'",_1d,2);switch(_24){case 2:_1f[_1f.length]="'";_1d+=2;break;case 1:_1e=false;_1d++;break;case 0:_1f[_1f.length]=_20;_1d++;break;}}if((_1d>=_1b.length)&&(_1f.length>0)){_1c.push({"IsLiteral":true,"Value":_1f.join("")});}}return _1c;};window.ComponentArt_Period=function(_25,_26){this.StartDateTime=_25;this.Duration=_26;};ComponentArt_Period.PeriodsOverlap=function(_27,_28){return _27.get_endDateTime()>_28.get_startDateTime()&&_28.get_endDateTime()>_27.get_startDateTime();};ComponentArt_Period.prototype.PublicProperties=[["StartDateTime",Date],["Duration",Number]];ComponentArt_Period.prototype.get_startDateTime=function(){return this.StartDateTime;};ComponentArt_Period.prototype.set_startDateTime=function(_29){this.StartDateTime=_29;};ComponentArt_Period.prototype.get_duration=function(){if(!this.Duration){return null;}if(isNaN(this.Duration)){var _2a=0;var _2b=this.Duration;var _2c=_2b.indexOf("P")+2;if(_2b.indexOf("T")<0){_2c--;}var _2d=_2c+1;while(_2d<_2b.length){switch(_2b.charAt(_2d)){case "S":_2a+=_2b.substring(_2c,_2d)*1000;_2c=_2d+1;break;case "M":_2a+=_2b.substring(_2c,_2d)*60*1000;_2c=_2d+1;break;case "H":_2a+=_2b.substring(_2c,_2d)*60*60*1000;_2c=_2d+1;break;case "D":_2a+=_2b.substring(_2c,_2d)*24*60*60*1000;_2c=_2d+1;break;default:if(isNaN(_2b.charAt(_2d))){_2c++;_2d++;}break;}_2d++;}this.Duration=_2a;}return this.Duration;};ComponentArt_Period.prototype.set_duration=function(_2e){if(isNaN(_2e)){var _2f=0;var _30=_2e.indexOf("P")+2;if(_2e.indexOf("T")<0){_30--;}var _31=_30+1;while(_31<_2e.length){switch(_2e.charAt(_31)){case "S":_2f+=_2e.substring(_30,_31)*1000;_30=_31+1;break;case "M":_2f+=_2e.substring(_30,_31)*60*1000;_30=_31+1;break;case "H":_2f+=_2e.substring(_30,_31)*60*60*1000;_30=_31+1;break;case "D":_2f+=_2e.substring(_30,_31)*24*60*60*1000;_30=_31+1;break;default:if(isNaN(_2e.charAt(_31))){_30++;_31++;}break;}_31++;}this.Duration=_2f;}else{this.Duration=_2e;}};ComponentArt_Period.prototype.get_durationAsTimeSpan=function(){return (isNaN(this.Duration))?this.Duration:"PT"+Math.round(this.Duration/1000)+"S";};ComponentArt_Period.prototype.PublicMethods=[["get_endDateTime",,Date],["overlaps",,Boolean,[["period",ComponentArt_Period]]]];ComponentArt_Period.prototype.get_endDateTime=function(){return new Date(this.get_startDateTime().getTime()+this.get_duration());};ComponentArt_Period.prototype.set_endDateTime=function(_32){this.set_duration(_32-this.get_startDateTime());};ComponentArt_Period.prototype.overlaps=function(_33){return ComponentArt_Period.PeriodsOverlap(this,_33);};window.ComponentArt_SerializeObject=function(o){if(o==null){return "";}if(o.constructor==Date){return (new DateTimeFormatter()).toString(o,"yyyyMMddHHmmss");}return o.toString();};window.ComponentArt_SchedulerAppointment=function(_35,_36,_37,_38,_39,_3a,tag,_3c,_3d){this.Properties={};if(typeof (_35)!="undefined"){this.SetProperty("AppointmentID",_35);}if(typeof (_36)!="undefined"){this.SetProperty("Start",_36);}if(typeof (_37)!="undefined"){this.SetProperty("Duration",_37);}if(typeof (_38)!="undefined"){this.SetProperty("Title",_38);}if(typeof (_39)!="undefined"){this.SetProperty("Description",_39);}if(typeof (_3a)!="undefined"){this.SetProperty("Visible",_3a);}if(typeof (tag)!="undefined"){this.SetProperty("Tag",tag);}if(typeof (_3c)!="undefined"){this.SetProperty("RecurringAppointmentID",_3c);}if(typeof (_3d)!="undefined"){this.SetProperty("Instance",_3d);}};ComponentArt_SchedulerAppointment.prototype.PublicProperties=[["AppointmentID",String],["Start",Date],["Duration",Number],["Title",String],["Description",String],["Tag",String],["RecurringAppointmentID",String],["Visible",Boolean],["Instance",Boolean]];ComponentArt_SchedulerAppointment.prototype.GetProperty=function(_3e){return this.Properties[_3e];};ComponentArt_SchedulerAppointment.prototype.SetProperty=function(_3f,_40){this.Properties[_3f]=_40;};ComponentArt_SchedulerAppointment.prototype.get_appointmentID=function(){return this.GetProperty("AppointmentID");};ComponentArt_SchedulerAppointment.prototype.set_appointmentID=function(_41){this.SetProperty("AppointmentID",_41);};ComponentArt_SchedulerAppointment.prototype.get_start=function(){return this.GetProperty("Start");};ComponentArt_SchedulerAppointment.prototype.set_start=function(_42){this.SetProperty("Start",_42);};ComponentArt_SchedulerAppointment.prototype.get_duration=function(){if(!this.GetProperty("Duration")){return null;}if(isNaN(this.GetProperty("Duration"))){var _43=0;var _44=this.GetProperty("Duration");var _45=_44.indexOf("P")+2;if(_44.indexOf("T")<0){_45--;}var _46=_45+1;while(_46<_44.length){switch(_44.charAt(_46)){case "S":_43+=_44.substring(_45,_46)*1000;_45=_46+1;break;case "M":_43+=_44.substring(_45,_46)*60*1000;_45=_46+1;break;case "H":_43+=_44.substring(_45,_46)*60*60*1000;_45=_46+1;break;case "D":_43+=_44.substring(_45,_46)*24*60*60*1000;_45=_46+1;break;default:if(isNaN(_44.charAt(_46))){_45++;_46++;}break;}_46++;}this.SetProperty("Duration",_43);}return this.GetProperty("Duration");};ComponentArt_SchedulerAppointment.prototype.set_duration=function(_47){if(isNaN(_47)){var _48=0;var _49=_47.indexOf("P")+2;if(_47.indexOf("T")<0){_49--;}var _4a=_49+1;while(_4a<_47.length){switch(_47.charAt(_4a)){case "S":_48+=_47.substring(_49,_4a)*1000;_49=_4a+1;break;case "M":_48+=_47.substring(_49,_4a)*60*1000;_49=_4a+1;break;case "H":_48+=_47.substring(_49,_4a)*60*60*1000;_49=_4a+1;break;case "D":_48+=_47.substring(_49,_4a)*24*60*60*1000;_49=_4a+1;break;default:if(isNaN(_47.charAt(_4a))){_49++;_4a++;}break;}_4a++;}this.SetProperty("Duration",_48);}else{this.SetProperty("Duration",_47);}};ComponentArt_SchedulerAppointment.prototype.get_durationAsTimeSpan=function(){return (isNaN(this.GetProperty("Duration")))?this.GetProperty("Duration"):"PT"+Math.round(this.GetProperty("Duration")/1000)+"S";};ComponentArt_SchedulerAppointment.prototype.get_title=function(){return this.GetProperty("Title");};ComponentArt_SchedulerAppointment.prototype.set_title=function(_4b){this.SetProperty("Title",_4b);};ComponentArt_SchedulerAppointment.prototype.get_description=function(){return this.GetProperty("Description");};ComponentArt_SchedulerAppointment.prototype.set_description=function(_4c){this.SetProperty("Description",_4c);};ComponentArt_SchedulerAppointment.prototype.get_tag=function(){return this.GetProperty("Tag");};ComponentArt_SchedulerAppointment.prototype.set_tag=function(_4d){this.SetProperty("Tag",_4d);};ComponentArt_SchedulerAppointment.prototype.get_recurringAppointmentID=function(){return this.GetProperty("RecurringAppointmentID");};ComponentArt_SchedulerAppointment.prototype.get_visible=function(){if(typeof (this.Properties["Visible"])=="undefined"){this.Properties["Visible"]=true;}return this.GetProperty("Visible");};ComponentArt_SchedulerAppointment.prototype.set_visible=function(_4e){this.SetProperty("Visible",_4e);};ComponentArt_SchedulerAppointment.prototype.get_instance=function(){return this.GetProperty("Instance");};ComponentArt_SchedulerAppointment.prototype.set_instance=function(_4f){this.SetProperty("Instance",_4f);};ComponentArt_SchedulerAppointment.prototype.get_period=function(){return new ComponentArt_Period(this.get_start(),this.get_duration());};ComponentArt_SchedulerAppointment.prototype.set_parent=function(_50){this.Parent=_50;};ComponentArt_SchedulerAppointment.prototype.get_parent=function(){return this.Parent;};ComponentArt_SchedulerAppointment.prototype.beginUpdate=function(){return this.get_parent().beginUpdate();};ComponentArt_SchedulerAppointment.prototype.endUpdate=function(){return this.get_parent().endUpdate();};ComponentArt_SchedulerAppointment.prototype.get_isUpdating=function(){return this.get_parent().get_isUpdating();};ComponentArt_SchedulerAppointment.prototype.createJsonObject=function(){var _51={};for(var _52 in this.Properties){_51[_52]=this.Properties[_52];}_51["Duration"]=this.get_durationAsTimeSpan();return _51;};window.ComponentArt_SchedulerRecurrencePattern=function(_53,_54,_55,_56,_57,_58){this.Properties={};if(typeof (_53)!="undefined"){this.SetProperty("OccurrenceType",_53);}if(typeof (_54)!="undefined"){this.SetProperty("Interval",_54);}if(typeof (_55)!="undefined"){this.SetProperty("WeekOfMonth",_55);}if(typeof (_56)!="undefined"){this.SetProperty("DayOfMonth",_56);}if(typeof (_57)!="undefined"){this.SetProperty("DaysOfWeek",_57);}if(typeof (_58)!="undefined"){this.SetProperty("Month",_58);}};ComponentArt_SchedulerRecurrencePattern.prototype.PublicProperties=[["OccurrenceType",Number],["Interval",Number],["WeekOfMonth",Number],["DayOfMonth",Number],["DaysOfWeek",Array],["Month",Number]];ComponentArt_SchedulerRecurrencePattern.prototype.GetProperty=function(_59){return this.Properties[_59];};ComponentArt_SchedulerRecurrencePattern.prototype.SetProperty=function(_5a,_5b){this.Properties[_5a]=_5b;};ComponentArt_SchedulerRecurrencePattern.prototype.get_occurrenceType=function(){return this.GetProperty("OccurrenceType");};ComponentArt_SchedulerRecurrencePattern.prototype.set_occurrenceType=function(_5c){this.SetProperty("OccurrenceType",_5c);};ComponentArt_SchedulerRecurrencePattern.prototype.get_interval=function(){return this.GetProperty("Interval");};ComponentArt_SchedulerRecurrencePattern.prototype.set_interval=function(_5d){this.SetProperty("Interval",_5d);};ComponentArt_SchedulerRecurrencePattern.prototype.get_weekOfMonth=function(){return this.GetProperty("WeekOfMonth");};ComponentArt_SchedulerRecurrencePattern.prototype.set_weekOfMonth=function(_5e){this.SetProperty("WeekOfMonth",_5e);};ComponentArt_SchedulerRecurrencePattern.prototype.get_dayOfMonth=function(){return this.GetProperty("DayOfMonth");};ComponentArt_SchedulerRecurrencePattern.prototype.set_dayOfMonth=function(_5f){this.SetProperty("DayOfMonth",_5f);};ComponentArt_SchedulerRecurrencePattern.prototype.get_daysOfWeek=function(){return this.GetProperty("DaysOfWeek");};ComponentArt_SchedulerRecurrencePattern.prototype.set_daysOfWeek=function(_60){this.SetProperty("DaysOfWeek",_60);};ComponentArt_SchedulerRecurrencePattern.prototype.get_month=function(){return this.GetProperty("Month");};ComponentArt_SchedulerRecurrencePattern.prototype.set_month=function(_61){this.SetProperty("Month",_61);};ComponentArt_SchedulerRecurrencePattern.prototype.createJsonObject=function(){var _62={};for(var _63 in this.Properties){_62[_63]=this.Properties[_63];}return _62;};window.ComponentArt_SchedulerRecurringAppointment=function(){this.Properties={};};ComponentArt_SchedulerRecurringAppointment.prototype.GetProperty=function(_64){return this.Properties[_64];};ComponentArt_SchedulerRecurringAppointment.prototype.SetProperty=function(_65,_66){this.Properties[_65]=_66;};ComponentArt_SchedulerRecurringAppointment.prototype.set_parent=function(_67){this.Parent=_67;};ComponentArt_SchedulerRecurringAppointment.prototype.get_parent=function(){return this.Parent;};ComponentArt_SchedulerRecurringAppointment.prototype.get_id=function(){return this.GetProperty("ID");};ComponentArt_SchedulerRecurringAppointment.prototype.set_id=function(_68){this.SetProperty("ID",_68);};ComponentArt_SchedulerRecurringAppointment.prototype.get_appointment=function(){return this.GetProperty("Appointment");};ComponentArt_SchedulerRecurringAppointment.prototype.set_appointment=function(_69){this.SetProperty("Appointment",_69);};ComponentArt_SchedulerRecurringAppointment.prototype.get_range=function(){return this.GetProperty("Range");};ComponentArt_SchedulerRecurringAppointment.prototype.set_range=function(_6a){this.SetProperty("Range",_6a);};ComponentArt_SchedulerRecurringAppointment.prototype.get_pattern=function(){return this.GetProperty("Pattern");};ComponentArt_SchedulerRecurringAppointment.prototype.set_pattern=function(_6b){this.SetProperty("Pattern",_6b);};ComponentArt_SchedulerRecurringAppointment.prototype.get_tag=function(){return this.GetProperty("Tag");};ComponentArt_SchedulerRecurringAppointment.prototype.set_tag=function(_6c){this.SetProperty("Tag",_6c);};ComponentArt_SchedulerRecurringAppointment.prototype.get_occurrences=function(){return this.GetProperty("Occurrences");};ComponentArt_SchedulerRecurringAppointment.prototype.set_occurrences=function(_6d){this.SetProperty("Occurrences",_6d);};ComponentArt_SchedulerRecurringAppointment.prototype.beginUpdate=function(){return this.get_parent().beginUpdate();};ComponentArt_SchedulerRecurringAppointment.prototype.endUpdate=function(){return this.get_parent().endUpdate();};ComponentArt_SchedulerRecurringAppointment.prototype.getExceptions=function(){var _6e=[];if(!this.Parent){return [];}var _6f=this.Parent.Appointments;for(var i=0;i<_6f.length;i++){if(!_6f[i].get_instance()&&_6f[i].get_recurringAppointmentID()&&_6f[i].get_recurringAppointmentID()==this.get_id()){var _71=this.Parent.createAppointmentCopy(_6f[i]);_6e.push(_71);}}return _6e;};ComponentArt_SchedulerRecurringAppointment.prototype.get_isUpdating=function(){return this.get_parent().get_isUpdating();};ComponentArt_SchedulerRecurringAppointment.prototype.PublicProperties=[["ID",String],["Appointment",ComponentArt_SchedulerAppointment],["Range",ComponentArt_Period],["Pattern",ComponentArt_SchedulerRecurrencePattern],["Tag",String],["Occurrences",Number]];ComponentArt_SchedulerRecurringAppointment.prototype.getEarlierInstanceDate=function(_72){var _73=this.get_pattern();switch(_73.get_occurrenceType()){case 0:var _74=new Date(_72.getFullYear(),_72.getMonth(),_72.getDate(),_72.getHours(),_72.getMinutes()-_73.get_interval(),_72.getSeconds(),_72.getMilliseconds());break;case 1:var _74=new Date(_72.getFullYear(),_72.getMonth(),_72.getDate()-_73.get_interval(),_72.getHours(),_72.getMinutes(),_72.getSeconds(),_72.getMilliseconds());break;case 2:var _75=_73.get_daysOfWeek();if(_72.getDay()>_75[0]){var _76=0;while(_72.getDay()>_75[_76]){_76++;}var _74=new Date(_72.getFullYear(),_72.getMonth(),_72.getDate()-(_72.getDay()-_75[_76-1]),_72.getHours(),_72.getMinutes(),_72.getSeconds(),_72.getMilliseconds());}else{var _74=new Date(_72.getFullYear(),_72.getMonth(),_72.getDate()-(_73.get_interval()*7)+(_75[_75.length-1]-_72.getDay()),_72.getHours(),_72.getMinutes(),_72.getSeconds(),_72.getMilliseconds());}break;case 3:if(typeof _73.get_dayOfMonth()=="undefined"||_73.get_dayOfMonth()<0){var _74=new Date(_72.getFullYear(),_72.getMonth()-_73.GetProperty("Interval"),this.get_appointment().get_start().getDate(),_72.getHours(),_72.getMinutes(),_72.getSeconds(),_72.getMilliseconds());if(_74.getDate()!=this.get_appointment().get_start().getDate()){_74.setDate(1);_74.setMonth(_72.getMonth()-_73.GetProperty("Interval"));var _77=32-new Date(_74.getFullYear(),_74.getMonth(),32).getDate();_74.setDate(_77);}}else{var _74=new Date(_72.getTime());var _78=_74.getMonth()-_73.GetProperty("Interval");_74.setDate(1);_74.setMonth(_78);switch(_73.GetProperty("DayOfMonth")){case 7:if(_73.get_weekOfMonth()>3){_74.setDate(32-new Date(_74.getFullYear(),_74.getMonth(),32).getDate());}else{_74.setDate(_73.GetProperty("WeekOfMonth")+1);}break;case 8:var _79=1;var _7a=_73.GetProperty("WeekOfMonth")+1;if(_73.GetProperty("WeekOfMonth")>3){var _77=32-new Date(_74.getFullYear(),_74.getMonth(),32).getDate();_7a=1;_74.setDate(_77+1);_79=-1;}else{_74.setDate(0);}while(_7a>0){_74.setDate(_74.getDate()+_79);if(_74.getDay()!=0&&_74.getDay()!=6){_7a--;}}break;case 9:var _79=1;var _7a=_73.GetProperty("WeekOfMonth")+1;if(_73.GetProperty("WeekOfMonth")>3){var _77=32-new Date(_74.getFullYear(),_74.getMonth(),32).getDate();_7a=1;_74.setDate(_77+1);_79=-1;}else{_74.setDate(0);}while(_7a>0){_74.setDate(_74.getDate()+_79);if(_74.getDay()==0||_74.getDay()==6){_7a--;}}break;default:var _77=32-new Date(_74.getFullYear(),_74.getMonth(),32).getDate();if(_73.GetProperty("WeekOfMonth")>3){_74.setDate(_77);while(_74.getDay()!=_73.GetProperty("DayOfMonth")){_74.setDate(_74.getDate()-1);}}else{var _7b=0;while(_7b<_73.GetProperty("WeekOfMonth")&&_74.getDate()<_77){if(_74.getDay()==_73.GetProperty("DayOfMonth")){_7b++;}_74.setDate(_74.getDate()+1);}while(_74.getDay()!=_73.GetProperty("DayOfMonth")){_74.setDate(_74.getDate()+1);}}break;}}break;case 4:if(typeof _73.get_interval()!="undefined"&&_73.get_interval()>0){var _74=new Date(_72.getFullYear()-1,_73.get_month(),_73.get_interval(),_72.getHours(),_72.getMinutes(),_72.getSeconds(),_72.getMilliseconds());}else{var _74=new Date(_72.getFullYear()-1,_73.GetProperty("Month"),1,_72.getHours(),_72.getMinutes(),_72.getSeconds(),_72.getMilliseconds());switch(_73.GetProperty("DayOfMonth")){case 7:if(_73.GetProperty("WeekOfMonth")>3){var _77=32-new Date(_74.getFullYear(),_74.getMonth(),32).getDate();_74.setDate(_77);}else{_74.setDate(_73.GetProperty("WeekOfMonth"));}break;case 8:var _79=1;var _7a=_73.GetProperty("WeekOfMonth")+1;if(_73.GetProperty("WeekOfMonth")>3){var _77=32-new Date(_74.getFullYear(),_74.getMonth(),32).getDate();_7a=1;_74.setDate(_77+1);_79=-1;}else{_74.setDate(0);}while(_7a>0){_74.setDate(_74.getDate()+_79);if(_74.getDay()!=0&&_74.getDay()!=6){_7a--;}}break;case 9:var _79=1;var _7a=_73.GetProperty("WeekOfMonth")+1;if(_73.GetProperty("WeekOfMonth")>3){var _77=32-new Date(_74.getFullYear(),_74.getMonth(),32).getDate();_7a=1;_74.setDate(_77+1);_79=-1;}else{_74.setDate(0);}while(_7a>0){_74.setDate(_74.getDate()+_79);if(_74.getDay()==0||_74.getDay()==6){_7a--;}}break;default:var _77=32-new Date(_74.getFullYear(),_74.getMonth(),32).getDate();if(_73.GetProperty("WeekOfMonth")>3){_74.setDate(_77);while(_74.getDay()!=_73.GetProperty("DayOfMonth")){_74.setDate(_74.getDate()-1);}}else{var _7b=0;while(_7b<_73.GetProperty("WeekOfMonth")&&_74.getDate()<_77){if(_74.getDay()==_73.GetProperty("DayOfMonth")){_7b++;}_74.setDate(_74.getDate()+1);}while(_74.getDay()!=_73.GetProperty("DayOfMonth")){_74.setDate(_74.getDate()+1);}}break;}}break;default:return null;break;}return _74;};ComponentArt_SchedulerRecurringAppointment.prototype.getLaterInstanceDate=function(_7c){var _7d=this.get_pattern();switch(_7d.get_occurrenceType()){case 0:var _7e=new Date(_7c.getFullYear(),_7c.getMonth(),_7c.getDate(),_7c.getHours(),_7c.getMinutes()+_7d.GetProperty("Interval"),_7c.getSeconds(),_7c.getMilliseconds());break;case 1:var _7e=new Date(_7c.getFullYear(),_7c.getMonth(),_7c.getDate()+_7d.GetProperty("Interval"),_7c.getHours(),_7c.getMinutes(),_7c.getSeconds(),_7c.getMilliseconds());break;case 2:var _7f=_7d.get_daysOfWeek();if(_7c.getDay()<_7f[_7f.length-1]){var _80=_7f.length-1;while(_7c.getDay()<_7f[_80]){_80--;}var _7e=new Date(_7c.getFullYear(),_7c.getMonth(),_7c.getDate()+(_7f[_80+1]-_7c.getDay()),_7c.getHours(),_7c.getMinutes(),_7c.getSeconds(),_7c.getMilliseconds());}else{var _7e=new Date(_7c.getFullYear(),_7c.getMonth(),_7c.getDate()+(_7d.get_interval()*7)+(_7f[0]-_7c.getDay()),_7c.getHours(),_7c.getMinutes(),_7c.getSeconds(),_7c.getMilliseconds());}break;case 3:if(typeof _7d.get_dayOfMonth()=="undefined"||_7d.get_dayOfMonth()<0){var _7e=new Date(_7c.getFullYear(),_7c.getMonth()+_7d.GetProperty("Interval"),this.get_appointment().get_start().getDate(),_7c.getHours(),_7c.getMinutes(),_7c.getSeconds(),_7c.getMilliseconds());if(_7e.getDate()!=this.get_appointment().get_start().getDate()){_7e.setDate(1);_7e.setMonth(_7c.getMonth()+_7d.GetProperty("Interval"));var _81=32-new Date(_7e.getFullYear(),_7e.getMonth(),32).getDate();_7e.setDate(_81);}}else{var _7e=new Date(_7c.getTime());var _82=_7e.getMonth()+_7d.GetProperty("Interval");_7e.setDate(1);_7e.setMonth(_82);switch(_7d.GetProperty("DayOfMonth")){case 7:if(_7d.get_weekOfMonth()>3){_7e.setDate(32-new Date(_7e.getFullYear(),_7e.getMonth(),32).getDate());}else{_7e.setDate(_7d.GetProperty("WeekOfMonth")+1);}break;case 8:var _83=1;var _84=_7d.GetProperty("WeekOfMonth")+1;if(_7d.GetProperty("WeekOfMonth")>3){var _81=32-new Date(_7e.getFullYear(),_7e.getMonth(),32).getDate();_84=1;_7e.setDate(_81+1);_83=-1;}else{_7e.setDate(0);}while(_84>0){_7e.setDate(_7e.getDate()+_83);if(_7e.getDay()!=0&&_7e.getDay()!=6){_84--;}}break;case 9:var _83=1;var _84=_7d.GetProperty("WeekOfMonth")+1;if(_7d.GetProperty("WeekOfMonth")>3){var _81=32-new Date(_7e.getFullYear(),_7e.getMonth(),32).getDate();_84=1;_7e.setDate(_81+1);_83=-1;}else{_7e.setDate(0);}while(_84>0){_7e.setDate(_7e.getDate()+_83);if(_7e.getDay()==0||_7e.getDay()==6){_84--;}}break;default:var _81=32-new Date(_7e.getFullYear(),_7e.getMonth(),32).getDate();if(_7d.GetProperty("WeekOfMonth")>3){_7e.setDate(_81);while(_7e.getDay()!=_7d.GetProperty("DayOfMonth")){_7e.setDate(_7e.getDate()-1);}}else{var _85=0;while(_85<_7d.GetProperty("WeekOfMonth")&&_7e.getDate()<_81){if(_7e.getDay()==_7d.GetProperty("DayOfMonth")){_85++;}_7e.setDate(_7e.getDate()+1);}while(_7e.getDay()!=_7d.GetProperty("DayOfMonth")){_7e.setDate(_7e.getDate()+1);}}break;}}break;case 4:if(typeof _7d.get_interval()!="undefined"&&_7d.get_interval()>0){var _7e=new Date(_7c.getFullYear()+1,_7d.get_month(),_7d.get_interval(),_7c.getHours(),_7c.getMinutes(),_7c.getSeconds(),_7c.getMilliseconds());}else{var _7e=new Date(_7c.getFullYear()+1,_7d.GetProperty("Month"),1,_7c.getHours(),_7c.getMinutes(),_7c.getSeconds(),_7c.getMilliseconds());switch(_7d.GetProperty("DayOfMonth")){case 7:if(_7d.GetProperty("WeekOfMonth")>3){var _81=32-new Date(_7e.getFullYear(),_7e.getMonth(),32).getDate();_7e.setDate(_81);}else{_7e.setDate(_7d.GetProperty("WeekOfMonth"));}break;case 8:var _83=1;var _84=_7d.GetProperty("WeekOfMonth")+1;if(_7d.GetProperty("WeekOfMonth")>3){var _81=32-new Date(_7e.getFullYear(),_7e.getMonth(),32).getDate();_84=1;_7e.setDate(_81+1);_83=-1;}else{_7e.setDate(0);}while(_84>0){_7e.setDate(_7e.getDate()+_83);if(_7e.getDay()!=0&&_7e.getDay()!=6){_84--;}}break;case 9:var _83=1;var _84=_7d.GetProperty("WeekOfMonth")+1;if(_7d.GetProperty("WeekOfMonth")>3){var _81=32-new Date(_7e.getFullYear(),_7e.getMonth(),32).getDate();_84=1;_7e.setDate(_81+1);_83=-1;}else{_7e.setDate(0);}while(_84>0){_7e.setDate(_7e.getDate()+_83);if(_7e.getDay()==0||_7e.getDay()==6){_84--;}}break;default:var _81=32-new Date(_7e.getFullYear(),_7e.getMonth(),32).getDate();if(_7d.GetProperty("WeekOfMonth")>3){_7e.setDate(_81);while(_7e.getDay()!=_7d.GetProperty("DayOfMonth")){_7e.setDate(_7e.getDate()-1);}}else{var _85=0;while(_85<_7d.GetProperty("WeekOfMonth")&&_7e.getDate()<_81){if(_7e.getDay()==_7d.GetProperty("DayOfMonth")){_85++;}_7e.setDate(_7e.getDate()+1);}while(_7e.getDay()!=_7d.GetProperty("DayOfMonth")){_7e.setDate(_7e.getDate()+1);}}break;}}break;default:return null;break;}return _7e;};ComponentArt_SchedulerRecurringAppointment.prototype.isDateOccurrence=function(_86){if(!this.get_range()||!this.get_range().get_startDateTime()||!this.get_range().get_endDateTime()||!this.get_appointment()||!this.get_appointment().get_start()){return null;}var _87=new Date(this.get_range().get_startDateTime().getFullYear(),this.get_range().get_startDateTime().getMonth(),this.get_range().get_startDateTime().getDate(),this.get_appointment().get_start().getHours(),this.get_appointment().get_start().getMinutes(),this.get_appointment().get_start().getSeconds(),this.get_appointment().get_start().getMilliseconds());var _88=new Date(this.get_range().get_endDateTime().getFullYear(),this.get_range().get_startDateTime().getMonth(),this.get_range().get_startDateTime().getDate(),this.get_appointment().get_start().getHours(),this.get_appointment().get_start().getMinutes(),this.get_appointment().get_start().getSeconds(),this.get_appointment().get_start().getMilliseconds());if(_86.getTime()==_87.getTime()||_86.getTime()==_88.getTime()){return true;}if(_86<_87||_86>_88){return false;}var _89=this.getLaterInstanceDate(_87);if(_89>_86){while(_89>_86&&_89>_87){_89=this.getEarlierInstanceDate(_89);}}else{while(_89<_86&&_89<_88){_89=this.getLaterInstanceDate(_89);}}if(_89.getTime()==_86.getTime()){return true;}return false;};ComponentArt_SchedulerRecurringAppointment.prototype.getDateAfterOccurrences=function(_8a,_8b){var _8c=1;var _8d=_8a;while(_8c<_8b){_8d=this.getLaterInstanceDate(_8d);_8c++;}return new Date(_8d.getTime()+this.get_appointment().get_duration());};ComponentArt_SchedulerRecurringAppointment.prototype.getFirstOccurrenceDate=function(){if(!this.get_range()||!this.get_range().get_startDateTime()||!this.get_range().get_endDateTime()||!this.get_appointment()||!this.get_appointment().get_start()||!this.get_pattern()){return null;}var _8e=new Date(this.get_range().get_startDateTime().getFullYear(),this.get_range().get_startDateTime().getMonth(),this.get_range().get_startDateTime().getDate(),this.get_appointment().get_start().getHours(),this.get_appointment().get_start().getMinutes(),this.get_appointment().get_start().getSeconds(),this.get_appointment().get_start().getMilliseconds());var _8f=new Date(this.get_range().get_endDateTime().getFullYear(),this.get_range().get_endDateTime().getMonth(),this.get_range().get_endDateTime().getDate(),this.get_appointment().get_start().getHours(),this.get_appointment().get_start().getMinutes(),this.get_appointment().get_start().getSeconds(),this.get_appointment().get_start().getMilliseconds());var _90=1;if(this.get_pattern().get_interval()&&this.get_pattern().get_occurrenceType()!=4){_90=this.get_pattern().get_interval();this.get_pattern().set_interval(1);}var _91=this.getLaterInstanceDate(_8e);var _92=this.getEarlierInstanceDate(_91);if(this.get_pattern().get_interval()&&this.get_pattern().get_occurrenceType()!=4){this.get_pattern().set_interval(_90);}if(_92>=_8e&&_92<=_8f){return _92;}else{if(_91>=_8e&&_91<=_8f){return _91;}}return null;};ComponentArt_SchedulerRecurringAppointment.prototype.createJsonObject=function(){var _93={};_93["Appointment"]=this.get_appointment().createJsonObject();_93["Pattern"]=this.get_pattern().createJsonObject();for(var _94 in this.Properties){if(_94!="Appointment"&&_94!="Pattern"){_93[_94]=this.Properties[_94];}}_93["Range"]["Duration"]=this.get_range().get_durationAsTimeSpan();return _93;};window.ComponentArt_Scheduler=function(_95){this.element=document.getElementById(_95+"_appointments");if(window.ComponentArt_Atlas){ComponentArt.Web.UI.Scheduler.initializeBase(this,[this.element]);this.beginUpdate=function(){this._updating=true;};this.endUpdate=function(){this._updating=false;this.Render();};this.get_isUpdating=function(){return this._updating;};this.getDescriptor=function(){return _zF0(this.constructor);};}else{this.beginUpdate=function(){this._updating=true;};this.endUpdate=function(){this._updating=false;this.Render();};this.get_isUpdating=function(){return this._updating;};}this.ClientControlId=this.Id=this.SchedulerId=_95;this.Commands=[];this.UpdateNeeded=false;this.UpdateInProgress=false;};ComponentArt_Scheduler.prototype.GetProperty=function(_96){return this[_96];};ComponentArt_Scheduler.prototype.SetProperty=function(_97,_98){this[_97]=_98;};window.ComponentArt.Web.UI.Scheduler=ComponentArt_Scheduler;ComponentArt_Scheduler.prototype.PublicProperties=[["AutoUpdate"],["SoaService"]];ComponentArt_Scheduler.prototype.PublicMethods=[["Callback"],["LoadAppointments"]];ComponentArt_Scheduler.prototype.PublicEvents=[["AppointmentBeforeModify"],["AppointmentBeforeRemove"],["AppointmentModify"],["AppointmentRemove"],["BeforeCallback"],["BeforeWebService"],["CallbackComplete"],["CallbackError"],["Load"],["WebServiceComplete"],["WebServiceError"]];_zEF(ComponentArt_Scheduler,"this");if(window.ComponentArt_Atlas){ComponentArt.Web.UI.Scheduler.registerClass("ComponentArt.Web.UI.Scheduler",Sys.UI.Control);if(Sys.TypeDescriptor){Sys.TypeDescriptor.addType("componentArtWebUI","scheduler",ComponentArt.Web.UI.Scheduler);}}ComponentArt_Scheduler.prototype.get_autoUpdate=function(){return this.AutoUpdate;};ComponentArt_Scheduler.prototype.set_autoUpdate=function(_99){this.AutoUpdate=_99;};ComponentArt_Scheduler.prototype.get_autoUpdateInterval=function(){return this.AutoUpdateInterval;};ComponentArt_Scheduler.prototype.set_autoUpdateInterval=function(_9a){this.AutoUpdateInterval=_9a;};ComponentArt_Scheduler.prototype.get_autoUpdateMode=function(){return this.AutoUpdateMode;};ComponentArt_Scheduler.prototype.set_autoUpdateMode=function(_9b){this.AutoUpdateMode=_9b;};ComponentArt_Scheduler.prototype.get_soaService=function(){return this.SoaService;};ComponentArt_Scheduler.prototype.set_soaService=function(_9c){this.SoaService=_9c;};ComponentArt_Scheduler.prototype.get_updateNeeded=function(){return this.UpdateNeeded;};ComponentArt_Scheduler.prototype.set_updateNeeded=function(_9d){if(_9d==true&&this.UpdateNeeded==false){if(this.get_autoUpdate()){var _9e=this.get_autoUpdateInterval();if(_9e>0){window.setTimeout("window."+this.Id+".update()",_9e);}else{this.update();}}else{this.UpdateNeeded=true;}}else{this.UpdateNeeded=_9d;}};ComponentArt_Scheduler.prototype.update=function(){switch(this.get_autoUpdateMode()){case cart_SchedulerUpdateMode_CallBack:this.Callback();break;case cart_SchedulerUpdateMode_PostBack:window.__doPostBack(this.Id,"");break;case cart_SchedulerUpdateMode_WebService:break;}};ComponentArt_Scheduler.prototype.get_updateInProgress=function(){return this.UpdateInProgress;};ComponentArt_Scheduler.prototype.LoadAppointments=function(_9f){this.Appointments=[];for(var i=0;i<_9f.length;i++){var _a1=new ComponentArt_SchedulerAppointment();_a1.set_parent(this);_a1.Properties=_9f[i];this.Appointments.push(_a1);}};ComponentArt_Scheduler.prototype.LoadRecurringAppointments=function(_a2,_a3){this.RecurringAppointments=[];for(var i=0;i<_a2.length;i++){var _a5=new ComponentArt_SchedulerRecurringAppointment();_a5.set_parent(this);_a5.Properties=_a2[i];if(_a3){var _a6=new ComponentArt_SchedulerAppointment();_a6.set_parent(this);_a6.Properties=_a5.Properties.Appointment;_a5.set_appointment(_a6);var _a7=new ComponentArt_Period();_a7.set_startDateTime(_a5.Properties.Range.StartDateTime);_a7.set_duration(_a5.Properties.Range.Duration);_a5.set_range(_a7);var _a8=new ComponentArt_SchedulerRecurrencePattern();_a8.Properties=_a5.Properties.Pattern;_a5.set_pattern(_a8);}this.RecurringAppointments.push(_a5);}};ComponentArt_Scheduler.prototype.LoadProperties=function(_a9){if(!_a9){_a9=[];}this.PropertyStorageArray=_a9;for(var i=0;i<_a9.length;i++){var _ab=_a9[i][0];var _ac=_a9[i][1];switch(_ab){case "AppointmentsPropertyStorage":this.LoadAppointments(_ac);break;case "RecurringAppointmentsPropertyStorage":this.LoadRecurringAppointments(_ac);break;default:this[_ab]=_ac;break;}}};ComponentArt_Scheduler.prototype.createRecurringAppointmentInstances=function(_ad){for(var i=this.Appointments.length-1;i>-1;i--){if(this.Appointments[i].get_instance()){this.Appointments.splice(i,1);}}for(var i=0;i<this.RecurringAppointments.length;i++){var _af=this.RecurringAppointments[i];if(!_af.get_range().overlaps(_ad)){continue;}var _b0=_af.getExceptions();var _b1=_af.get_appointment();var _b2;if(_b1.get_period().overlaps(_ad)){var _b3=false;for(var j=0;j<_b0.length;j++){if(Date.parse(_b0[j].get_start())==Date.parse(_b1.get_start())){_b3=true;break;}}if(!_b3){_b2=this.createAppointmentCopy(_b1);_b2.Properties["RecurringAppointmentID"]=_af.get_id();_b2.Properties["Instance"]=true;_b2.Parent=this;this.Appointments.push(_b2);}}var _b5=_af.getEarlierInstanceDate(new Date(_b1.get_start().getTime()));var _b6=new ComponentArt_Period(_b5,_b1.get_duration());while(_b5>=new Date(_ad.get_startDateTime().getTime()-_b1.get_duration())){_b6.set_startDateTime(_b5);if(_b6.overlaps(_af.get_range())&&_b6.overlaps(_ad)){var _b3=false;for(var j=0;j<_b0.length;j++){if(Date.parse(_b0[j].get_start())==Date.parse(_b5)){_b3=true;break;}}if(!_b3){_b2=this.createAppointmentCopy(_b1);_b2.set_start(_b5);_b2.set_appointmentID(_af.get_id()+"_"+_b5.toLocaleString().replace(/[\s\:\-\(\)\,\.]/g,"_").replace(/__/g,"_"));_b2.Properties["RecurringAppointmentID"]=_af.get_id();_b2.Properties["Instance"]=true;_b2.Parent=this;this.Appointments.push(_b2);}}_b5=_af.getEarlierInstanceDate(new Date(_b5));}_b5=_af.getLaterInstanceDate(new Date(_b1.get_start().getTime()));_b6.set_startDateTime(_b5);while(_b5<new Date(_ad.get_endDateTime().getTime()+_b1.get_duration())){_b6.set_startDateTime(_b5);if(_b6.overlaps(_af.get_range())&&_b6.overlaps(_ad)){var _b3=false;for(var j=0;j<_b0.length;j++){if(Date.parse(_b0[j].get_start())==Date.parse(_b5)){_b3=true;break;}}if(!_b3){_b2=this.createAppointmentCopy(_b1);_b2.set_start(_b5);_b2.set_appointmentID(_af.get_id()+"_"+_b5.toLocaleString().replace(/[\s\:\-\(\)\,\.]/g,"_").replace(/__/g,"_"));_b2.Properties["RecurringAppointmentID"]=_af.get_id();_b2.Properties["Instance"]=true;_b2.Parent=this;this.Appointments.push(_b2);}}_b5=_af.getLaterInstanceDate(new Date(_b5));}}};ComponentArt_Scheduler.prototype.LoadingPanelsShow=function(){for(var i=0;i<this.ViewIDs.length;i++){if(window[this.ViewIDs[i]]&&window[this.ViewIDs[i]].loadingPanelShow){window[this.ViewIDs[i]].loadingPanelShow();}}};ComponentArt_Scheduler.prototype.LoadingPanelsHide=function(){for(var i=0;i<this.ViewIDs.length;i++){if(window[this.ViewIDs[i]]&&window[this.ViewIDs[i]].loadingPanelHide){window[this.ViewIDs[i]].loadingPanelHide();}}};ComponentArt_Scheduler.prototype.WebServiceGetAppointments=function(){if(this.SoaService){var _b9=this;function FailureCallback(_ba,_bb,_bc){var _bd=_b9.get_events().getHandler("webServiceError");if(_bd){_bd(_b9,new ComponentArt.Web.UI.SchedulerWebServiceErrorEventArgs(_ba.get_message()));}else{alert(_ba.get_message());}_b9.LoadingPanelsHide();}function SuccessCallback(_be,_bf,_c0){if(_be.RecurringAppointments&&_be.RecurringAppointments.length){_b9.LoadRecurringAppointments(_be.RecurringAppointments,true);}else{_b9.LoadRecurringAppointments([],true);}if(_be.Appointments&&_be.Appointments.length){_b9.LoadAppointments(_be.Appointments);}else{_b9.LoadAppointments([]);}_b9.AppointmentsDownloaded();_b9.LoadingPanelsHide();for(var i=0;i<_b9.ViewIDs.length;i++){window[_b9.ViewIDs[i]].render();}var _c2=_b9.get_events().getHandler("webServiceComplete");if(_c2){_c2(_b9,new ComponentArt.Web.UI.SchedulerWebServiceCompleteEventArgs("",false,_b9.WebServiceGetAppointmentsMethod));}}var _c3=_b9.get_events().getHandler("beforeWebService");if(_c3){_c3(_b9,Sys.EventArgs.Empty);}_b9.LoadingPanelsShow();var _c4=new Date();var _c5=null;var _c6=null;for(var i=0;i<_b9.ViewIDs.length;i++){if(!window[_b9.ViewIDs[i]]||!window[_b9.ViewIDs[i]].StartDate){setTimeout(_b9.SchedulerId+".WebServiceGetAppointments();",10);return false;}_c4=new Date(window[_b9.ViewIDs[i]].StartDate.getTime()+window[_b9.ViewIDs[i]].StartTime);_c5=(_c5!=null)?(_c5<_c4?_c5:_c4):_c4;_c4=new Date(window[_b9.ViewIDs[i]].EndDate.getTime()+window[_b9.ViewIDs[i]].EndTime);_c6=(_c6!=null)?(_c6>_c4?_c6:_c4):_c4;}var _c8={"EndDateTime":new Date(_c6),"StartDateTime":new Date(_c5),"TimezoneOffset":new Date().getTimezoneOffset(),"Tag":_b9.SoaRequestTag?_b9.SoaRequestTag:null};var _c9=eval(_b9.SoaService);_c9[_b9.WebServiceGetAppointmentsMethod](_c8,SuccessCallback,FailureCallback);}};ComponentArt_Scheduler.prototype.WebServiceAddAppointment=function(_ca){if(this.SoaService){var _cb=this;function FailureCallback(_cc,_cd,_ce){var _cf=_cb.get_events().getHandler("webServiceError");if(_cf){_cf(_cb,new ComponentArt.Web.UI.SchedulerWebServiceErrorEventArgs(_cc.get_message()));}else{alert(_cc.get_message());}_cb.LoadingPanelsHide();}function SuccessCallback(_d0,_d1,_d2){var _d3=_d0.Cancel?_d0.Cancel:false;if(!_d3){_cb.Appointments.push(_ca);}_cb.AppointmentsDownloaded();_cb.LoadingPanelsHide();var _d4=_cb.get_events().getHandler("webServiceComplete");var _d5=_d0.Message?_d0.Message:"";if(_d4){_d4(_cb,new ComponentArt.Web.UI.SchedulerWebServiceCompleteEventArgs(_d5,_d3,_cb.WebServiceAppointmentAddMethod));}else{if(_d5!=""){alert(_d5);}}}var _d6=_cb.get_events().getHandler("beforeWebService");if(_d6){_d6(_cb,Sys.EventArgs.Empty);}_cb.LoadingPanelsShow();var _d7=new ComponentArt_SchedulerAppointment();_d7.Properties={};for(var _d8 in _ca.Properties){_d7.Properties[_d8]=_ca.Properties[_d8];}_d7.Properties["Duration"]=_d7.get_durationAsTimeSpan(_d7.get_duration());var _d9={"Appointment":_d7.Properties,"TimezoneOffset":new Date().getTimezoneOffset(),"Tag":this.SoaRequestTag?this.SoaRequestTag:null};var _da=eval(this.SoaService);_da[_cb.WebServiceAppointmentAddMethod](_d9,SuccessCallback,FailureCallback);}};ComponentArt_Scheduler.prototype.WebServiceModifyAppointment=function(_db){var _dc=this;var _dd=_dc.findAppointmentById(_db.get_appointmentID());if(this.SoaService){function FailureCallback(_de,_df,_e0){var _e1=_dc.get_events().getHandler("webServiceError");if(_e1){_e1(_dc,new ComponentArt.Web.UI.SchedulerWebServiceErrorEventArgs(_de.get_message()));}else{alert(_de.get_message());}_dc.LoadingPanelsHide();}function SuccessCallback(_e2,_e3,_e4){var _e5=_e2.Cancel?_e2.Cancel:false;if(_e5){for(var i=0;i<_dc.Appointments.length;i++){if(_dc.Appointments[i].get_appointmentID()==_db.get_appointmentID()){_dc.Appointments[i]=_db;break;}}}_dc.AppointmentsDownloaded();_dc.LoadingPanelsHide();var _e7=_dc.get_events().getHandler("webServiceComplete");var _e8=_e2.Message?_e2.Message:"";if(_e7){_e7(_dc,new ComponentArt.Web.UI.SchedulerWebServiceCompleteEventArgs(_e8,_e5,_dc.WebServiceAppointmentModifyMethod));}else{if(_e8!=""){alert(_e8);}}}var _e9=_dc.get_events().getHandler("beforeWebService");if(_e9){_e9(_dc,Sys.EventArgs.Empty);}_dc.LoadingPanelsShow();var _ea=_db.Properties;_ea.Duration=_db.get_durationAsTimeSpan(_db.get_duration());var _eb=_dd.Properties;_eb.Duration=_dd.get_durationAsTimeSpan(_dd.get_duration());var _ec={"AppointmentBefore":_ea,"AppointmentAfter":_eb,"TimezoneOffset":new Date().getTimezoneOffset(),"Tag":this.SoaRequestTag?this.SoaRequestTag:null};var _ed=eval(this.SoaService);_ed[_dc.WebServiceAppointmentModifyMethod](_ec,SuccessCallback,FailureCallback);}};ComponentArt_Scheduler.prototype.WebServiceRemoveAppointment=function(_ee){if(this.SoaService){var _ef=this;function FailureCallback(_f0,_f1,_f2){var _f3=_ef.get_events().getHandler("webServiceError");if(_f3){_f3(_ef,new ComponentArt.Web.UI.SchedulerWebServiceErrorEventArgs(_f0.get_message()));}else{alert(_f0.get_message());}_ef.LoadingPanelsHide();}function SuccessCallback(_f4,_f5,_f6){var _f7=_f4.Message?_f4.Message:"";var _f8=_f4.Cancel?_f4.Cancel:false;if(!_f8){var _f9=_ee.get_appointmentID();var _fa=false;for(var i=0;i<_ef.Appointments.length;i++){if(_ef.Appointments[i].get_appointmentID()==_f9){_ef.Appointments.splice(i,1);_fa=true;}}if(!_fa){_f7+="\nUnable to remove appointment -- missing/invalid AppointmentID";}}_ef.AppointmentsDownloaded();_ef.LoadingPanelsHide();var _fc=_ef.get_events().getHandler("webServiceComplete");if(_fc){_fc(_ef,new ComponentArt.Web.UI.SchedulerWebServiceCompleteEventArgs(_f7,_f8,_ef.WebServiceAppointmentRemoveMethod));}else{if(_f7!=""){alert(_f7);}}}var _fd=_ef.get_events().getHandler("beforeWebService");if(_fd){_fd(_ef,Sys.EventArgs.Empty);}_ef.LoadingPanelsShow();var _fe=new ComponentArt_SchedulerAppointment();_fe.Properties={};for(var _ff in _ee.Properties){_fe.Properties[_ff]=_ee.Properties[_ff];}_fe.Properties["Duration"]=_fe.get_durationAsTimeSpan(_fe.get_duration());var _100={"Appointment":_fe.Properties,"TimezoneOffset":new Date().getTimezoneOffset(),"Tag":this.SoaRequestTag?this.SoaRequestTag:null};var _101=eval(this.SoaService);_101[_ef.WebServiceAppointmentRemoveMethod](_100,SuccessCallback,FailureCallback);}};ComponentArt_Scheduler.prototype.WebServiceAddRecurringAppointment=function(_102){if(this.SoaService){var _103=this;function FailureCallback(_104,_105,_106){var _107=_103.get_events().getHandler("webServiceError");if(_107){_107(_103,new ComponentArt.Web.UI.SchedulerWebServiceErrorEventArgs(_104.get_message()));}else{alert(_104.get_message());}_103.LoadingPanelsHide();}function SuccessCallback(_108,_109,_10a){var _10b=_108.Cancel?_108.Cancel:false;if(!_10b){_103.RecurringAppointments.push(_102);}_103.AppointmentsDownloaded();_103.LoadingPanelsHide();var _10c=_103.get_events().getHandler("webServiceComplete");var _10d=_108.Message?_108.Message:"";if(_10c){_10c(_103,new ComponentArt.Web.UI.SchedulerWebServiceCompleteEventArgs(_10d,_10b,_103.WebServiceRecurringAppointmentAddMethod));}else{if(_10d!=""){alert(_10d);}}}var _10e=_103.get_events().getHandler("beforeWebService");if(_10e){_10e(_103,Sys.EventArgs.Empty);}_103.LoadingPanelsShow();var _10f=_102.createJsonObject();var _110={"RecurringAppointment":_10f,"TimezoneOffset":new Date().getTimezoneOffset(),"Tag":this.SoaRequestTag?this.SoaRequestTag:null};var _111=eval(this.SoaService);_111[_103.WebServiceRecurringAppointmentAddMethod](_110,SuccessCallback,FailureCallback);}};ComponentArt_Scheduler.prototype.WebServiceModifyRecurringAppointment=function(_112){var _113=this;var _114=_113.findRecurringAppointmentById(_112.get_id());if(this.SoaService){function FailureCallback(_115,_116,_117){var _118=_113.get_events().getHandler("webServiceError");if(_118){_118(_113,new ComponentArt.Web.UI.SchedulerWebServiceErrorEventArgs(_115.get_message()));}else{alert(_115.get_message());}_113.LoadingPanelsHide();}function SuccessCallback(_119,_11a,_11b){var _11c=_119.Cancel?_119.Cancel:false;if(_11c){for(var i=0;i<_113.RecurringAppointments.length;i++){if(_113.RecurringAppointments[i].get_id()==_112.get_id()){_113.RecurringAppointments[i]=_112;break;}}}_113.AppointmentsDownloaded();_113.LoadingPanelsHide();var _11e=_113.get_events().getHandler("webServiceComplete");var _11f=_119.Message?_119.Message:"";if(_11e){_11e(_113,new ComponentArt.Web.UI.SchedulerWebServiceCompleteEventArgs(_11f,_11c,_113.WebServiceRecurringAppointmentModifyMethod));}else{if(_11f!=""){alert(_11f);}}}var _120=_113.get_events().getHandler("beforeWebService");if(_120){_120(_113,Sys.EventArgs.Empty);}_113.LoadingPanelsShow();var _121=_112.createJsonObject();var _122=_114.createJsonObject();var _123={"RecurringAppointmentBefore":_121,"RecurringAppointmentAfter":_122,"TimezoneOffset":new Date().getTimezoneOffset(),"Tag":this.SoaRequestTag?this.SoaRequestTag:null};var _124=eval(this.SoaService);_124[_113.WebServiceRecurringAppointmentModifyMethod](_123,SuccessCallback,FailureCallback);}};ComponentArt_Scheduler.prototype.WebServiceRemoveRecurringAppointment=function(_125){if(this.SoaService){var _126=this;function FailureCallback(_127,_128,_129){var _12a=_126.get_events().getHandler("webServiceError");if(_12a){_12a(_126,new ComponentArt.Web.UI.SchedulerWebServiceErrorEventArgs(_127.get_message()));}else{alert(_127.get_message());}_126.LoadingPanelsHide();}function SuccessCallback(_12b,_12c,_12d){var _12e=_12b.Message?_12b.Message:"";var _12f=_12b.Cancel?_12b.Cancel:false;if(!_12f){var _130=false;for(var i=0;i<_126.RecurringAppointments.length;i++){if(_126.RecurringAppointments[i].get_id()==_125.get_id()){_126.RecurringAppointments.splice(i,1);_130=true;}}if(!_130){_12e+="\nUnable to remove appointment -- missing/invalid ID.";}}_126.AppointmentsDownloaded();_126.LoadingPanelsHide();var _132=_126.get_events().getHandler("webServiceComplete");if(_132){_132(_126,new ComponentArt.Web.UI.SchedulerWebServiceCompleteEventArgs(_12e,_12f,_126.WebServiceRecurringAppointmentRemoveMethod));}else{if(_12e!=""){alert(_12e);}}}var _133=_126.get_events().getHandler("beforeWebService");if(_133){_133(_126,Sys.EventArgs.Empty);}_126.LoadingPanelsShow();var _134=_125.createJsonObject();var _135={"RecurringAppointment":_134,"TimezoneOffset":new Date().getTimezoneOffset(),"Tag":this.SoaRequestTag?this.SoaRequestTag:null};var _136=eval(this.SoaService);_136[_126.WebServiceRecurringAppointmentRemoveMethod](_135,SuccessCallback,FailureCallback);}};ComponentArt_Scheduler.prototype.Callback=function(){var _137=this;var _138=false;var xdoc=null;function Cleanup(){_137.CallbackInProgress=false;_137.LoadingPanelsHide();var _13a=_137.get_events().getHandler("callbackComplete");if(_13a){_13a(_137,Sys.EventArgs.Empty);}}function _z19F(){if(xdoc.readyState&&xdoc.readyState!=4&&xdoc.readyState!="complete"){return;}Cleanup();}if(this.CallbackInProgress){return false;}else{this.CallbackInProgress=true;}var _13b=this.get_events().getHandler("beforeCallback");if(_13b){_13b(this,Sys.EventArgs.Empty);}this.LoadingPanelsShow();var url=this.CallbackUrl;var _13d=this.getCommandsXml();if(window.XMLHttpRequest){_138=true;var xdoc=new XMLHttpRequest();xdoc.onreadystatechange=_z19F;xdoc.open("POST",url,true);xdoc.setRequestHeader("Content-Type","text/xml");xdoc.send(_13d);}else{if(document.implementation&&document.implementation.createDocument){xdoc=document.implementation.createDocument("","",null);xdoc.onload=_z19F;}else{if(cart_browser_ie){if(window.ActiveXObject){try{xdoc=new ActiveXObject("Microsoft.XMLHTTP");xdoc.onreadystatechange=_z19F;xdoc.open("POST",url,true);xdoc.setRequestHeader("Content-Type","text/xml");xdoc.send(_13d);_138=true;}catch(ex){}}if(xdoc==null){var _13e=this.Id+"_island";var _13f=document.getElementById(_13e);if(!_13f){_13f=document.createElement("xml");_13f.id=_13e;document.body.appendChild(_13f);}if(_13f.XMLDocument){xdoc=_13f.XMLDocument;xdoc.onreadystatechange=_z19F;}else{return false;}}}else{return false;}}}if(!_138){xdoc.async=true;try{xdoc.load(url+_13d);}catch(ex){var _13b=_137.get_events().getHandler("callbackError");if(_13b){_13b(_137,new ComponentArt.Web.UI.SchedulerCallBackErrorEventArgs(ex.message?ex.message:ex));}else{alert("Data could not be loaded.");}}}this.Commands=[];return true;};window.ComponentArt_SchedulerStorageCommand=function(type,ID,_142){this.Type=type;if(_142){this.RecurringAppointmentID=ID;}else{this.AppointmentID=ID;}this.Arguments={};};ComponentArt_SchedulerStorageCommand.prototype.get_appointmentID=function(){return this.AppointmentID;};ComponentArt_Scheduler.prototype.getCommandsXml=function(){var sb=[];sb.push("<Commands>");for(var i=0;i<this.Commands.length;i++){var _145=this.Commands[i];sb.push("<Command");sb.push(" Type=\"");sb.push(_145.Type);sb.push("\"");if(_145.RecurringAppointmentID){sb.push(" RecurringAppointmentID=\"");sb.push(_145.RecurringAppointmentID);sb.push("\"");}else{sb.push(" AppointmentID=\"");sb.push(_145.AppointmentID);sb.push("\"");}sb.push(">");if(_145.AppointmentXml){sb.push("<Appointment>");sb.push(_145.AppointmentXml);sb.push("</Appointment>");}if(_145.AppointmentBeforeXml){sb.push("<AppointmentBefore>");sb.push(_145.AppointmentBeforeXml);sb.push("</AppointmentBefore>");}if(_145.AppointmentAfterXml){sb.push("<AppointmentAfter>");sb.push(_145.AppointmentAfterXml);sb.push("</AppointmentAfter>");}if(_145.RecurringAppointmentXml){sb.push("<RecurringAppointment>");sb.push(_145.RecurringAppointmentXml);sb.push("</RecurringAppointment>");}if(_145.RecurringAppointmentBeforeXml){sb.push("<RecurringAppointmentBefore>");sb.push(_145.RecurringAppointmentBeforeXml);sb.push("</RecurringAppointmentBefore>");}if(_145.RecurringAppointmentAfterXml){sb.push("<RecurringAppointmentAfter>");sb.push(_145.RecurringAppointmentAfterXml);sb.push("</RecurringAppointmentAfter>");}sb.push("<Arguments>");for(var _146 in _145.Arguments){if(_145.Arguments.hasOwnProperty(_146)){sb.push("<Argument>");sb.push("<Name>");sb.push(_146);sb.push("</Name>");sb.push("<Value>");sb.push(_145.Arguments[_146]);sb.push("</Value>");sb.push("</Argument>");}}sb.push("</Arguments>");sb.push("</Command>");}sb.push("</Commands>");return sb.join("");};ComponentArt_Scheduler.prototype.getAppointmentXml=function(_147){var sb=[];sb.push("<Appointment");sb.push(">");sb.push("<Properties>");for(var _149 in _147.Properties){if(_147.Properties.hasOwnProperty(_149)){sb.push("<Property>");sb.push("<Name>");sb.push(_149);sb.push("</Name>");sb.push("<Value>");switch(_149){case "Start":sb.push((new DateTimeFormatter()).toString(_147.Properties[_149],"yyyyMMddHHmmss"));break;default:sb.push(_147.Properties[_149]);break;}sb.push("</Value>");sb.push("</Property>");}}sb.push("</Properties>");sb.push("</Appointment>");return sb.join("");};ComponentArt_Scheduler.prototype.getAppointmentsXml=function(){var sb=[];sb.push("<Appointments>");for(var i=0;i<this.Appointments.length;i++){sb.push(this.getAppointmentXml(this.Appointments[i]));}sb.push("</Appointments>");return sb.join("");};ComponentArt_Scheduler.prototype.getRecurringAppointmentXml=function(_14c){var sb=[];sb.push("<RecurringAppointment>");sb.push("<Properties>");for(var _14e in _14c.Properties){if(_14c.Properties.hasOwnProperty(_14e)){sb.push("<Property>");sb.push("<Name>");sb.push(_14e);sb.push("</Name>");sb.push("<Value>");switch(_14e){case "Appointment":sb.push(this.getAppointmentXml(_14c.Properties[_14e]));break;case "Range":sb.push(this.getPeriodXml(_14c.Properties[_14e]));break;case "Pattern":sb.push(this.getRecurrencePatternXml(_14c.Properties[_14e]));break;default:sb.push(_14c.Properties[_14e]);break;}sb.push("</Value>");sb.push("</Property>");}}sb.push("</Properties>");sb.push("</RecurringAppointment>");return sb.join("");};ComponentArt_Scheduler.prototype.getPeriodXml=function(_14f){var sb=[];sb.push("<Period>");sb.push("<Properties>");sb.push("<Property>");sb.push("<Name>StartDateTime</Name>");sb.push("<Value>");sb.push((new DateTimeFormatter()).toString(_14f.get_startDateTime(),"yyyyMMddHHmmss"));sb.push("</Value>");sb.push("</Property>");sb.push("<Property>");sb.push("<Name>Duration</Name>");sb.push("<Value>");sb.push(_14f.get_duration());sb.push("</Value>");sb.push("</Property>");sb.push("</Properties>");sb.push("</Period>");return sb.join("");};ComponentArt_Scheduler.prototype.getRecurrencePatternXml=function(_151){var sb=[];sb.push("<RecurrencePattern>");sb.push("<Properties>");for(var _153 in _151.Properties){if(_151.Properties.hasOwnProperty(_153)){sb.push("<Property>");sb.push("<Name>");sb.push(_153);sb.push("</Name>");sb.push("<Value>");switch(_153){case "DaysOfWeek":for(var i=0;i<_151.Properties[_153].length;i++){sb.push("<Day>");sb.push(""+_151.Properties[_153][i]);sb.push("</Day>");}break;default:sb.push(_151.Properties[_153]);break;}sb.push("</Value>");sb.push("</Property>");}}sb.push("</Properties>");sb.push("</RecurrencePattern>");return sb.join("");};ComponentArt_Scheduler.prototype.getRecurringAppointmentsXml=function(){var sb=[];sb.push("<RecurringAppointments>");for(var i=0;i<this.RecurringAppointments.length;i++){sb.push(this.getRecurringAppointmentXml(this.RecurringAppointments[i]));}sb.push("</RecurringAppointments>");return sb.join("");};ComponentArt_Scheduler.prototype.Initialize=function(){this.AppointmentsDownloaded();_z132(this);if(this.SoaService){this.WebService=this.SoaService;this.WebServiceGetAppointmentsMethod="GetAppointments";this.WebServiceAppointmentModifyMethod="AppointmentModified";this.WebServiceAppointmentAddMethod="AppointmentAdded";this.WebServiceAppointmentRemoveMethod="AppointmentRemoved";this.WebServiceRecurringAppointmentModifyMethod="RecurringAppointmentModified";this.WebServiceRecurringAppointmentAddMethod="RecurringAppointmentAdded";this.WebServiceRecurringAppointmentRemoveMethod="RecurringAppointmentRemoved";}if(this.get_events().getHandler("load")){setTimeout(this.ClientControlId+".get_events().getHandler('load')("+this.ClientControlId+", Sys.EventArgs.Empty)",1);}if(this.RunningMode==cart_SchedulerUpdateMode_WebService||this.SoaService){this.WebServiceGetAppointments();}};ComponentArt_Scheduler.prototype.getAppointmentsForPeriod=function(_157){if(this.RecurringAppointments){this.createRecurringAppointmentInstances(_157);}return this.Appointments;};ComponentArt_Scheduler.prototype.PopulateViewAppointments=function(_158){var view=window[_158];if(view&&view.populateAppointments&&view.populateAppointments(this.getAppointmentsForPeriod(view.get_period()))){this.PopulatedViews[_158]=true;}else{this.PopulatedViews[_158]=false;}};ComponentArt_Scheduler.prototype.AppointmentsDownloaded=function(){this.PopulatedViews={};for(var i=0;i<this.ViewIDs.length;i++){this.PopulateViewAppointments(this.ViewIDs[i]);}};ComponentArt_Scheduler.prototype.UpdateFormFields=function(){document.getElementById(this.Id+"_commands").value=window.encodeURIComponent(this.getCommandsXml());document.getElementById(this.Id+"_appointments").value=window.encodeURIComponent("<data>"+this.getAppointmentsXml()+this.getRecurringAppointmentsXml()+"</data>");};ComponentArt_Scheduler.prototype.render=function(){this.UpdateFormFields();};ComponentArt_Scheduler.prototype.createAppointmentCopy=function(_15b){var _15c=new ComponentArt_SchedulerAppointment();this.copyAppointment(_15b,_15c);return _15c;};ComponentArt_Scheduler.prototype.copyAppointment=function(_15d,_15e){_15e.Properties={};for(var _15f in _15d.Properties){_15e.Properties[_15f]=_15d.Properties[_15f];}};ComponentArt_Scheduler.prototype.createRecurringAppointmentCopy=function(_160){var _161=new ComponentArt_SchedulerRecurringAppointment();this.copyRecurringAppointment(_160,_161);return _161;};ComponentArt_Scheduler.prototype.copyRecurringAppointment=function(_162,_163){_163.Properties={};for(var _164 in _162.Properties){_163.Properties[_164]=_162.Properties[_164];}var _165=new ComponentArt_SchedulerRecurrencePattern();for(var _164 in _162.get_pattern().Properties){_165.Properties[_164]=_162.get_pattern().Properties[_164];}_163.set_pattern(_165);var _166=new ComponentArt_Period();_166.set_duration(_162.get_range().get_duration());_166.set_startDateTime(_162.get_range().get_startDateTime());_163.set_range(_166);var _167=this.createAppointmentCopy(_162.get_appointment());_163.set_appointment(_167);};ComponentArt_Scheduler.prototype.AddCommand=function(_168){if(this.get_updateInProgress()){return false;}this.Commands.push(_168);this.UpdateFormFields();this.AppointmentsDownloaded();this.set_updateNeeded(true);return true;};ComponentArt_Scheduler.prototype.RemoveCommand=function(){this.Commands.pop();this.UpdateFormFields();};ComponentArt_Scheduler.prototype.addAppointment=function(_169,_16a){var _16b=new ComponentArt_SchedulerStorageCommand("add",_169.get_appointmentID());if(typeof _16a!="undefined"){for(var _16c in _16a){if(_16a.hasOwnProperty(_16c)){var _16d=_16a[_16c];_169.SetProperty(_16c,_16d);_16b.Arguments[_16c]=ComponentArt_SerializeObject(_16d);}}}else{for(var _16c in _169.Properties){if(_169.Properties.hasOwnProperty(_16c)){var _16d=_169.Properties[_16c];_16b.Arguments[_16c]=ComponentArt_SerializeObject(_16d);}}}_169.set_parent(this);if(this.get_autoUpdateMode()==cart_SchedulerUpdateMode_WebService&&this.get_autoUpdate()){this.WebServiceAddAppointment(_169);}else{this.Appointments.push(_169);_16b.AppointmentXml=this.getAppointmentXml(_169);this.AddCommand(_16b);}};ComponentArt_Scheduler.prototype.modifyAppointment=function(_16e,_16f){var _170=new ComponentArt_SchedulerAppointment();_170.Properties={};for(var _171 in _16e.Properties){_170.Properties[_171]=_16e.Properties[_171];}for(var _172 in _16f){if(_16f.hasOwnProperty(_172)){var _173=_16f[_172];_16e.SetProperty(_172,_173);}}var _174=this.get_events().getHandler("appointmentBeforeModify");var _175=false;if(_174){var _176=new ComponentArt.Web.UI.SchedulerAppointmentBeforeModifyEventArgs(_170,_16e);_174(this,_176);if(_176.get_cancel()){return false;}}if(this.get_autoUpdateMode()==cart_SchedulerUpdateMode_WebService&&this.get_autoUpdate()){this.WebServiceModifyAppointment(_170);}else{var _177=new ComponentArt_SchedulerStorageCommand("modify",_16e.get_appointmentID());_177.AppointmentBeforeXml=this.getAppointmentXml(_16e);for(var _172 in _16f){if(_16f.hasOwnProperty(_172)){var _173=_16f[_172];_16e.SetProperty(_172,_173);_177.Arguments[_172]=ComponentArt_SerializeObject(_173);}}_177.AppointmentAfterXml=this.getAppointmentXml(_16e);this.AddCommand(_177);}var _174=this.get_events().getHandler("appointmentModify");var _175=false;if(_174){var _176=new ComponentArt.Web.UI.SchedulerAppointmentModifyEventArgs(_170,_16e);_174(this,_176);}return true;};ComponentArt_Scheduler.prototype.removeAppointment=function(_178,_179){_179=(typeof _179=="undefined")?true:_179;var _17a=this.get_events().getHandler("appointmentBeforeRemove");var _17b=false;if(_17a&&_179){var _17c=new ComponentArt.Web.UI.SchedulerAppointmentBeforeRemoveEventArgs(_178);_17a(this,_17c);if(_17c.get_cancel()){return false;}}if(this.get_autoUpdateMode()==cart_SchedulerUpdateMode_WebService&&this.get_autoUpdate()){this.WebServiceRemoveAppointment(_178);}else{var _17d=_178.get_appointmentID();var _17e=false;for(var i=0;i<this.Appointments.length;i++){if(this.Appointments[i].get_appointmentID()==_17d){this.Appointments.splice(i,1);_17e=true;}}if(!_17e){return false;}var _180=new ComponentArt_SchedulerStorageCommand("remove",_17d);_180.AppointmentXml=this.getAppointmentXml(_178);this.AddCommand(_180);}var _17a=this.get_events().getHandler("appointmentRemove");var _17b=false;if(_17a&&_179){var _17c=new ComponentArt.Web.UI.SchedulerAppointmentEventArgs(_178);_17a(this,_17c);}};ComponentArt_Scheduler.prototype.findAppointmentById=function(_181){for(var i=0;i<this.Appointments.length;i++){if(this.Appointments[i].get_appointmentID()==_181){return this.Appointments[i];}}return null;};ComponentArt_Scheduler.prototype.getAppointments=function(){return this.Appointments;};ComponentArt_Scheduler.prototype.addRecurringAppointment=function(_183){var _184=_183.getFirstOccurrenceDate();if(!_184&&_183.get_range()&&_183.get_range().get_startDateTime()){_184=_183.get_range().get_startDateTime();}else{_183.get_range().set_startDateTime(_184);}_183.get_appointment().set_start(_184);if(_183.get_occurrences()&&_183.get_occurrences()>0){var _185=_183.getDateAfterOccurrences(_184,_183.get_occurrences());_183.get_range().set_endDateTime(_185);}var _186=new ComponentArt_SchedulerStorageCommand("addRecurring",null,true);_183.set_parent(this);if(this.get_autoUpdateMode()==cart_SchedulerUpdateMode_WebService&&this.get_autoUpdate()){this.WebServiceAddRecurringAppointment(_183);}else{this.RecurringAppointments.push(_183);_186.RecurringAppointmentXml=this.getRecurringAppointmentXml(_183);this.AddCommand(_186);}};ComponentArt_Scheduler.prototype.modifyRecurringAppointment=function(_187){var _188=_187.getFirstOccurrenceDate();if(!_188&&_187.get_range()&&_187.get_range().get_startDateTime()){_188=_187.get_range().get_startDateTime();}else{_187.get_range().set_startDateTime(_188);}_187.get_appointment().set_start(_188);if(_187.get_occurrences()&&_187.get_occurrences()>0){var _189=_187.getDateAfterOccurrences(_188,_187.get_occurrences());_187.get_range().set_endDateTime(_189);}var _18a=this.findRecurringAppointmentById(_187.get_id());_18a.set_parent(this);var _18b=new ComponentArt_SchedulerRecurringAppointment();this.copyRecurringAppointment(_187,_18b);for(var i=0;i<this.RecurringAppointments.length;i++){if(this.RecurringAppointments[i].get_id()==_187.get_id()){this.RecurringAppointments[i]=_18b;}}_18b.set_parent(this);_18b.get_appointment().set_instance(false);if(this.get_autoUpdateMode()==cart_SchedulerUpdateMode_WebService&&this.get_autoUpdate()){this.WebServiceModifyRecurringAppointment(_18a);}else{var _18d=new ComponentArt_SchedulerStorageCommand("modifyRecurring",_187.get_id(),true);_18d.RecurringAppointmentBeforeXml=this.getRecurringAppointmentXml(_18a);_18d.RecurringAppointmentAfterXml=this.getRecurringAppointmentXml(_18b);this.AddCommand(_18d);}};ComponentArt_Scheduler.prototype.removeRecurringAppointment=function(_18e){if(this.get_autoUpdateMode()==cart_SchedulerUpdateMode_WebService&&this.get_autoUpdate()){this.WebServiceRemoveRecurringAppointment(_18e);}else{var id=_18e.get_id();var _190=false;for(var i=0;i<this.RecurringAppointments.length;i++){if(this.RecurringAppointments[i].get_id()==id){this.RecurringAppointments.splice(i,1);_190=true;}}if(!_190){return false;}var _192=new ComponentArt_SchedulerStorageCommand("removeRecurring",id,true);_192.RecurringAppointmentXml=this.getRecurringAppointmentXml(_18e);this.AddCommand(_192);}};ComponentArt_Scheduler.prototype.findRecurringAppointmentById=function(id){for(var i=0;i<this.RecurringAppointments.length;i++){if(this.RecurringAppointments[i].get_id()==id){return this.RecurringAppointments[i];}}return null;};ComponentArt_Scheduler.prototype.getRecurringAppointments=function(){return this.RecurringAppointments;};window.cart_scheduler_utils_loaded=true;}