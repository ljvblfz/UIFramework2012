if(!window.ComponentArt_Upload_Loaded){ComponentArt.Web.UI.UploadFileChangeEventArgs=function(_1,_2){if(window.ComponentArt_Atlas){ComponentArt.Web.UI.UploadFileChangeEventArgs.initializeBase(this);}var _3=_2;var _4=_1;this.get_index=function(){return _3;};this.get_fileName=function(){return _4;};};ComponentArt.Web.UI.UploadErrorEventArgs=function(_5){if(window.ComponentArt_Atlas){ComponentArt.Web.UI.UploadErrorEventArgs.initializeBase(this);}var _6=_5;this.get_message=function(){return _6;};};if(window.ComponentArt_Atlas){ComponentArt.Web.UI.UploadFileChangeEventArgs.registerClass("ComponentArt.Web.UI.UploadFileChangeEventArgs",Sys.EventArgs);ComponentArt.Web.UI.UploadErrorEventArgs.registerClass("ComponentArt.Web.UI.UploadErrorEventArgs",Sys.EventArgs);}window.ComponentArt_Upload=function(id){this.Id=id;this.element=this.DomElement=document.getElementById(id);if(window.ComponentArt_Atlas){ComponentArt.Web.UI.Upload.initializeBase(this,[this.element]);this.getDescriptor=function(){return _zF0(this.constructor);};this.dispose=function(){ComponentArt.Web.UI.Upload.callBaseMethod(this,"dispose");this.Dispose();};}};ComponentArt_Upload.prototype.PublicProperties=[["CallbackParameter"],["FileCount"],["Id"],["Uploading",1]];ComponentArt_Upload.prototype.PublicMethods=[["Abort"],["AddFile"],["ClearFiles"],["Dispose"],["GetFiles"],["RemoveFileAt"],["Upload"]];ComponentArt_Upload.prototype.PublicEvents=[["FileChange"],["Load"],["UploadBegin"],["UploadError"],["UploadEnd"]];_zEF(ComponentArt_Upload,"this");window.ComponentArt.Web.UI.Upload=window.ComponentArt_Upload;if(window.ComponentArt_Atlas){ComponentArt.Web.UI.Upload.registerClass("ComponentArt.Web.UI.Upload",Sys.UI.Control);if(Sys.TypeDescriptor){Sys.TypeDescriptor.addType("componentArtWebUI","upload",ComponentArt.Web.UI.Upload);}}ComponentArt_Upload.prototype.GetProperty=function(_8){return this[_8];};ComponentArt_Upload.prototype.SetProperty=function(_9,_a){this[_9]=_a;};ComponentArt_Upload.prototype.BeginProgress=function(){var _b=this.get_events().getHandler("uploadBegin");if(_b){_b(this,Sys.EventArgs.Empty);}this.UpdateProgress({"ReceivedBytes":0,"TotalBytes":0,"CurrentFile":"","Progress":0,"ElapsedTime":0,"RemainingTime":0,"Speed":0,"UploadActive":true});this.CheckProgress();};ComponentArt_Upload.prototype.AddFile=function(_c){if(this.FileCount<this.MaximumFileCount){if(this.FileInputClientTemplateId){var _d=this.FileInputFields[this.FileInputFields.length]=document.createElement("input");_d.type="file";_d.id=_d.name=this.Id+"_FileInput"+this.FileInputIndex;_d.style.position="absolute";var _e=function(){arguments.callee.Upload.FileChange(arguments.callee.FileInputIndex);};_e.Upload=this;_e.FileInputIndex=this.FileInputIndex;_d.onchange=_e;var _e=function(e,o){arguments.callee.Upload.FloaterMouseOver(e,o,arguments.callee.FileInputIndex);};_e.Upload=this;_e.FileInputIndex=this.FileInputIndex;_d.onmousemove=_d.onmouseover=_e;var _e=function(e,o){arguments.callee.Upload.FloaterMouseOut(e,o,arguments.callee.FileInputIndex);};_e.Upload=this;_e.FileInputIndex=this.FileInputIndex;_d.onmouseout=_e;if(cart_browser_ie){_d.style.filter="alpha(opacity=0)";}else{_d.style.opacity=0;_d.style.setProperty("-moz-opacity",0,"");}this.Form.insertBefore(_d,this.Form.firstChild);}else{}this.FileInputIndex++;this.FileCount++;if(!_c){this.Render();}}};ComponentArt_Upload.prototype.ClearFiles=function(){var _13=this.GetFileInputs();for(var i=0;i<_13.length;i++){_zF3(_13[i]);}this.FileInputFields=[];this.FileCount=0;this.Render();};ComponentArt_Upload.prototype.Abort=function(){if(!this.Uploading){return;}clearTimeout(this.ProgressTimeout);this.UploadComplete(true);};ComponentArt_Upload.prototype.Callback=function(_15){var url=location.href;url+=url.indexOf("?")>0?"&":"?";url+="CartUploadId="+this.UploadId+"&r="+Math.random()+"&Cart_"+this.Id+"_Callback=yes";if(this.CallbackParameter){url+="&Cart_"+this.Id+"_CallbackParameter="+encodeURIComponent(this.CallbackParameter);}var _17=_15;var _18=this;var _19=false;var _1a;function _z19F(){if(_1a.readyState&&_1a.readyState!=4&&_1a.readyState!="complete"){return;}var _1b=_19?_1a.responseXML:_1a;if(_1b&&_1b.documentElement&&_1b.documentElement.nodeName=="UploadCallbackSuccess"){_18.UploadId=_1b.documentElement.firstChild.nodeValue;}else{if(!_17){var _1c=_18.get_events().getHandler("uploadError");if(_1c){_1c(_18,new ComponentArt.Web.UI.UploadErrorEventArgs("Unknown callback error."));}else{if(_1a.status&&_1a.status!=200&&_1a.responseText){document.body.innerHTML=_1a.responseText;}else{alert("Unknown callback error.");}}}}}if(window.XMLHttpRequest){_19=true;var _1a=new XMLHttpRequest();_1a.onreadystatechange=_z19F;_1a.open("GET",url,true);_1a.send(null);}else{if(document.implementation&&document.implementation.createDocument){_1a=document.implementation.createDocument("","",null);_1a.onload=_z19F;}else{if(cart_browser_ie){var _1d=this.Id+"_island";var _1e=document.getElementById(_1d);if(!_1e){_1e=document.createElement("xml");_1e.id=_1d;document.body.appendChild(_1e);}if(_1e.XMLDocument){_1a=_1e.XMLDocument;_1a.onreadystatechange=_z19F;}else{return false;}}else{return false;}}}if(!_19){_1a.async=true;try{_1a.load(url);}catch(ex){_18.UploadError("Callback error: "+(ex.message?ex.message:ex));}}return true;};ComponentArt_Upload.prototype.HideInputs=function(){var _1f=this.GetFileInputs();for(var i=0;i<_1f.length;i++){_1f[i].style.top="-1000px";_1f[i].style.left="-1000px";}};ComponentArt_Upload.prototype.Dispose=function(){if(window.ComponentArt_Atlas){this.element.control=null;}ComponentArt_Dispose(this);var _21=this.GetFileInputs();for(var i=0;i<_21.length;i++){_zF3(_21[i]);}};ComponentArt_Upload.prototype.GetFileInputs=function(){var _23=[];var _24=this.Form.getElementsByTagName("input");for(var i=0;i<_24.length;i++){if(_24[i].type=="file"&&_24[i].id&&_24[i].id.indexOf(this.Id+"_FileInput")==0){_23[_23.length]=_24[i];}}return _23;};ComponentArt_Upload.prototype.GetFiles=function(){var _26=[];var _27=this.GetFileInputs();for(var i=0;i<_27.length;i++){if(_27[i].value){_26[_26.length]=_27[i].value;}}return _26;};ComponentArt_Upload.prototype.UpdateProgress=function(_29){if(!this.ProgressElement){if(this.ProgressDomElementId){this.ProgressElement=document.getElementById(this.ProgressDomElementId);}else{var _2a=document.createElement("div");_2a.style.position="absolute";_2a.style.display="none";_2a.style.left=_z86(this.element)+this.ProgressPopupOffsetX+"px";_2a.style.top=_z87(this.element)+this.ProgressPopupOffsetY+"px";_2a.style.zIndex=90211;document.body.insertBefore(_2a,document.body.firstChild);this.ProgressElement=_2a;}}if(this.ProgressElement){this.ProgressElement.innerHTML=this.GetTemplatedContent(this.ProgressClientTemplateId,this,_29);this.ProgressElement.style.display="";}};ComponentArt_Upload.prototype.CheckProgress=function(){if(this.CallingBack){return false;}var url="ComponentArtUploadProgress.axd?CartUploadId="+this.UploadId+"&r="+Math.random();var _2c=this;var _2d=false;var _2e;function _z19F(){if(_2e.readyState&&_2e.readyState!=4&&_2e.readyState!="complete"){return;}var _2f=_2d?_2e.responseXML:_2e;if(_2f&&_2f.documentElement&&_2f.documentElement.firstChild){var _30=_2f.documentElement.firstChild;if(_2f.documentElement.nodeName=="UploadError"){var _31=_30.nodeValue;_2c.UploadError(_31);}else{var _32=_30.nodeValue;eval(_32);if(UploadProgressData){_2c.UploadProgressData=UploadProgressData;_2c.UpdateProgress(UploadProgressData);if(UploadProgressData.Progress==1){_2c.UploadComplete();}else{if(_2c.Uploading){_2c.ProgressTimeout=setTimeout(_2c.Id+".CheckProgress()",_2c.ProgressUpdateInterval);}}}else{_2c.UploadError("Invalid status data received from server.");}}}else{if(_2c.Uploading){_2c.UploadError("Error loading progress data.");}}}if(window.XMLHttpRequest){_2d=true;var _2e=new XMLHttpRequest();_2e.onreadystatechange=_z19F;_2e.open("GET",url,true);_2e.send(null);}else{if(document.implementation&&document.implementation.createDocument){_2e=document.implementation.createDocument("","",null);_2e.onload=_z19F;}else{if(cart_browser_ie){var _33=this.Id+"_island";var _34=document.getElementById(_33);if(!_34){_34=document.createElement("xml");_34.id=_33;document.body.appendChild(_34);}if(_34.XMLDocument){_2e=_34.XMLDocument;_2e.onreadystatechange=_z19F;}else{return false;}}else{return false;}}}if(!_2d){_2e.async=true;try{_2e.load(url);}catch(ex){_2c.UploadError("Error loading progress data: "+(ex.message?ex.message:ex));}}return true;};ComponentArt_Upload.prototype.EndProgress=function(){if(!this.ProgressDomElementId){_zF3(this.ProgressElement);}else{if(this.UploadCompleteClientTemplateId){this.ProgressElement.innerHTML=this.GetTemplatedContent(this.UploadCompleteClientTemplateId,this,this.UploadProgressData);}}this.ProgressElement=null;var _35=this.get_events().getHandler("uploadEnd");if(_35){_35(this,Sys.EventArgs.Empty);}};ComponentArt_Upload.prototype.FileChange=function(i){var _37=this.get_events().getHandler("fileChange");if(_37){var _38=document.getElementById(this.Id+"_FileInput"+i);_37(this,new ComponentArt.Web.UI.UploadFileChangeEventArgs(_38?_38.value:"",i));}this.Render();};ComponentArt_Upload.prototype.FloaterMouseOver=function(e,o,i){var _3c=document.getElementById(this.Id+"_FileInputImage"+i);if(_3c){var _3d=cart_browser_ie?event.clientX+(document.documentElement&&document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft):e.pageX;var _3e=cart_browser_ie?event.clientY+(document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop):e.pageY;if(this.FileInputFields&&this.FileInputFields[i]&&!ComponentArt_IsOver(_3c,_3d,_3e)){this.FileInputFields[i].style.top=_3e+10+"px";this.FileInputFields[i].style.left=_3d+10+"px";this.FileInputFields[i].blur();}else{if(this.FileInputHoverImageUrl){_3c.src=this.FileInputHoverImageUrl;}}}};ComponentArt_Upload.prototype.FloaterMouseOut=function(e,o,i){if(this.FileInputHoverImageUrl){var _42=document.getElementById(this.Id+"_FileInputImage"+i);if(_42){try{if(!e&&cart_browser_ie){e=window.event;}if(ComponentArt_ToElement(e)==_42){return;}}catch(ex){}_42.src=this.FileInputImageUrl;if(this.FileInputFields&&this.FileInputFields[i]){this.FileInputFields[i].style.top="-1000px";this.FileInputFields[i].style.left="-1000px";}}}};ComponentArt_Upload.prototype.GetClientTemplate=function(sID){if(this.ClientTemplates){for(var i=0;i<this.ClientTemplates.length;i++){if(this.ClientTemplates[i][0]==sID){return this.ClientTemplates[i][1];}}}return null;};ComponentArt_Upload.prototype.GetTemplatedContent=function(_45,_46,_47){var _48=this.GetClientTemplate(_45);if(_48){return ComponentArt_InstantiateClientTemplate(_48,_46,_47);}else{return ("Template not found: "+_45);}};ComponentArt_Upload.prototype.InitFileInputs=function(){this.FileCount=0;this.FileInputIndex=0;this.FileInputFields=[];for(var i=0;i<this.InitialFileCount;i++){this.AddFile(true);}};ComponentArt_Upload.prototype.Initialize=function(){_z132(this);ComponentArt_ClientStateControls[ComponentArt_ClientStateControls.length]=this;var _4a=this.get_events().getHandler("load");if(_4a){_4a(this,Sys.EventArgs.Empty);}this.Form=document.forms[0];this.OriginalFormTarget=this.Form.target;this.OriginalFormAction=this.Form.action;this.OriginalFormEncoding=this.Form.enctype?this.Form.enctype:this.Form.encoding;this.InitFileInputs();this.Render();};ComponentArt_Upload.prototype.RemoveFileAt=function(_4b){if(_4b>=0&&this.FileInputFields[_4b]){_zF3(this.FileInputFields[_4b]);for(var i=_4b;i<this.FileInputFields.length-1;i++){this.FileInputFields[i]=this.FileInputFields[i+1];}this.FileInputFields.length--;this.FileCount--;}this.Render();};ComponentArt_Upload.prototype.Render=function(){if(this.StaticContent){return;}var _4d=document.getElementById(this.Id);var _4e=[];for(var i=0;i<Math.min(this.FileCount,this.MaximumFileCount);i++){if(this.FileInputClientTemplateId){var _50={"FileIndex":i,"FileName":""};if(this.FileInputFields[i]){_50.FileName=this.FileInputFields[i].value;}var _51=this.GetTemplatedContent(this.FileInputClientTemplateId,this,_50);if(this.FileInputImageUrl){var _52="#$FileInputImage";var _53=[];_53[_53.length]="<img id=\""+this.Id+"_FileInputImage"+i+"\" src=\""+this.FileInputImageUrl+"\"";_53[_53.length]=" onmousemove=\""+this.Id+".RepositionFloater(event,this,"+i+")\"";_53[_53.length]=" />";_51=_51.replace(_52,_53.join(""));}_4e[_4e.length]=_51;}else{_4e[_4e.length]="<input type=\"file\" id=\""+this.Id+"_FileInput"+i+"\" name=\""+this.Id+"_FileInput"+i+"\"";_4e[_4e.length]=" onchange=\""+this.Id+".FileChange("+i+")\"";_4e[_4e.length]=" /><br/>";this.StaticContent=true;}}_4d.innerHTML=_4e.join("");};ComponentArt_Upload.prototype.RepositionFloater=function(e,o,i){if(this.Uploading){return;}var x=cart_browser_ie?event.clientX+(document.documentElement&&document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft):e.pageX;var y=cart_browser_ie?event.clientY+(document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop):e.pageY;if(this.FileInputFields&&this.FileInputFields[i]){if(this.element){this.FileInputFields[i].style.zIndex=90230;}else{this.FileInputFields[i].style.zIndex=90230;}this.FileInputFields[i].style.top=y-Math.round(this.FileInputFields[i].offsetHeight)+10+"px";this.FileInputFields[i].style.left=x-Math.round(this.FileInputFields[i].offsetWidth)+10+"px";}};ComponentArt_Upload.prototype.RestoreForm=function(){this.Form.target=this.OriginalFormTarget;this.Form.action=this.OriginalFormAction;this.Form.enctype=this.Form.encoding=this.OriginalFormEncoding;};ComponentArt_Upload.prototype.SaveData=function(){if(this.PostingBack||this.GetFiles().length==0){return;}setTimeout(this.Id+".BeginProgress()",10);this.Form.enctype=this.Form.encoding="multipart/form-data";this.Form.action+=(this.Form.action.indexOf("?")>0?"&":"?")+"CartUploadId="+this.UploadId;if(cart_browser_safari||cart_browser_chrome){this.Form.target=this.Id+"_iframe";var _59=document.getElementById(this.Form.target);if(!_59){_59=document.createElement("iframe");_59.id=this.Form.target;_59.name=this.Form.target;_59.src="about:blank";_59.style.position="absolute";_59.style.display="none";_59.style.height="0px";_59.style.width="0px";document.body.appendChild(_59);}}this.Uploading=true;this.HideInputs();};ComponentArt_Upload.prototype.DisableOtherInputs=function(){var _5a=this.Form.getElementsByTagName("input");for(var i=0;i<_5a.length;i++){if(_5a[i].type=="file"&&!_5a[i].disabled&&!(_5a[i].id&&_5a[i].id.indexOf(this.Id+"_FileInput")==0)){_5a[i].disabled=true;_5a[i].disabledByCA=true;}}};ComponentArt_Upload.prototype.EnableOtherInputs=function(){var _5c=this.Form.getElementsByTagName("input");for(var i=0;i<_5c.length;i++){if(_5c[i].type=="file"&&_5c[i].disabledByCA){_5c[i].disabled=false;_5c[i].disabledByCA=false;}}};ComponentArt_Upload.prototype.Upload=function(){if(this.GetFiles().length>0){this.SaveData();this.DisableOtherInputs();this.Form.submit();this.EnableOtherInputs();}};ComponentArt_Upload.prototype.UploadComplete=function(_5e){if(window.stop){window.stop();}else{try{document.execCommand("Stop");}catch(ex){window.location.href=window.location.href;}}this.Uploading=false;this.EndProgress();this.RestoreForm();if(this.AutoPostBack){var _5f=this.Form.getElementsByTagName("input");for(var i=0;i<_5f.length;i++){if(_5f[i].type=="file"){_zF3(_5f[i]);}}this.PostingBack=true;this.Postback();}else{this.Callback(_5e);}};ComponentArt_Upload.prototype.UploadError=function(_61){if(window.stop){window.stop();}else{try{document.execCommand("Stop");}catch(ex){window.location.href=window.location.href;}}this.Uploading=false;var _62=this.get_events().getHandler("uploadError");if(_62){_62(this,new ComponentArt.Web.UI.UploadErrorEventArgs(_61));}else{alert("Upload error: "+_61);}if(this.UploadErrorClientTemplateId&&this.ProgressElement){this.ProgressElement.innerHTML=this.GetTemplatedContent(this.UploadErrorClientTemplateId,this,_61);}};window.ComponentArt_IsOver=function(_63,x,y){var ox=_z86(_63);var oy=_z87(_63);var ow=_63.offsetWidth;var oh=_63.offsetHeight;return (x>=ox&&x<=ox+ow&&y>=oy&&y<=oy+oh);};window.ComponentArt_Upload_Loaded=true;}