window.Swatches_Collection=function(){this.caller=null;this.bounds=[5,28,158,187];this.preset_top=28;this.standard_top=143;this.custom_top=187;this.offset_x=0;this.offset_y=0;this.width=13;this.height=13;this.selected=new Swatch(5,187,"#ff5010",true);this.highlighted=new Swatch(5,187,"#ff5010",true);this.foreground=this.selected;this.background=new Swatch(56,143,"#ffff00",true);this.preset=[new Swatch(5,28,"#ffffff"),new Swatch(22,28,"#000000"),new Swatch(39,28,"#eeece1"),new Swatch(56,28,"#1f497d"),new Swatch(73,28,"#4f81bd"),new Swatch(90,28,"#c0504d"),new Swatch(107,28,"#9bbb59"),new Swatch(124,28,"#8064a2"),new Swatch(141,28,"#4bacc6"),new Swatch(158,28,"#f79646"),new Swatch(5,46,"#f2f2f2"),new Swatch(22,46,"#7f7f7f"),new Swatch(39,46,"#ddd9c3"),new Swatch(56,46,"#c6d9f0"),new Swatch(73,46,"#dbe5f1"),new Swatch(90,46,"#f2dcdb"),new Swatch(107,46,"#ebf1dd"),new Swatch(124,46,"#e5e0ec"),new Swatch(141,46,"#dbeef3"),new Swatch(158,46,"#fdeada"),new Swatch(5,59,"#d8d8d8"),new Swatch(22,59,"#595959"),new Swatch(39,59,"#c4bd97"),new Swatch(56,59,"#8db3e2"),new Swatch(73,59,"#b8cce4"),new Swatch(90,59,"#e5b9b7"),new Swatch(107,59,"#d7e3bc"),new Swatch(124,59,"#ccc1d9"),new Swatch(141,59,"#b7dde8"),new Swatch(158,59,"#fbd5b5"),new Swatch(5,72,"#bfbfbf"),new Swatch(22,72,"#3f3f3f"),new Swatch(39,72,"#938953"),new Swatch(56,72,"#548dd4"),new Swatch(73,72,"#95b3d7"),new Swatch(90,72,"#d99694"),new Swatch(107,72,"#c3d69b"),new Swatch(124,72,"#b2a2c7"),new Swatch(141,72,"#92cddc"),new Swatch(158,72,"#fac08f"),new Swatch(5,85,"#a5a5a5"),new Swatch(22,85,"#262626"),new Swatch(39,85,"#494429"),new Swatch(56,85,"#17365d"),new Swatch(73,85,"#366092"),new Swatch(90,85,"#953734"),new Swatch(107,85,"#76923c"),new Swatch(124,85,"#5f497a"),new Swatch(141,85,"#31859b"),new Swatch(158,85,"#e36c09"),new Swatch(5,98,"#7f7f7f"),new Swatch(22,98,"#0c0c0c"),new Swatch(39,98,"#1d1b10"),new Swatch(56,98,"#0f243e"),new Swatch(73,98,"#244061"),new Swatch(90,98,"#632423"),new Swatch(107,98,"#4f6128"),new Swatch(124,98,"#3f3151"),new Swatch(141,98,"#205867"),new Swatch(158,98,"#974806")];this.standard=[new Swatch(5,143,"#c00000"),new Swatch(22,143,"#ff0000"),new Swatch(39,143,"#ffc000"),new Swatch(56,143,"#ffff00"),new Swatch(73,143,"#92d050"),new Swatch(90,143,"#00b050"),new Swatch(107,143,"#00b0f0"),new Swatch(124,143,"#0070c0"),new Swatch(141,143,"#002060"),new Swatch(158,143,"#7030a0")];this.custom=[new Swatch(5,187,"#ff5010",true),new Swatch(22,187,"",true),new Swatch(39,187,"",true),new Swatch(56,187,"",true),new Swatch(73,187,"",true),new Swatch(90,187,"",true),new Swatch(107,187,"",true),new Swatch(124,187,"",true),new Swatch(141,187,"",true),new Swatch(158,187,"",true)];};window.Swatch=function(_1,_2,_3,_4){this.X=_1;this.Y=_2;this.Color=_3;this.Custom=(_4)?true:false;};function init_swatches(){window.Swatches=new Swatches_Collection();}function color_menu_show(_5,_6){if(!window.Swatches){init_swatches();}document.getElementById(_5.ParentControlID+"_color-selected").style.backgroundPosition="-1000px -1000px";setTimeout("show_swatch_selected('"+_5.ParentControlID+"');",200);for(var i=0;i<window.Swatches.custom.length;i++){if(window.Swatches.custom[i].Color!=""){var _8=document.getElementById(_5.ParentControlID+"_custom-"+String(i));_8.style.backgroundColor=window.Swatches.custom[i].Color;_8.style.backgroundImage="none";}}}function show_swatch_selected(_9){if(window.Swatches.caller){switch(window.Swatches.caller.getProperty("EditorCommandType")){case "FormatFontColor":document.getElementById(_9+"_color-selected").style.backgroundPosition=(window.Swatches.foreground.X+window.Swatches.offset_x)+"px "+(window.Swatches.foreground.Y+window.Swatches.offset_y)+"px";break;case "FormatHighlight":document.getElementById(_9+"_color-selected").style.backgroundPosition=(window.Swatches.background.X+window.Swatches.offset_x)+"px "+(window.Swatches.background.Y+window.Swatches.offset_y)+"px";break;}}}function color_menu_hide(_a,_b){}function color_menu_select(_c,_d){if(_d.get_item().get_id()!="AddCustomColor"){return;}open_color_picker(_c.ParentEditor);}function get_swatch_coordinates(_e,_f,_10){var arr=[];for(var i=0;i<_e.length;i++){if(_f>=(_e[i].X+window.Swatches.offset_x)&&_f<=(_e[i].X+window.Swatches.offset_x)+window.Swatches.width&&_10>=(_e[i].Y+window.Swatches.offset_y)&&_10<=(_e[i].Y+window.Swatches.offset_y)+window.Swatches.height){arr[0]=_e[i].X+window.Swatches.offset_x;arr[1]=_e[i].Y+window.Swatches.offset_y;window.Swatches.highlighted=_e[i];}}return arr;}function move_swatch_highlight(el,e){var _15=get_position(el)[0];var _16=get_position(el)[1];if(!e){e=window.event;}mouse_x=e.clientX;mouse_y=e.clientY;var _17=document.documentElement.scrollLeft;var _18=document.documentElement.scrollTop;var _19=(mouse_x-_15)+window.Swatches.offset_x+_17;var _1a=(mouse_y-_16)+window.Swatches.offset_y+_18;var _1b=window.Swatches.bounds[0]+window.Swatches.offset_x;var _1c=window.Swatches.bounds[1]+window.Swatches.offset_x;var _1d=window.Swatches.bounds[2]+window.Swatches.offset_y;var _1e=window.Swatches.bounds[3]+window.Swatches.offset_y;if(_19<_1b){_19=_1b;}else{if(_19>_1d){_19=_1d;}}if(_1a<_1c){_1a=_1c;}else{if(_1a>_1e){_1a=_1e;}}if(_1a>=(window.Swatches.preset_top+window.Swatches.offset_y)&&_1a<(window.Swatches.standard_top+window.Swatches.offset_y)){var _1f=get_swatch_coordinates(window.Swatches.preset,_19,_1a);}else{if(_1a>=(window.Swatches.standard_top+window.Swatches.offset_y)&&_1a<(window.Swatches.custom_top+window.Swatches.offset_y)){var _1f=get_swatch_coordinates(window.Swatches.standard,_19,_1a);}else{if(_1a>=(window.Swatches.custom_top+window.Swatches.offset_y)&&_1a<=_1e){var _1f=get_swatch_coordinates(window.Swatches.custom,_19,_1a);}}}if(_1f.length==2){el.style.backgroundPosition=String(_1f[0])+"px "+String(_1f[1])+"px";}}function select_swatch(_20,_21){if(window.Swatches.highlighted.Color!=""){window.Swatches.selected=window.Swatches.highlighted;if(window.Swatches.caller){switch(window.Swatches.caller.getProperty("EditorCommandType")){case "FormatFontColor":window.Swatches.foreground=window.Swatches.selected;break;case "FormatHighlight":window.Swatches.background=window.Swatches.selected;break;}}}change_color(_21.ParentEditor);_21.hide();}function change_color(_22){if(!window.Swatches){init_swatches();}window.Swatches.selected=window.Swatches.highlighted;if(window.Swatches.caller){switch(window.Swatches.caller.getProperty("EditorCommandType")){case "FormatFontColor":get_font_color_button().style.backgroundColor=window.Swatches.foreground.Color;_22.SaveUndo("Font Color");_22.setStyle("color",window.Swatches.foreground.Color);break;case "FormatHighlight":get_background_color_button().style.backgroundColor=window.Swatches.background.Color;_22.SaveUndo("Background Color");_22.setStyle("background-color",window.Swatches.background.Color);break;}}}function get_empty_swatch(){var _23=0;for(var i=0;i<window.Swatches.custom.length;i++){if(window.Swatches.custom[i].Color==""){_23=i;break;}}return _23;}function open_color_picker(_25){var _26=get_empty_swatch();var _27="";_27=window.prompt("Please enter a hexidecimal color value:","#000000");window.Swatches.custom[_26].Color=_27;window.Swatches.selected=window.Swatches.custom[_26];if(window.Swatches.caller){switch(window.Swatches.caller.getProperty("EditorCommandType")){case "FormatFontColor":window.Swatches.foreground=window.Swatches.custom[_26];break;case "FormatHighlight":window.Swatches.background=window.Swatches.custom[_26];break;}}change_color(_25);}function get_font_color_button(){if(!window.font_color){var tds=document.getElementsByTagName("td");var _29=null;for(var i=0;i<tds.length;i++){if(tds[i].className.indexOf("font-color")!=-1){var _29=tds[i].getElementsByTagName("td");for(var j=0;j<_29.length;j++){if(_29[j].className=="ca_tb_img"){window.font_color=_29[j].getElementsByTagName("img")[0];break;}}break;}}}return window.font_color;}function get_background_color_button(){if(!window.background_color){var tds=document.getElementsByTagName("td");var _2d=null;for(var i=0;i<tds.length;i++){if(tds[i].className.indexOf("bg-color")!=-1){var _2d=tds[i].getElementsByTagName("td");for(var j=0;j<_2d.length;j++){if(_2d[j].className=="ca_tb_img"){window.background_color=_2d[j].getElementsByTagName("img")[0];break;}}break;}}}return window.background_color;}function font_toolbar_mouseup(_30,_31){if(!window.Swatches){init_swatches();}window.Swatches.caller=_31.get_item();}function insert_table_menu_show(_32){var _33=_32.ClientControlId;document.getElementById(_33+"_table-title").firstChild.innerHTML="Insert Table";if(!window.insert_table_dimensions){window.insert_table_dimensions=[1,1];}var _34=document.getElementById(_33+"_table-cells-events");}function insert_table_menu_hide(_35){document.getElementById(_35.ClientControlId+"_table-title").firstChild.innerHTML="Insert Table";}function mouse_over_table_cells(e,_37){window.table_cells_mouse_over=true;document.getElementById(_37+"_table-cells-highlight").style.visibility="visible";}function mouse_out_table_cells(e,_39){window.table_cells_mouse_over=false;document.getElementById(_39+"_table-cells-highlight").style.visibility="hidden";insert_table_menu_hide(window[_39]);}function track_table_cells(e,_3b){if(window.table_cells_mouse_over){var _3c=(document.all)?event.clientX+document.body.scrollLeft+document.documentElement.scrollLeft-2:e.pageX;var _3d=(document.all)?event.clientY+document.body.scrollTop+document.documentElement.scrollTop-2:e.pageY;var _3e=document.getElementById(_3b+"_table-cells-events");var _3f=get_position(_3e)[0];var _40=get_position(_3e)[1];var _41=(Math.floor((_3c-_3f)/19)+1)*19;var _42=(Math.floor((_3d-_40)/19)+1)*19;document.getElementById(_3b+"_table-title").firstChild.innerHTML=(Math.floor((_3c-_3f)/19)+1)+"x"+(Math.floor((_3d-_40)/19)+1)+" Table";document.getElementById(_3b+"_table-cells-highlight").style.width=_41+"px";document.getElementById(_3b+"_table-cells-highlight").style.height=_42+"px";window.insert_table_dimensions[0]=(Math.floor((_3c-_3f)/19)+1);window.insert_table_dimensions[1]=(Math.floor((_3d-_40)/19)+1);}}function insert_table(_43){if(!window.insert_table_dimensions){window.insert_table_dimensions=[1,1];}var _44=_43.ParentEditor;_44.SaveUndo("Insert Table");var _45=_44.document.createElement("table");_45.border="1";_45.style.borderCollapse="collapse";_45.style.width="100%";var _46=_44.document.createElement("tbody");var _47=null;for(var i=0;i<window.insert_table_dimensions[1];i++){var _49=_44.document.createElement("tr");for(var x=0;x<window.insert_table_dimensions[0];x++){var _4b=_44.document.createElement("td");_4b.innerHTML="&nbsp;";if(x==0&&i==0){_47=_4b;}_49.appendChild(_4b);}_46.appendChild(_49);}_45.appendChild(_46);ComponentArt_InsertDomElement(_44.element,_45,_47);_44.Focus();_43.Hide();}function update_symbol_title(_4c,el){document.getElementById(_4c.ClientControlId+"_symbol-title").firstChild.innerHTML=el.getAttribute("title");}function reset_symbol_title(_4e){document.getElementById(_4e.ClientControlId+"_symbol-title").firstChild.innerHTML="Insert Symbol";}function insert_symbol(_4f,_50){var _51=_4f.ParentEditor;_51.SaveUndo("Insert Symbol");var _52=_51.document.createTextNode(_50.innerHTML);ComponentArt_InsertDomElement(_51.element,_52);_4f.Hide();}function UndoMenuHtml(_53){var _54=[];var _55=_53.ParentEditor;var _56=_55.UndoStates.length;for(var i=1;i<=_56;i++){_54[_54.length]="<a href=\"javascript:void(0);\" onclick=\"";_54[_54.length]=_55.ClientControlId;_54[_54.length]=".Undo(";_54[_54.length]=i;_54[_54.length]=");";_54[_54.length]=_53.ClientControlId;_54[_54.length]=".hide();\" onmouseover=\"UndoRedoMenuOverOut(this,";_54[_54.length]=i;_54[_54.length]=");\" onmouseout=\"UndoRedoMenuOverOut(this,0)\">";_54[_54.length]=_55.UndoStates[_56-i].action;_54[_54.length]="</a>";}return _54.join("\n");}function RedoMenuHtml(_58){var _59=[];var _5a=_58.ParentEditor;var _5b=_5a.RedoStates.length;for(var i=1;i<=_5b;i++){_59[_59.length]="<a href=\"javascript:void(0);\" onclick=\"";_59[_59.length]=_5a.ClientControlId;_59[_59.length]=".Redo(";_59[_59.length]=i;_59[_59.length]=");";_59[_59.length]=_58.ClientControlId;_59[_59.length]=".hide();\" onmouseover=\"UndoRedoMenuOverOut(this,";_59[_59.length]=i;_59[_59.length]=");\" onmouseout=\"UndoRedoMenuOverOut(this,0)\">";_59[_59.length]=_5a.RedoStates[_5b-i].action;_59[_59.length]="</a>";}return _59.join("\n");}function UndoRedoMenuOverOut(_5d,_5e){var _5f=_5d.parentNode;var _60=_5f.childNodes;for(var i=0;i<_60.length;i++){_60[i].className=i<_5e?"selected":"";}}function ListMenuItemHtml(_62,_63,_64){_64-=0;var _65="<div class=\"bullets-item\" onmouseover=\"this.className='bullets-item-hover';\" onmouseout=\"this.className='bullets-item';\">";for(var i=1;i<=_64;i++){_65+="<"+_62;if(i==1){_65+=" class=\""+_63+"\"";}_65+="><li><span style=\"color:#CCCCCC\">-------------</span></li>";}for(var i=1;i<=_64;i++){_65+="</"+_62+">";}_65+="</div>";return _65;}function handleBulletsMenuItemSelect(_67,_68){var _69=_68.get_item().getProperty("ListCssClass");var _6a=_67.ParentEditor;_6a.SaveUndo("Format Bullets");if(!_6a.getTopUnorderedList()){_6a.toggleUnorderedList();}_6a.setUnorderedListCssClass(_69);}function handleNumberingMenuItemSelect(_6b,_6c){var _6d=_6c.get_item().getProperty("ListCssClass");var _6e=_6b.ParentEditor;_6e.SaveUndo("Format Numbering");if(!_6e.getTopOrderedList()){_6e.toggleOrderedList();}_6e.setOrderedListCssClass(_6d);}function toggle_hyperlink_options(el,_70){var t=el.firstChild.innerHTML.toLowerCase();switch(t){case "advanced":el.firstChild.className="basic";el.firstChild.innerHTML="Basic";change_dialog_classname("link-advanced",_70);break;case "basic":el.firstChild.className="advanced";el.firstChild.innerHTML="Advanced";change_dialog_classname("link-basic",_70);break;}}function link_type_change(_72,_73){var t=document.getElementById("link_type_other");if(_72.get_selectedIndex()==0){if(t.disabled==true){t.disabled=false;t.className="link-type-other float-left";t.focus();}}else{if(t.disabled==false){t.disabled=true;t.className="link-type-other float-left disabled";}}}function toggle_preview_button(el){var btn=el.nextSibling;if(el.value.length>0){if(btn.className=="preview-url-disabled"){btn.className="preview-url";}}else{btn.className="preview-url-disabled";}}function HyperlinkDialog_OnShow(_77,_78){var _79=_77;var _7a=_79.ParentControlID;var _7b=document.getElementById(_7a+"_link_text");_7b.value=_79.ParentEditor.get_selectionText();}function HyperlinkDialog_OnClose(_7c,_7d){var _7e=_7c;if(_7e.get_result()!=true){return;}var _7f=_7e.ParentEditor;var _80=_7e.ParentControlID;var _81=eval(_80+"_HyperlinkPages.get_selectedPage().get_id()");switch(_81){case "Link":var _82=document.getElementById(_80+"_link_url").value;var _83=eval(_80+"_LinkType.getSelectedItem()")?eval(_80+"_LinkType.getSelectedItem().get_value()"):null;var _84=eval(_80+"_LinkAnchor.getSelectedItem()")?eval(_80+"_LinkAnchor.getSelectedItem().get_value()"):null;var _85=eval(_80+"_LinkCssClass.getSelectedItem()")?eval(_80+"_LinkCssClass.getSelectedItem().get_value()"):null;if(!_83){_83=document.getElementById(_80+"_link_type_other").value;}_82=changeProtocol(_82,_83);var _86=document.getElementById(_80+"_link_text").value;var _87=document.getElementById(_80+"_link_target").value;var _88=document.getElementById(_80+"_link_tooltip").value;_7f.SaveUndo("Insert Link");_7f.InsertHyperlink(_82,_86,_87,_85,null,null,_88);break;case "Anchor":var _89=document.getElementById(_80+"_anchor_name").value;var _8a=document.getElementById(_80+"_anchor_text").value;_7f.SaveUndo("Insert Anchor");_7f.InsertHyperlink(null,_8a,null,null,null,_89);break;case "Email":var _8b=document.getElementById(_80+"_email_address").value;var _8c=document.getElementById(_80+"_email_subject").value;var _8d=document.getElementById(_80+"_email_text").value;var _8e="mailto:"+_8b+"?subject="+_8c;_7f.SaveUndo("Insert Email");_7f.InsertHyperlink(_8e,_8d);break;default:break;}}function changeProtocol(url,_90){var _91=url.lastIndexOf("://");if(_91>=0){return _90+url.substring(_91+3);}var _91=url.lastIndexOf(":");if(_91>=0){return _90+url.substring(_91+1);}return _90+url;}function check_url(el){var txt=el.previousSibling;if(txt.value.length>0){window.open(txt.value,"check_url");}}function MediaDialog_OnShow(_94,_95){}function MediaDialog_OnClose(_96,_97){var _98=_96;if(_98.get_result()!=true){return;}var _99=_98.ParentEditor;var _9a=_98.ParentControlID;switch(MediaPages.get_selectedPage().get_id()){case "Image":var _9b=document.getElementById(_9a+"_image_url");var url=_9b?_9b.value:null;var _9d=document.getElementById(_9a+"_image_desc");var _9e=_9d?_9d.value:null;var _9f=document.getElementById(_9a+"_image_width");var _a0=_9f?_9f.value:null;var _a1=document.getElementById(_9a+"_image_height");var _a2=_a1?_a1.value:null;var _a3=document.getElementById(_9a+"_image_align");var _a4=window[_9a+"_ImageAlignment"];var _a5=_a3?_a3.value:(_a4?_a4.getSelectedItem().get_text():null);var _a6=document.getElementById(_9a+"_image_border");var _a7=_a6?_a6.value:null;var _a8=document.getElementById(_9a+"_image_hspace");var _a9=_a8?_a8.value:null;var _aa=document.getElementById(_9a+"_image_vspace");var _ab=_aa?_aa.value:null;var _ac=document.getElementById(_9a+"_image_cssclass");var _ad=_ac?_ac.value:null;var _ae=document.getElementById(_9a+"_image_inline");var _af=_ae?_ae.value:null;_99.SaveUndo("Insert Image");_99.InsertImage(url,_9e,_a0,_a2,_a5,_a7,_a9,_ab,_ad,_af);break;}}function load_image(el,_b1){var url,img;for(var i=0;i<el.parentNode.getElementsByTagName("input").length;i++){if(el.parentNode.getElementsByTagName("input")[i].className=="image-url"){url=el.parentNode.getElementsByTagName("input")[i].value;break;}}if(!url){alert("Error: The URL entered is invalid. Preview loading will not continue.");return false;}var dlg,p,s,t;dlg=el.parentNode.parentNode.parentNode;for(var i=0;i<dlg.getElementsByTagName("div").length;i++){if(dlg.getElementsByTagName("div")[i].className=="image-preview"){p=dlg.getElementsByTagName("div")[i];break;}}if(!p){alert("Error: Preview container cannot be found. Preview loading will not continue.");return false;}for(var i=0;i<p.getElementsByTagName("div").length;i++){if(p.getElementsByTagName("div")[i].className.indexOf("status")!=-1){s=p.getElementsByTagName("div")[i];break;}}if(document.getElementById("image-loader")){img=document.getElementById("image-loader");document.getElementsByTagName("body")[0].removeChild(img);}img=document.createElement("img");img.id="image-loader";img.style.position="absolute";img.style.left="-999999px";img.style.top="-999999px";img.style.visibility="hidden";var _b9=function(){get_image_dimensions(arguments.callee.dialog);};_b9.dialog=_b1;if(cart_browser_ie){img.onresize=_b9;}else{img.onload=_b9;}img.onerror=load_image_error;img.src=url;document.getElementsByTagName("body")[0].appendChild(img);if(s.className.indexOf("loading")==-1){s.className+=" loading";s.innerHTML="";}}function load_image_error(e){var img=document.getElementById("image-loader");img.className="error";}function get_image_dimensions(_bc){var img=document.getElementById("image-loader");if(img.readyState=="uninitialized"){return;}var dlg=document.getElementById(_bc.ClientControlId);var p,s,t;for(var i=0;i<dlg.getElementsByTagName("div").length;i++){if(dlg.getElementsByTagName("div")[i].className=="image-preview"){p=dlg.getElementsByTagName("div")[i];}}if(!p){alert("Error: Preview container cannot be found. Preview loading will not continue.");return false;}for(var i=0;i<p.getElementsByTagName("div").length;i++){if(p.getElementsByTagName("div")[i].className.indexOf("status")!=-1){s=p.getElementsByTagName("div")[i];}else{if(p.getElementsByTagName("div")[i].className=="thumbnail"){t=p.getElementsByTagName("div")[i];}}}var _c3;if(t.getElementsByTagName("img").length==1){_c3=t.getElementsByTagName("img")[0];t.removeChild(_c3);}if(img.className!="error"){var w=img.offsetWidth;var h=img.offsetHeight;var _c6=w/h;document.getElementById(_bc.ParentControlID+"_image_width").value=String(w);document.getElementById(_bc.ParentControlID+"_image_height").value=String(h);_c3=document.createElement("img");_c3.src=img.src;_c3.style.position="absolute";var pw,ph;if(w>t.offsetWidth||h>t.offsetHeight){if(w>h){pw=t.offsetWidth;ph=Math.floor(pw/_c6);_c3.style.left="0";_c3.style.top=Math.floor((t.offsetHeight-ph)*0.5)+"px";}else{if(w<h){ph=t.offsetHeight;pw=Math.floor(_c6*ph);_c3.style.left=Math.floor((t.offsetWidth-pw)*0.5)+"px";_c3.style.top="0";}else{pw=ph=container.offsetHeight;_c3.style.left=Math.floor((t.offsetWidth-pw)*0.5)+"px";_c3.style.top="0";}}_c3.style.width=pw+"px";_c3.style.height=ph+"px";}else{_c3.style.left=Math.floor((t.offsetWidth-w)*0.5)+"px";_c3.style.top=Math.floor((t.offsetHeight-h)*0.5)+"px";}t.appendChild(_c3);if(w==0||h==0){s.innerHTML="<span class='error'>Error: Failed to load image</span>";}}else{s.innerHTML="<span class='error'>Error: Failed to load image</span>";}s.className="status";document.getElementsByTagName("body")[0].removeChild(img);}function FindDialog_OnShow(_c9){window.findIndex=0;window.replaceIndex=0;}function FindDialog_OnClose(_ca){window.findIndex=0;window.replaceIndex=0;}function FindDialog_Find(_cb){var _cc=_cb.ParentControlID;var _cd=_cb.ParentEditor.Find(document.getElementById(_cc+"_find_text").value,(document.getElementById(_cc+"_find_matchcase").className.indexOf("selected")>-1)?false:true,(document.getElementById(_cc+"_find_matchwholeword").className.indexOf("selected")>-1)?true:false,window.findIndex);if(!_cd){window.findIndex=0;alert("Find is complete!");}else{window.findIndex++;}}function FindDialog_FindReplace(_ce){var _cf=_ce.ParentControlID;var _d0=_ce.ParentEditor.Find(document.getElementById(_cf+"_replace_text").value,(document.getElementById(_cf+"_replace_matchcase").className.indexOf("selected")>-1)?false:true,(document.getElementById(_cf+"_replace_matchwholeword").className.indexOf("selected")>-1)?true:false,window.replaceIndex);if(!_d0){window.replaceIndex=0;alert("Find is complete!");}else{window.replaceIndex++;}}function FindDialog_Replace(_d1){var _d2=_d1.ParentControlID;var _d3=(window.replaceIndex>0)?window.replaceIndex-1:0;var _d4=FindDialog.ParentEditor.Replace(document.getElementById(_d2+"_replace_text").value,(document.getElementById(_d2+"_replace_matchcase").className.indexOf("selected")>-1)?false:true,(document.getElementById(_d2+"_replace_matchwholeword").className.indexOf("selected")>-1)?true:false,document.getElementById(_d2+"_replace_replacetext").value,_d3);if(!_d4){window.replaceIndex=0;alert("Replace is complete!");}else{window.replaceIndex--;}}function FindDialog_ReplaceAll(_d5){var _d6=_d5.ParentControlID;var _d7=FindDialog.ParentEditor.ReplaceAll(document.getElementById(_d6+"_replace_text").value,(document.getElementById(_d6+"_replace_matchcase").className.indexOf("selected")>-1)?false:true,(document.getElementById(_d6+"_replace_matchwholeword").className.indexOf("selected")>-1)?true:false,document.getElementById(_d6+"_replace_replacetext").value);alert("Replace is complete!");}function beginSpellCheck(){SpellChecker.DialogClose();SpellChecker.Check(null,checkHandler);}function checkHandler(_d8){var _d9=_d8.SpellCheck;if(_d9.DialogBegin()){eval(_d9.ParentControlID+"_SpellCheckDialog.Show();");}}function dialogComplete(_da){alert("Spell check is complete!");eval(_da.ParentControlID+"_SpellCheckDialog.Close();");}function updateDialog(_db){var _dc=_db.ParentControlID;var _dd=document.getElementById(_dc+"_SpellCheckDialog_Html");if(_dd){_dd.innerHTML=SpellChecker.DialogGetErrorsHtml();var _de=document.getElementById(_dc+"_Spell1_CurrentError");if(_de&&_de.scrollIntoView){_de.scrollIntoView();}}_db.DialogGetSuggestions(suggestHandler);}function suggestHandler(_df){var _e0=document.getElementById(_df.SpellCheck.ParentControlID+"_SpellCheckDialog_Suggestions");if(_e0){_e0.innerHTML="";for(var i=0;i<_df.length;i++){var _e2=document.createElement("a");_e2.innerHTML=_df[i];_e2.id=_df.SpellCheck.ParentControlID+"_SpellCheckDialog_Word_"+i;var _e3=function(){return eval(arguments.callee.code);};_e3.code="_z55("+i+","+_df.SpellCheck.ParentControlID+"_SpellChecker);";_e2.onclick=_e3;_e2.href="javascript:void(0);";_e0.appendChild(_e2);}}_z55(0,_df.SpellCheck);}function _z55(num,_e5){var el=document.getElementById(_e5.ParentControlID+"_SpellCheckDialog_Word_"+num);var _e7="";if(el){_e7=el.innerHTML;if(window.selected_word!=null){document.getElementById(window.selected_word).className="";}el.className="selected";window.selected_word=el.id;}document.getElementById(_e5.ParentControlID+"_SpellCheckDialog_Replacement").value=_e7;}function StyleDropDownItemHTML(_e8,_e9){var _ea=_e9.get_value();var _eb=_e8.Styles[_ea];var _ec="";_ec+="<span";_ec+=_eb.DropDownCssClass?" class=\""+_eb.DropDownCssClass+"\"":"";_ec+=" style=\"float:left;padding-left:40px;";_ec+=_eb.DropDownStyleString?_eb.DropDownStyleString:"";_ec+="\">";_ec+=DataItem.get_text();_ec+="</span>";return _ec;}function toggle_dialog_tab(el,_ee,_ef,_f0,_f1){var _f2=_ee.ParentControlID;if(el.className!="tab"){return false;}else{toggle_radio(el,_f0,_f1);var t=el.lastChild.innerHTML;var dlg=_ee;var d=dlg.DomElement;var c=null;var m=null;var l=null;var r=null;for(var i=0;i<d.length;i++){if(d[i].className=="dlg-content"){c=d[i].getElementsByTagName("div");for(var j=0;j<c.length;j++){if(c[j].className.indexOf("mid")!=-1){m=c[j];}else{if(c[j].className.indexOf("left")!=-1){l=c[j];}else{if(c[j].className.indexOf("right")!=-1){r=c[j];}}}}break;}}switch(t){case "Link":change_dialog_classname("link-basic",_ee);document.getElementById(_f2+"_hyperlink-options").style.display="block";document.getElementById(_f2+"_hyperlink-options").firstChild.className="advanced";document.getElementById(_f2+"_hyperlink-options").firstChild.innerHTML="Advanced";break;case "Anchor":change_dialog_classname("anchor",_ee);document.getElementById(_f2+"_hyperlink-options").style.display="none";break;case "Email":change_dialog_classname("email",_ee);document.getElementById(_f2+"_hyperlink-options").style.display="none";break;case "Image":change_dialog_classname("image",_ee);break;case "Flash":change_dialog_classname("flash",_ee);break;case "Video":change_dialog_classname("video",_ee);break;case "Find":change_dialog_classname("find",_ee);break;case "Replace":change_dialog_classname("replace",_ee);break;}var mp=window[_ee.ClientControlId.replace("Dialog","Pages")];mp.setPageIndex(_ef);}}function change_dialog_classname(css,_fe){var dlg=document.getElementById(_fe.ClientControlId);var d=dlg.getElementsByTagName("div");var c,l,m,r;var mid,left,_107;for(var i=0;i<d.length;i++){if((d[i].className=="dlg-content")||(d[i].className=="con")){if(d[i].className=="dlg-content"){mid="mid";left="left";_107="right";}if(d[i].className=="con"){mid="con-m";left="con-l";_107="con-r";}c=d[i].getElementsByTagName("div");for(var j=0;j<c.length;j++){if(c[j].className.indexOf(mid)!=-1){m=c[j];}else{if(c[j].className.indexOf(left)!=-1){l=c[j];}else{if(c[j].className.indexOf(_107)!=-1){r=c[j];}}}}break;}}m.className=mid+" "+css;l.className=left+" "+css;r.className=_107+" "+css;if(css=="link-basic"){var t=m.getElementsByTagName("input");for(var i=0;i<t.length;i++){if(t[i].className=="link-tooltip"||t[i].className.indexOf("link-anchor")!=-1||t[i].className.indexOf("link-type")!=-1||t[i].className=="link-css"){t[i].disabled=true;}}window.LinkAnchor.disable();window.LinkCssClass.disable();window.LinkType.disable();}else{if(css=="link-advanced"){var t=m.getElementsByTagName("input");for(var i=0;i<t.length;i++){if(t[i].className=="link-tooltip"||t[i].className.indexOf("link-anchor")!=-1||t[i].className==("link-type")||t[i].className=="link-css"||t[i].className=="dlg-textfield"){t[i].disabled=false;}}window.LinkAnchor.enable();window.LinkCssClass.enable();window.LinkType.enable();if(window.LinkType.get_selectedIndex()==0){var t=document.getElementById("link-type-other");t.disabled=false;t.className="link-type-other float-left";}}}}function get_position(el){var _10c=0;var _10d=0;if(el.offsetParent){_10c=el.offsetLeft;_10d=el.offsetTop;while(el=el.offsetParent){_10c+=el.offsetLeft;_10d+=el.offsetTop;}}return [_10c,_10d];}function select_statusbar_button(btn){if(btn.className=="button-selected"){return;}var p=btn.parentNode;var _110=p.getElementsByTagName("a");for(var i=0;i<_110.length;i++){_110[i].className="button";}btn.className="button-selected";}function toggle_radio(el,_113,_114){if(_113&&_114){var _115=el.className.indexOf(_113)==-1;if(_115){var p=el.parentNode;var as=p.getElementsByTagName("a");for(var i=0;i<as.length;i++){var a=as[i];a.className=a.className.replace(_113,_114);}el.className=el.className.replace(_114,_113);}}else{if(el.className.indexOf("selected")==-1){var p=el.parentNode;var a=p.getElementsByTagName("a");for(var i=0;i<a.length;i++){a[i].className=a[i].className.replace("-selected","");}el.className+="-selected";}}}function toggle_checkbox(el,_11b,_11c){if(_11b&&_11c){el.className=(el.className.indexOf(_11b)==-1)?el.className.replace(_11c,_11b):el.className.replace(_11b,_11c);}else{(el.className.indexOf("selected")==-1)?el.className=el.className.replace("checkbox","checkbox-selected"):el.className=el.className.replace("-selected","");}}function refresh_node(_11d,node){if(!node){node=_11d.get_selectedNode();}if(node){node.collapse(true);node.ClearChildren();_11d.render();node.expand(true);}}function create_folder(_11f,_120){var node=_120.get_selectedNode();if(node){var name=prompt("New folder name:");CreateFolder(node.Value+"\\"+name);}refresh_node(_120,node);}function remove_folder(_123,_124){var node=_124.get_selectedNode();if(node&&confirm("Are you sure?")){DeleteFolder(node.Value);}refresh_node(_124,node.get_parentNode());}function ImageManagerDialog_OnShow(_126,_127){}function ImageManagerDialog_OnClose(_128,_129){var _12a=_128;if(_12a.get_result()!=true){return;}var _12b=_12a.ParentEditor;var _12c=_12a.ParentControlID;_12b.SaveUndo("Insert Image");_12b.InsertImage(document.getElementById("image_url").value,document.getElementById(_12c+"_image_alt").value,document.getElementById("imageproperties_image_width").value,document.getElementById("imageproperties_image_height").value,document.getElementById(_12c+"_image_align").value,document.getElementById(_12c+"_image_border").value,document.getElementById(_12c+"_image_hspace").value,document.getElementById(_12c+"_image_vspace").value,document.getElementById(_12c+"_image_cssclass").value,null);}function im_load_image(_12d,url){if(!url){alert("Error: The URL entered is invalid. Preview loading will not continue.");return false;}var dlg,p,s,t;p=document.getElementById(_12d);if(!p){alert("Error: Preview container cannot be found. Preview loading will not continue.");return false;}for(var i=0;i<p.getElementsByTagName("div").length;i++){if(p.getElementsByTagName("div")[i].className.indexOf("status")!=-1){s=p.getElementsByTagName("div")[i];break;}}if(document.getElementById("image-loader")){img=document.getElementById("image-loader");document.getElementsByTagName("body")[0].removeChild(img);}img=document.createElement("img");img.id="image-loader";img.style.position="absolute";img.style.left="-999999px";img.style.top="-999999px";img.style.visibility="hidden";var _134=function(){im_get_image_dimensions(arguments.callee.elementid);};_134.elementid=_12d;if(cart_browser_ie){img.onresize=_134;}else{img.onload=_134;}img.onerror=load_image_error;img.src=url;document.getElementsByTagName("body")[0].appendChild(img);if(s.className.indexOf("loading")==-1){s.className+=" loading";s.innerHTML="";}}function im_get_image_dimensions(_135){var img=document.getElementById("image-loader");if(img.readyState=="uninitialized"){return;}var p,s,t;p=document.getElementById(_135);if(!p){alert("Error: Preview container cannot be found. Preview loading will not continue.");return false;}for(var i=0;i<p.getElementsByTagName("div").length;i++){if(p.getElementsByTagName("div")[i].className.indexOf("status")!=-1){s=p.getElementsByTagName("div")[i];}else{if(p.getElementsByTagName("div")[i].className=="thumbnail"){t=p.getElementsByTagName("div")[i];}}}var _13b;if(t.getElementsByTagName("img").length==1){_13b=t.getElementsByTagName("img")[0];t.removeChild(_13b);}if(img.className!="error"){var w=img.offsetWidth;var h=img.offsetHeight;var _13e=w/h;document.getElementById("imagebrowser_image_width").value=String(w);document.getElementById("imagebrowser_image_height").value=String(h);document.getElementById("imageproperties_image_width").value=String(w);document.getElementById("imageproperties_image_height").value=String(h);_13b=document.createElement("img");_13b.src=img.src;_13b.style.position="absolute";var pw,ph;if(w>t.offsetWidth||h>t.offsetHeight){if(w>h){pw=t.offsetWidth;ph=Math.floor(pw/_13e);_13b.style.left="0";_13b.style.top=Math.floor((t.offsetHeight-ph)*0.5)+"px";}else{if(w<h){ph=t.offsetHeight;pw=Math.floor(_13e*ph);_13b.style.left=Math.floor((t.offsetWidth-pw)*0.5)+"px";_13b.style.top="0";}else{pw=ph=container.offsetHeight;_13b.style.left=Math.floor((t.offsetWidth-pw)*0.5)+"px";_13b.style.top="0";}}_13b.style.width=pw+"px";_13b.style.height=ph+"px";}else{_13b.style.left=Math.floor((t.offsetWidth-w)*0.5)+"px";_13b.style.top=Math.floor((t.offsetHeight-h)*0.5)+"px";}t.appendChild(_13b);if(w==0||h==0){s.innerHTML="<span class='error'>Error: Failed to load image</span>";}}else{s.innerHTML="<span class='error'>Error: Failed to load image</span>";}s.className="status";}window.cart_oldload=null;function FileBrowser1_load(_141,args){if(window.onLoad){cart_oldload=window.onLoad;}window.onload=new Function("e",_141.Id+".get_nodes().getNode(0).expand();if(cart_oldload) cart_oldload();");}function populate_image_path(_143,_144,_145){var _146=document.getElementById(_145);var _147=_144.findNodeById(_143);if(_147.get_parentNode()){var _148=_147.get_parentNode();}else{var path=window.EditorApplicationPath+ImageManagerDialog.UploadPath.replace("~","/").replace(/\/\//g,"/");_146.innerHTML=path;return path;}var path=_147.Text;while(_148.get_parentNode()){path=_148.Text+"/"+path;_148=_148.get_parentNode();}path=(path.substring(0,1)=="/"||ImageManagerDialog.UploadPath.substring(ImageManagerDialog.UploadPath.length,1)=="/")?ImageManagerDialog.UploadPath+path:ImageManagerDialog.UploadPath+"/"+path;path=window.EditorApplicationPath+path.replace("~","/").replace(/\/\//g,"/");if(_143.substring(0,1)=="f"){im_load_image("imagebrowse_preview",path);document.getElementById("image_url").value=path;}_146.innerHTML=path;return path;}function change_tabs(el,on,off){var a=el.parentNode.getElementsByTagName("a");for(var i=0;i<a.length;i++){a[i].className=off;}el.className=on;}function file_change(_14f,args){var a=document.getElementsByTagName("a");for(var i=0;i<a.length;i++){if(a[i].className=="up-d"){a[i].className="up";}}}function upload_begin(_153,args){}function upload_end(_155,args){var t=format_time(_155.UploadProgressData.ElapsedTime,true);alert("Upload completed in "+t+".");ImageManagerPages.setPageIndex(2);FileBrowser1.get_nodes().getNode(0).collapse();FileBrowser1.get_nodes().getNode(0).ClearChildren();FileBrowser1.Render();window.expandTimeout=null;window.expandTimeout=setTimeout("FileBrowser1_refresh();",50);}function FileBrowser1_refresh(){FileBrowser1.get_nodes().getNode(0).expand();if(FileBrowser1.get_nodes().getNode(0).get_nodes().length==0){setTimeout("FileBrowser1_refresh();",50);}}function init_upload(el,ctrl){if(el.className.indexOf("-d")>=0){return;}ImageManagerPages.setPageIndex(3);ctrl.Upload();}function format_file_size(n,fmt){if(fmt==null){if(n<1000){fmt="b";}else{if(n<1000000){fmt="kb";}else{if(n<1000000000){fmt="mb";}else{fmt="gb";}}}}switch(fmt.toLowerCase()){case "kb":return String((n*0.001).toFixed(2))+" KB";break;case "mb":return String((n*0.000001).toFixed(2))+" MB";break;case "gb":return String((n*1e-9).toFixed(2))+" GB";break;default:return String(n.toFixed(2))+" B";}}function get_percentage(n){return String(Math.round(n*100));}function format_time(t,txt){var s=Math.floor(t);var m=Math.floor(s/60);var h=Math.floor(m/60);if(!txt){s=pad_time(s%60);m=pad_time(m%60)+":";h=(h==0)?"":pad_time(h%60)+":";return (h+m+s);}else{var secs=(s>1)?"seconds":"second";var mins=(m>1)?"minute":"minute";var _164=(h>1)?"hours":"hour";s=(s>0)?String(s)+" "+secs:"";m=(m>0)?String(m)+" "+mins:"";h=(h>0)?String(h)+" "+_164:"";var out="";if(h!==""){out=h;if(m!=""){out+=", "+m;}if(s!=""){out+=", "+s;}}if(m!==""&&out==""){out+=m;if(s!=""){out+=", "+s;}}if(s!==""&&out==""){out=s;}if(out==""){out="less than 1 second";}return out;}}function pad_time(t){return String(((t>9)?"":"0")+t);}