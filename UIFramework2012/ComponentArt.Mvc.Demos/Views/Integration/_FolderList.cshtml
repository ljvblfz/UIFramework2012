@using ComponentArt.Web.UI
<script language="javascript">

  function FolderList_TreeView_NodeSelect(sender, eventArgs)
  {
    var node = eventArgs.get_node();
    var imageUrl = node.get_imageUrl();

    if (!imageUrl)
    {
      if (node.get_nodes().get_length())
      {
        imageUrl = 'folders.gif';
      }
      else
      {
        imageUrl = 'folder.gif';
      }
    }

    document.getElementById('FolderGridHeadingImage').src = '../../Content/Integration/Outlook/folderlist_treeview_images/' + imageUrl;
    document.getElementById('FolderGridHeadingText').innerHTML = node.get_text();

    if (window.FolderGrid)
    {
      FolderGrid.callback();
    }
  }

</script>
<style type="text/css">
  .FolderListTreeView
  {
    scrollbar-base-color: #9CBCE5;
  }
</style>
<table border="0" cellpadding="0" cellspacing="0" style="border: solid 1px #6593CF;
  border-right: none; width: 100%; height: 100%">
  <tr>
    <td class="h1" style="border-bottom: solid 1px #6593CF;">
      Folder List
    </td>
  </tr>
  <tr>
    <td class="h2">
      All Folders
    </td>
  </tr>
  <tr>
    <td class="h3" style="border: solid 1px #ADD1FF; border-left: none; border-right: none;
      border-bottom-color: #6593CF;">
      <img src="../../Content/Integration/Outlook/images/alloutlookitems.gif" alt="All Outlook Items" />
      All Outlook Items
    </td>
  </tr>
  <tr>
    <td>
      @(Html.ComponentArt().TreeView()
        .ID("FolderList_TreeView")
        .AutoTheming(true)
        .Width(230)
        .Height(285)
        .AutoScroll(true)
        .ExtendNodeCells(true)
        .SelectedNodeRowCssClass("FolderListSelectedTreeNodeRow")
        .CssClass("FolderListTreeView")
        .NodeCssClass("FolderListTreeNode")
        .HoverNodeCssClass("FolderListHoverTreeNode")
        .SelectedNodeCssClass("FolderListSelectedTreeNode")
        .ParentNodeImageUrl("folders.gif")
        .LeafNodeImageUrl("folder.gif")
        .FillContainer(true)
        .ImagesBaseUrl("~/Content/Integration/Outlook/folderlist_treeview_images/")
        .ShowLines(false)
        .SiteMapXmlFile("~/App_Data/Integration/Outlook/folderlist_treeview.xml")
        .ClientEvents(ct =>
        {
          ct.NodeSelect("FolderList_TreeView_NodeSelect");
        })
)
    </td>
  </tr>
</table>
